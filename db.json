{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png.old","path":"images/favicon-32x32-next.png.old","modified":1,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.png","path":"images/avatar.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/wechatpay.png","path":"images/wechatpay.png","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","path":"lib/needsharebutton/font-embedded.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","path":"lib/needsharebutton/needsharebutton.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","path":"lib/needsharebutton/needsharebutton.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","path":"lib/pace/pace-theme-barber-shop.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","path":"lib/pace/pace-theme-big-counter.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","path":"lib/pace/pace-theme-bounce.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","path":"lib/pace/pace-theme-center-atom.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","path":"lib/pace/pace-theme-center-circle.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","path":"lib/pace/pace-theme-center-radar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","path":"lib/pace/pace-theme-center-simple.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","path":"lib/pace/pace-theme-corner-indicator.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","path":"lib/pace/pace-theme-fill-left.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","path":"lib/pace/pace-theme-flash.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","path":"lib/pace/pace-theme-loading-bar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","path":"lib/pace/pace-theme-mac-osx.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","path":"lib/pace/pace-theme-minimal.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace.min.js","path":"lib/pace/pace.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.css","path":"lib/Han/dist/han.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.css","path":"lib/Han/dist/han.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.js","path":"lib/Han/dist/han.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.js","path":"lib/Han/dist/han.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","path":"lib/Han/dist/font/han-space.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","path":"lib/Han/dist/font/han-space.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","path":"lib/Han/dist/font/han.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","path":"lib/Han/dist/font/han.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","path":"lib/Han/dist/font/han.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":1,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"cc75fbdb977a72e3c33a32b977ec965c1597d5c5","modified":1586924521900},{"_id":"themes/next/LICENSE","hash":"f293bcfcdc06c0b77ba13570bb8af55eb5c059fd","modified":1586925069462},{"_id":"themes/next/README.cn.md","hash":"263b74f1ac7c0f6f9424b8cced4b0b320ae61efc","modified":1586925069462},{"_id":"themes/next/README.md","hash":"287c7e6b7a6ddf75d815dda0df8bd228e3f285c5","modified":1586925069462},{"_id":"themes/next/bower.json","hash":"0674f11d3d514e087a176da0e1d85c2286aa5fba","modified":1586925069462},{"_id":"themes/next/gulpfile.coffee","hash":"031bffc483e417b20e90eceb6cf358e7596d2e69","modified":1586925069462},{"_id":"themes/next/_config.yml","hash":"0e5b65840d22675954908c3795eab400b18a23c8","modified":1586932671420},{"_id":"themes/next/package.json","hash":"036d3a1346203d2f1a3958024df7f74e7ac07bfe","modified":1586925069466},{"_id":"source/_posts/TreadMarks.md","hash":"ed28b1d32baf50f44b6030aba284c1668fd18425","modified":1586936714004},{"_id":"source/_posts/grpc.md","hash":"dc2ba4e5d3eb3c266059ecc97d196924afbb6aaf","modified":1586924521900},{"_id":"source/_posts/numa.md","hash":"c1562c429bd1c31fc445ae455b2c6df6d45c475b","modified":1586921321896},{"_id":"source/_posts/which-most-important.md","hash":"5528db430f8424ad375c0a950ea6325144570c11","modified":1586921321896},{"_id":"source/about/index.md","hash":"96f5bc323f9c4317ef0bc190e2c0a2fb0391e1ad","modified":1586921321896},{"_id":"source/categories/index.md","hash":"2f9d09207ab355d5c468b6732b65efb8847d97d6","modified":1586921321896},{"_id":"source/tags/index.md","hash":"522024bf32f56ea036e0ccc370b0a05313bca99f","modified":1586921321896},{"_id":"themes/next/languages/de.yml","hash":"057e7df11ddeb1c8c15a5d7c5ff29430d725ec6b","modified":1586925069462},{"_id":"themes/next/languages/en.yml","hash":"7e680d9bb8f3a3a9d1ba1c9d312b3d257183dded","modified":1586925069462},{"_id":"themes/next/languages/default.yml","hash":"44ef3f26917f467459326c2c8be2f73e4d947f35","modified":1586925069462},{"_id":"themes/next/languages/fr-FR.yml","hash":"7e4eb7011b8feee641cfb11c6e73180b0ded1c0f","modified":1586925069462},{"_id":"themes/next/languages/id.yml","hash":"b5de1ea66dd9ef54cac9a1440eaa4e3f5fc011f5","modified":1586925069462},{"_id":"themes/next/languages/it.yml","hash":"aa595f2bda029f73ef7bfa104b4c55c3f4e9fb4c","modified":1586925069462},{"_id":"themes/next/languages/ja.yml","hash":"3c76e16fd19b262864475faa6854b718bc08c4d8","modified":1586925069462},{"_id":"themes/next/languages/ko.yml","hash":"ea5b46056e73ebcee121d5551627af35cbffc900","modified":1586925069462},{"_id":"themes/next/languages/nl-NL.yml","hash":"edca4f3598857dbc3cbf19ed412213329b6edd47","modified":1586925069462},{"_id":"themes/next/languages/pt-BR.yml","hash":"b1694ae766ed90277bcc4daca4b1cfa19cdcb72b","modified":1586925069462},{"_id":"themes/next/languages/pt.yml","hash":"44b61f2d085b827b507909a0b8f8ce31c6ef5d04","modified":1586925069462},{"_id":"themes/next/languages/ru.yml","hash":"98ec6f0b7183282e11cffc7ff586ceb82400dd75","modified":1586925069462},{"_id":"themes/next/languages/vi.yml","hash":"fd08d3c8d2c62965a98ac420fdaf95e54c25d97c","modified":1586925069462},{"_id":"themes/next/languages/zh-Hans.yml","hash":"16ef56d0dea94638de7d200984c90ae56f26b4fe","modified":1586925069462},{"_id":"themes/next/languages/zh-hk.yml","hash":"9396f41ae76e4fef99b257c93c7354e661f6e0fa","modified":1586925069462},{"_id":"themes/next/languages/zh-tw.yml","hash":"50b71abb3ecc0686f9739e179e2f829cd074ecd9","modified":1586925069462},{"_id":"themes/next/layout/_layout.swig","hash":"da0929166674ea637e0ad454f85ad0d7bac4aff2","modified":1586925069462},{"_id":"themes/next/layout/archive.swig","hash":"f0a8225feafd971419837cdb4bcfec98a4a59b2f","modified":1586925069462},{"_id":"themes/next/layout/category.swig","hash":"4472255f4a3e3dd6d79201523a9526dcabdfbf18","modified":1586925069462},{"_id":"themes/next/layout/index.swig","hash":"783611349c941848a0e26ee2f1dc44dd14879bd1","modified":1586925069462},{"_id":"themes/next/layout/page.swig","hash":"969caaee05bdea725e99016eb63d810893a73e99","modified":1586925069462},{"_id":"themes/next/layout/post.swig","hash":"b3589a8e46288a10d20e41c7a5985d2493725aec","modified":1586925069462},{"_id":"themes/next/layout/schedule.swig","hash":"d86f8de4e118f8c4d778b285c140474084a271db","modified":1586925069462},{"_id":"themes/next/layout/tag.swig","hash":"7e0a7d7d832883eddb1297483ad22c184e4368de","modified":1586925069466},{"_id":"themes/next/scripts/merge-configs.js","hash":"81e86717ecfb775986b945d17f0a4ba27532ef07","modified":1586925069466},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1586925069466},{"_id":"themes/next/source/.DS_Store","hash":"806cbd19861a958a52cecb5e5a1ecf4ecc769886","modified":1586925069466},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1586925069486},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1586925069486},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1586925069486},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1586925069470},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1586925069462},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1586925069462},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"31322a7f57936cf2dc62e824af5490da5354cf02","modified":1586925069462},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"ab737670d272b5a967ca0cb8538168e17d6e8439","modified":1586925069462},{"_id":"themes/next/layout/_macro/post.swig","hash":"3f963030f79a4349f8dbddcea236272f2bce37c4","modified":1586925069462},{"_id":"themes/next/layout/_macro/reward.swig","hash":"56e8d8556cf474c56ae1bef9cb7bbd26554adb07","modified":1586925069462},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"6a54c3c85ff6b19d275827a327abbf4bd99b2ebf","modified":1586925069462},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"39852700e4084ecccffa6d4669168e5cc0514c9e","modified":1586925069462},{"_id":"themes/next/layout/_partials/comments.swig","hash":"4a6f5b1792b2e5262b7fdab9a716b3108e2f09c7","modified":1586925069462},{"_id":"themes/next/layout/_partials/footer.swig","hash":"b91d9de24b9f77f267ea81a2cdbe1489a61403b8","modified":1586925069462},{"_id":"themes/next/layout/_partials/head.swig","hash":"6b94fe8f3279daea5623c49ef4bb35917ba57510","modified":1586925069462},{"_id":"themes/next/layout/_partials/header.swig","hash":"ed042be6252848058c90109236ec988e392d91d4","modified":1586925069462},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"1efd925d34a5d4ba2dc0838d9c86ba911e705fc9","modified":1586925069462},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1586925069462},{"_id":"themes/next/layout/_partials/search.swig","hash":"9dbd378e94abfcb3f864a5b8dbbf18d212ca2ee0","modified":1586925069462},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1586925069462},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1586925069462},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"a266f96ad06ee87bdeae6e105a4b53cd587bbd04","modified":1586925069462},{"_id":"themes/next/layout/_third-party/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1586925069462},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"7c04a42319d728be356746363aff8ea247791d24","modified":1586925069462},{"_id":"themes/next/layout/_third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1586925069462},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"5fe0447cc88a5a63b530cf0426f93c4634811876","modified":1586925069462},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"fc93b1a7e6aed0dddb1f3910142b48d8ab61174e","modified":1586925069462},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1586925069462},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"1ddb2336a1a19b47af3017047012c01ec5f54529","modified":1586925069462},{"_id":"themes/next/scripts/tags/button.js","hash":"d023f10a00077f47082b0517e2ad666e6e994f60","modified":1586925069466},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1586925069466},{"_id":"themes/next/scripts/tags/exturl.js","hash":"8d7e60f60779bde050d20fd76f6fdc36fc85e06d","modified":1586925069466},{"_id":"themes/next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1586925069466},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1586925069466},{"_id":"themes/next/scripts/tags/label.js","hash":"2f8f41a7316372f0d1ed6b51190dc4acd3e16fff","modified":1586925069466},{"_id":"themes/next/scripts/tags/lazy-image.js","hash":"eeeabede68cf263de9e6593ecf682f620da16f0a","modified":1586925069466},{"_id":"themes/next/scripts/tags/note.js","hash":"64de4e9d01cf3b491ffc7d53afdf148ee5ad9779","modified":1586925069466},{"_id":"themes/next/scripts/tags/tabs.js","hash":"5786545d51c38e8ca38d1bfc7dd9e946fc70a316","modified":1586925069466},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1586925069470},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1586925069470},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1586925069470},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1586925069470},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1586925069470},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1586925069470},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1586925069470},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1586925069470},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1586925069470},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1586925069470},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1586925069470},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"9c284639834af422449de565fcd188ba3ea7c82a","modified":1586925069470},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"2f8c280c445978977714a2056c8227def6561106","modified":1586925069470},{"_id":"themes/next/source/images/favicon-32x32-next.png.old","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1586925069470},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1586925069470},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1586925069470},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1586925069470},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1586925069470},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1586925069470},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1586925069470},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1586925069462},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1586925069462},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1586925069466},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1586925069466},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1586925069466},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1586925069470},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1586925069470},{"_id":"themes/next/source/images/avatar.png","hash":"45692987c75e538c863654f0d66e7353db29c967","modified":1586925069470},{"_id":"themes/next/source/images/wechatpay.png","hash":"9ceb1c02e3d387d7b8784d50a52e5cedb8c16140","modified":1586925069470},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1586925069462},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1586925069462},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1586925069462},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1586925069462},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1586925069462},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1586925069462},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1586925069462},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1586925069462},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"048fd5e98149469f8c28c21ba3561a7a67952c9b","modified":1586925069462},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1586925069462},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1586925069462},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"98df9d72e37dd071e882f2d5623c9d817815b139","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"18e7bef8923d83ea42df6c97405e515a876cede4","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"a234c5cd1f75ca5731e814d0dbb92fdcf9240d1b","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"5d9943d74cc2e0a91badcf4f755c6de77eab193a","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"1cd01c6e92ab1913d48e556a92bb4f28b6dc4996","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"5e9bb24c750b49513d9a65799e832f07410002ac","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"fc65b9c98a0a8ab43a5e7aabff6c5f03838e09c8","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"0ddc94ed4ba0c19627765fdf1abc4d8efbe53d5a","modified":1586925069462},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"c3971fd154d781088e1cc665035f8561a4098f4c","modified":1586925069462},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"0e3378f7c39b2b0f69638290873ede6b6b6825c0","modified":1586925069462},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"c316758546dc9ba6c60cb4d852c17ca6bb6d6724","modified":1586925069462},{"_id":"themes/next/layout/_third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1586925069462},{"_id":"themes/next/layout/_third-party/comments/gitment.swig","hash":"10160daceaa6f1ecf632323d422ebe2caae49ddf","modified":1586925069462},{"_id":"themes/next/layout/_third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1586925069462},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"aa0629277d751c55c6d973e7691bf84af9b17a60","modified":1586925069462},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"8a2e393d2e49f7bf560766d8a07cd461bf3fce4f","modified":1586925069462},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"fcabbb241f894c9a6309c44e126cf3e8fea81fd4","modified":1586925069462},{"_id":"themes/next/layout/_third-party/comments/youyan.swig","hash":"8b6650f77fe0a824c8075b2659e0403e0c78a705","modified":1586925069462},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1586925069462},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"385c066af96bee30be2459dbec8aae1f15d382f5","modified":1586925069462},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1586925069462},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1586925069462},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1586925069466},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1586925069466},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"9ab65361ba0a12a986edd103e56492644c2db0b8","modified":1586925069466},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"82f9055955920ed88a2ab6a20ab02169abb2c634","modified":1586925069466},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"99fbb4686ea9a3e03a4726ed7cf4d8f529034452","modified":1586925069470},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1586925069470},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"f29165e36489a87ba32d17dddfd2720d84e3f3ec","modified":1586925069470},{"_id":"themes/next/source/css/_variables/base.styl","hash":"29c261fa6b4046322559074d75239c6b272fb8a3","modified":1586925069470},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1586925069470},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1586925069470},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"034bc8113e0966fe2096ba5b56061bbf10ef0512","modified":1586925069470},{"_id":"themes/next/source/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1586925069470},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1586925069470},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1586925069470},{"_id":"themes/next/source/js/src/motion.js","hash":"754b294394f102c8fd9423a1789ddb1201677898","modified":1586925069470},{"_id":"themes/next/source/js/src/post-details.js","hash":"a13f45f7aa8291cf7244ec5ba93907d119c5dbdd","modified":1586925069470},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1586925069470},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1586925069470},{"_id":"themes/next/source/js/src/utils.js","hash":"9b1325801d27213083d1487a12b1a62b539ab6f8","modified":1586925069470},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1586925069474},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1586925069474},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"ff5915eb2596e890a2fc6697c864f861a1995ec0","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"cc40a9b11e52348e554c84e4a5c058056f6b7aeb","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1586925069474},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1586925069474},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1586925069474},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1586925069474},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1586925069478},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1586925069478},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1586925069478},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1586925069478},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1586925069478},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1586925069478},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1586925069482},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1586925069482},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1586925069482},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1586925069482},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1586925069482},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1586925069482},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1586925069482},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","hash":"c39d37278c1e178838732af21bd26cd0baeddfe0","modified":1586925069482},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","hash":"3ef0020a1815ca6151ea4886cd0d37421ae3695c","modified":1586925069482},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","hash":"9885fd9bea5e7ebafc5b1de9d17be5e106248d96","modified":1586925069482},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1586925069482},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1586925069486},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1586925069486},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1586925069482},{"_id":"themes/next/source/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1586925069482},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1586925069486},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1586925069486},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1586925069486},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1586925069486},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1586925069486},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1586925069482},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1586925069462},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1586925069462},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"4719ce717962663c5c33ef97b1119a0b3a4ecdc3","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"31050fc7a25784805b4843550151c93bfa55c9c8","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"7e509c7c28c59f905b847304dd3d14d94b6f3b8e","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"c5d48863f332ff8ce7c88dec2c893f709d7331d3","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1586925069466},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1586925069466},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"f7c44b0ee46cf2cf82a4c9455ba8d8b55299976f","modified":1586925069466},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1586925069466},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"47a46583a1f3731157a3f53f80ed1ed5e2753e8e","modified":1586925069466},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1586925069466},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1586925069466},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"18c3336ee3d09bd2da6a876e1336539f03d5a973","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"3b25edfa187d1bbbd0d38b50dd013cef54758abf","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"4aac01962520d60b03b23022ab601ad4bd19c08c","modified":1586925069470},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1586925069470},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1586925069470},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"c4ed249798296f60bda02351fe6404fb3ef2126f","modified":1586925069470},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"5b93958239d3d2bf9aeaede44eced2434d784462","modified":1586925069470},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"215de948be49bcf14f06d500cef9f7035e406a43","modified":1586925069470},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1586925069470},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"9d16fa3c14ed76b71229f022b63a02fd0f580958","modified":1586925069470},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"69ecd6c97e7cdfd822ac8102b45ad0ede85050db","modified":1586925069470},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1586925069470},{"_id":"themes/next/source/lib/Han/dist/han.css","hash":"bd40da3fba8735df5850956814e312bd7b3193d7","modified":1586925069470},{"_id":"themes/next/source/lib/Han/dist/han.min.css","hash":"a0c9e32549a8b8cf327ab9227b037f323cdb60ee","modified":1586925069474},{"_id":"themes/next/source/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1586925069474},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1586925069478},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1586925069478},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1586925069478},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1586925069478},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1586925069478},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1586925069486},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1586925069486},{"_id":"themes/next/source/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1586925069474},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1586925069482},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1586925069482},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1586925069486},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"7905a7f625702b45645d8be1268cb8af3f698c70","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"8a2421cb9005352905fae9d41a847ae56957247e","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"25dc25f61a232f03ca72472b7852f882448ec185","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"f5aa2ba3bfffc15475e7e72a55b5c9d18609fdf5","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"2039590632bba3943c39319d80ef630af7928185","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"0f7f522cc6bfb3401d5afd62b0fcdf48bb2d604b","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f54367c0feda6986c030cc4d15a0ca6ceea14bcb","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"535b3b4f8cb1eec2558e094320e7dfb01f94c0e7","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"aea21141015ca8c409d8b33e3e34ec505f464e93","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"a5d8617a24d7cb6c5ad91ea621183ca2c0917331","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"36332c8a91f089f545f3c3e8ea90d08aa4d6e60c","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"d5a4e4fc17f1f7e7c3a61b52d8e2e9677e139de7","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"e4055a0d2cd2b0ad9dc55928e2f3e7bd4e499da3","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"262debfd4442fa03d9919ceb88b948339df03fb0","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"0a6c0efffdf18bddbc1d1238feaed282b09cd0fe","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"89dd4f8b1f1cce3ad46cf2256038472712387d02","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"efa5e5022e205b52786ce495d4879f5e7b8f84b2","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"12937cae17c96c74d5c58db6cb29de3b2dfa14a2","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"f7784aba0c1cd20d824c918c120012d57a5eaa2a","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"50305b6ad7d09d2ffa4854e39f41ec1f4fe984fd","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/tags/exturl.styl","hash":"1b3cc9f4e5a7f6e05b4100e9990b37b20d4a2005","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"37e951e734a252fe8a81f452b963df2ba90bfe90","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"4a457d265d62f287c63d48764ce45d9bcfc9ec5a","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/tags/note-modern.styl","hash":"ee7528900578ef4753effe05b346381c40de5499","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"32c9156bea5bac9e9ad0b4c08ffbca8b3d9aac4b","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"4ab5deed8c3b0c338212380f678f8382672e1bcb","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"ead0d0f2321dc71505788c7f689f92257cf14947","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fd42777b9125fd8969dc39d4f15473e2b91b4142","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/third-party/gitment.styl","hash":"34935b40237c074be5f5e8818c14ccfd802b7439","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"cce6772e2cdb4db85d35486ae4c6c59367fbdd40","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"a5e3e6b4b4b814a9fe40b34d784fed67d6d977fa","modified":1586925069466},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"1ccfbd4d0f5754b2dc2719a91245c95f547a7652","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1586925069466},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1586925069470},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1586925069470},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1586925069470},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1586925069470},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1586925069470},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1586925069470},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1586925069474},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1586925069474},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1586925069478},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1586925069478},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1586925069482},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1586925069474},{"_id":"themes/next/source/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1586925069486},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1586925069482}],"Category":[{"name":"2020","_id":"ck9115hpm0004ppfcayy0bwtp"},{"name":"2018","_id":"ck9115hpr0009ppfchvycnpvv"}],"Data":[],"Page":[{"title":"about","date":"2019-06-30T23:05:53.000Z","layout":"post","_content":"","source":"about/index.md","raw":"---\ntitle: about\ndate: 2019-07-01 07:05:53\nlayout: post\n---\n","updated":"2020-04-15T03:28:41.896Z","path":"about/index.html","comments":1,"_id":"ck9115hpj0001ppfc7ovgs0vm","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"categories","date":"2019-06-30T22:57:47.000Z","comments":0,"type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2019-07-01 06:57:47\ncomments: false\ntype: \"categories\"\n---\n","updated":"2020-04-15T03:28:41.896Z","path":"categories/index.html","layout":"page","_id":"ck9115hpl0003ppfcwc6zxmfh","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"tags","type":"tags","layout":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ntype: tags\nlayout: tags\n---\n","date":"2020-04-15T03:28:41.896Z","updated":"2020-04-15T03:28:41.896Z","path":"tags/index.html","comments":1,"_id":"ck9115hpp0007ppfc5g1mxi9f","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"layout":"post","title":"TreadMarks: ","date":"2020-03-31T16:00:00.000Z","_content":"\n> TreadMarks: <!-- more -->  \n\n\n\n\n\n: TreadMarks: Shared Memory Computing on Networks of Workstations\n\nChristiana Amza, Alan L. Cox, Sandhya Dwarkadas, Pete Keleher,    \nHonghui Lu, Ramakrishnan Ra jamony, Weimin Yu and Willy Zwaenepoel    \nDepartment of Computer Science    \nRice University    \n\n\n\n# Abstract\n\nTreadMarks  TreadMarks\n\n# 1  Introduction\n\n[17][14]\n\n\nTreadMarksDSMDSM[13]1DSMNDSMDSMDSMDSMTreadMarks [7]UnixUnixDSMTreadMarkslazy release consistency()[6][3]TreadMarks23456TreadMarks789\n\n![](https://github.com/ikenchina/img1/raw/master/1/treadmarks/arch1.png)\n\n\n\n# 2 Shared Memory Programming\n\n## 2.1 Application Programming Interface\n\nTreadMarks APIC2   \n\nTreadMarksbarrier()exclusive locks() Tmk barrier() Tmk lockTmk releaseTreadMarks TreadMarks\n\n\n\n## 2.2 Two Simple Illustrations\n\n34TreadMarks APIJacobiTSP   7\n\nJacobiJacobi \n\n3TreadMarks0Jacobi Tmk barrier(0) 0Tmk barrier(1) Tmk barrier(2) \n\nTSP\n\n\n\n\n\n```\n/* the maximum number of parallel processes supported by TreadMarks */\n#define TMK_NPROCS\n/* the actual number of parallel processes after Tmk_startup */\nextern unsigned Tmk_nprocs;\n/* the process id, an integer in the range 0 ... Tmk_nprocs - 1 */\nextern unsigned Tmk_proc_id;\n/* the number of lock synchronization objects provided by TreadMarks */\n#define TMK_NLOCKS\n/* the number of barrier synchronization objects provided by TreadMarks */\n#define TMK_NBARRIERS\n/* Initialize TreadMarks and start the remote processes */\nvoid Tmk_startup(argc, argv) int argc; char **argv;\n/* Terminate the calling process. Other processes are unaffected. */\nvoid Tmk_exit(status) int status;\n/* Block the calling process until every other process arrives at the barrier. */\nvoid Tmk_barrier(id) unsigned id;\n/* Block the calling process until it acquires the specified lock. */\nvoid Tmk_lock_acquire(id) unsigned id;\n/* Release the specified lock. */\nvoid Tmk_lock_release(id) unsigned id;\n/* Allocate the specified number of bytes of shared memory */\nchar *Tmk_malloc(size) unsigned size;\n/* Free shared memory allocated by Tmk_malloc. */\nvoid Tmk_free(ptr) char *ptr;\n\n```\n\n 2 TreadMarks C\n\n\n\n```\n#define M 1024\n#define N 1024\nfloat **grid;\nfloat scratch[M][N];\n\nTmk_startup();\n\nif (Tmk_proc_id == 0)\n{\n    grid = Tmk_malloc(M * N * sizeof(float));\n    initialize grid;\n}\n\nTmk_barrier(0);\nlength = M / Tmk_nprocs;\nbegin = length * Tmk_proc_id;\nend = length * (Tmk_proc_id + 1);\nfor (number of iterations)\n{\n    for (i = begin; i < end; i++)\n        for (j = 0; j < N; j++)\n            scratch[i][j] = (grid[i - 1][j] + grid[i + 1][j] +\n                             grid[i][j - 1] + grid[i][j + 1]) / 4;\n    Tmk_barrier(1);\n    for (i = begin; i < end; i++)\n        for (j = 0; j < N; j++)\n            grid[i][j] = scratch[i][j];\n    Tmk_barrier(2);\n}\n\n```\n\n 3 The TreadMarks Jacobi \n\n\n\n\n\n\n\n# Implementation Challenges\n\nDSMDSMIVY[13]5DSM513IVY\n\n```\nqueue_type *Queue;\nint *Shortest_length;\nint queue_lock, tour_lock;\nmain()\n{\n    Tmk_startup();\n    queue_lock = 0;\n    tour_lock = 1;\n    if (Tmk_proc_id == 0)\n        Queue = Tmk_malloc(sizeof(queue_type));\n    Shortest_length = Tmk_malloc(sizeof(int));\n    initialize Heap and Shortest_length\n        Tmk_barrier(0);\n    Tmk_lock_acquire(queue_lock);\n    Exit if queue is empty;\n    Keep adding to queue\n        until a long,\n        promising tour appears at the head;\n    Path = Delete the tour from the head;\n    Tmk_lock_release(queue_lock);\n    length = recursively\n    try\n        all cities not on Path,\n            find the shortest tour length\n                Tmk_lock_acquire(tour_lock);\n    if (length < *Shortest_length)\n        *Shortest_length = length;\n    Tmk_lock_release(tour_lock);\n}\n\n```\n\n4 The TreadMarks TSP \n\n\n\nDSMIVY 34IVY\n\nIVYsequential consistency [9]IVY 4TSPIVY \n\n6Jacobi \n\n\n\n\n\n![](https://github.com/ikenchina/img1/raw/master/1/treadmarks/ivh1.png)\n\nIVH DSM\n\n\n# 4 Lazy Release Consistency\n\n\n\n## 4.1 Release Consistency\n\n[5] Gharachorloo \n\nDSM\n\n2JacobiTSPJacobibarrier 1 barrier 2barrier 2barrierbarrier\n\nTSP \n\n \n\n TreadMarks TreadMarks\n\n\n\n![6](https://github.com/ikenchina/img1/raw/master/1/treadmarks/false_sharing1.png)\n\nJacobi\n\n\n\n## 4.2 Lazy Release Consistency\n\nTreadMarks[6]MuninMunin\n\nlazy release consistencyeager release consistencyMunin\n\n# 5 Multiple-Writer Protocols\n\nDSM \n\nDSM\n\n\n\nTreadMarks7protection faultsdiffs TreadMarkstwintwindiffdifftwin diff \n\ndiffdiff\n\n\n\n#  TreadMarksThe TreadMarks System\n\nTreadMarksUnixUnixUnixTreadMarksCC++FORTRANTreadMarks SPARCDECStationDEC / AlphaIBM RS-6000IBM SP-1SGIATM TreadMarks\n\nTreadMarksBerkeleyATMTreadMarksUDP / IPAAL3 / 4ATM LANTreadMarksUDP / IPAAL3 / 4ATMbest-efforts delivery protocol UDP / IPAAL3 / 4TreadMarks\n\nTreadMarksTreadMarksTreadMarksTreadMarksSIGIOSIGIOAAL3 / 4select\n\nTreadMarksmprotectSIGSEGVSIGSEGVbcopytwinprocedure\n\n![7](https://github.com/ikenchina/img1/raw/master/1/treadmarks/diff1.png)\n\nDiffCreation\n\n# 7 Applications\n\nTreadMarks[7]TreadMarksmixed integer programminggenetic linkage analysis\n\n\n\n## 7.1 Mixed Integer Programming\n\nMIPLPLPMIP01 89\n\n![8](https://github.com/ikenchina/img1/raw/master/1/treadmarks/mip3.png)\n\n\n\n 8 (MIP) \n\n\n\n![9](https://github.com/ikenchina/img1/raw/master/1/treadmarks/mip_two1.png)\n\n\t 9 MIP\n\n\n\n\n\n![](https://github.com/ikenchina/img1/raw/master/1/treadmarks/branch_and_bound_mip2.png)\n\n10 MIP\n\n\n\nLeeMIPTreadMarks [11]MIPLPLPLP $x_{i} =  \\left \\lfloor x_{i} \\right \\rfloor$  $x_{i} =  \\left \\lceil x_{i} \\right \\rceil$ 10LP`plunging``cutting planes` LP\n\nMIPLIB51118Ultrix 4.3100Mbps Fore ATMDecStation-5000 / 2402,000 MIPLIB[2] 8IBM SP-CPU30\n\n\n\n![](https://github.com/ikenchina/img1/raw/master/1/treadmarks/miplib2.png)\n\n11 MIPLIB\n\n\n\n## 7.2 Genetic Linkage\n\n\n\nMendelian12 \n\nILINK [4]LINKAGE [10]ILINKILINK\n\n\n\n13ILINK BAD\n\n\n\n![12](https://github.com/ikenchina/img1/raw/master/1/treadmarks/dna1.png)\n\n12 DNA\n\n# 8 Related Work\n\nTreadMarks\n\nPVM PVM[15]PVMTreadMarks \n\nHPF HPF [8]Jacobi TSPILINKMIPHPF\n\nOrcaOrca [16]\n\nDASH [12] \n\nEntry Consistency [1]\n\n![13](https://github.com/ikenchina/img1/raw/master/1/treadmarks/ilink.png)\n\n13 ILINK\n\n# 9 Conclusions and Further Work\n\nTreadMarks\n\n\n\n# References\n\n[1] B.N. Bershad, M.J. Zekauskas, and W.A. Sawdon. The Midway distributed shared memory system. In Proceedings of the '93 CompCon Conference, pages 528-537, February 1993.\n[2] D. Bienstock and O. Gumluk. Computational experience with a difficult mixed-integer multi-commodity  flow problem. To appear in Mathematical Programming, 1994.\n[3] J.B. Carter, J.K. Bennett, and W. Zwaenepoel. Implementation and performance of Munin. In Proceedings of the 13th ACM Symposium on Operating Systems Principles, pages 152-164, October 1991.\n[4] S. Dwarkadas, A.A. Schffer, R.W. Cottingham Jr., A.L. Cox, P. Keleher, and W. Zwaenepoel. Parallelization of general linkage analysis problems. Human Heredity, 44:127-141, 1994.\n[5] K. Gharachorloo, D. Lenoski, J. Laudon, P. Gibbons, A. Gupta, and J. Hennessy. Memory consistency and event ordering in scalable shared-memory multiprocessors. In Proceedings of the 17th Annual International Symposium on Computer Architecture, pages 15-26, May 1990.\n[6] P. Keleher, A. L. Cox, and W. Zwaenepoel. Lazy release consistency for software distributed shared memory. In Proceedings of the 19th Annual International Symposium on Computer Architecture, pages 13-21, May 1992.\n[7] P. Keleher, S. Dwarkadas, A. Cox, and W. Zwaenepoel. Treadmarks: Distributed shared memory on standard workstations and operating systems. In Proceedings of the 1994 Winter Usenix Conference, pages 115-131, January 1994.\n[8] C. Koelbel, D. Loveman, R. Schreiber, G. Steele, Jr., and M. Zosel. The High Performance Fortran Handbook. The MIT Press, 1994.\n[9] L. Lamport. How to make a multiprocessor computer that correctly executes multiprocess programs. IEEE Transactions on Computers, C-28(9):690{691, September 1979.\n[10] G. M. Lathrop, J. M. Lalouel, C. Julier, and J. Ott. Strategies for multilocus linkage analysis in humans. Proc. Natl. Acad. Sci. USA, 81:3443-3446, June 1984.\n[11] E. Lee, R. Bixby, W. Cook, and A.L. Cox. Parallelism in mixed integer programming. Sub\u0002mitted for publication, 1994.\n[12] D. Lenoski, J. Laudon, K. Gharachorloo, A. Gupta, and J. Hennessy. The directory-based cache coherence protocol for the DASH multiprocessor. In Proceedings of the 17th Annual International Symposium on Computer Architecture, pages 148-159, May 1990.\n[13] K. Li and P. Hudak. Memory coherence in shared virtual memory systems. ACM Transactions on Computer Systems, 7(4):321-359, November 1989.\n[14] M. Litzkow, M. Livny, and M. Mutka. Condor - a hunter of idle workstations. In Proceedings of the 8th International Conference on Distributed Computing Systems, pages 104-111, June 1988.\n[15] V. Sunderam. PVM: A framework for parallel distributed computing. Concurrency:Practice and Experience, 2(4):315-339, December 1990.\n[16] A.S. Tanenbaum, M.F. Kaashoek, and H.E. Bal. Parallel programming using shared ob jects and broadcasting. IEEE Computer, 25(8):10-20, August 1992.\n[17] A.S. Tanenbaum, R. van Renesse, H. van Staveren, G.J. Sharp, S.J. Mullender, J. Jansen, and G. van Rossum. Experiences with the Amoeba distributed operating system. Communications of the ACM, 33(12):46-63, December 1990.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/TreadMarks.md","raw":"---\nlayout: post\ncategory: \"2020\"\ntitle:  \"TreadMarks: \"\ntags: []\ndate: 2020-04-01\n---\n\n> TreadMarks: <!-- more -->  \n\n\n\n\n\n: TreadMarks: Shared Memory Computing on Networks of Workstations\n\nChristiana Amza, Alan L. Cox, Sandhya Dwarkadas, Pete Keleher,    \nHonghui Lu, Ramakrishnan Ra jamony, Weimin Yu and Willy Zwaenepoel    \nDepartment of Computer Science    \nRice University    \n\n\n\n# Abstract\n\nTreadMarks  TreadMarks\n\n# 1  Introduction\n\n[17][14]\n\n\nTreadMarksDSMDSM[13]1DSMNDSMDSMDSMDSMTreadMarks [7]UnixUnixDSMTreadMarkslazy release consistency()[6][3]TreadMarks23456TreadMarks789\n\n![](https://github.com/ikenchina/img1/raw/master/1/treadmarks/arch1.png)\n\n\n\n# 2 Shared Memory Programming\n\n## 2.1 Application Programming Interface\n\nTreadMarks APIC2   \n\nTreadMarksbarrier()exclusive locks() Tmk barrier() Tmk lockTmk releaseTreadMarks TreadMarks\n\n\n\n## 2.2 Two Simple Illustrations\n\n34TreadMarks APIJacobiTSP   7\n\nJacobiJacobi \n\n3TreadMarks0Jacobi Tmk barrier(0) 0Tmk barrier(1) Tmk barrier(2) \n\nTSP\n\n\n\n\n\n```\n/* the maximum number of parallel processes supported by TreadMarks */\n#define TMK_NPROCS\n/* the actual number of parallel processes after Tmk_startup */\nextern unsigned Tmk_nprocs;\n/* the process id, an integer in the range 0 ... Tmk_nprocs - 1 */\nextern unsigned Tmk_proc_id;\n/* the number of lock synchronization objects provided by TreadMarks */\n#define TMK_NLOCKS\n/* the number of barrier synchronization objects provided by TreadMarks */\n#define TMK_NBARRIERS\n/* Initialize TreadMarks and start the remote processes */\nvoid Tmk_startup(argc, argv) int argc; char **argv;\n/* Terminate the calling process. Other processes are unaffected. */\nvoid Tmk_exit(status) int status;\n/* Block the calling process until every other process arrives at the barrier. */\nvoid Tmk_barrier(id) unsigned id;\n/* Block the calling process until it acquires the specified lock. */\nvoid Tmk_lock_acquire(id) unsigned id;\n/* Release the specified lock. */\nvoid Tmk_lock_release(id) unsigned id;\n/* Allocate the specified number of bytes of shared memory */\nchar *Tmk_malloc(size) unsigned size;\n/* Free shared memory allocated by Tmk_malloc. */\nvoid Tmk_free(ptr) char *ptr;\n\n```\n\n 2 TreadMarks C\n\n\n\n```\n#define M 1024\n#define N 1024\nfloat **grid;\nfloat scratch[M][N];\n\nTmk_startup();\n\nif (Tmk_proc_id == 0)\n{\n    grid = Tmk_malloc(M * N * sizeof(float));\n    initialize grid;\n}\n\nTmk_barrier(0);\nlength = M / Tmk_nprocs;\nbegin = length * Tmk_proc_id;\nend = length * (Tmk_proc_id + 1);\nfor (number of iterations)\n{\n    for (i = begin; i < end; i++)\n        for (j = 0; j < N; j++)\n            scratch[i][j] = (grid[i - 1][j] + grid[i + 1][j] +\n                             grid[i][j - 1] + grid[i][j + 1]) / 4;\n    Tmk_barrier(1);\n    for (i = begin; i < end; i++)\n        for (j = 0; j < N; j++)\n            grid[i][j] = scratch[i][j];\n    Tmk_barrier(2);\n}\n\n```\n\n 3 The TreadMarks Jacobi \n\n\n\n\n\n\n\n# Implementation Challenges\n\nDSMDSMIVY[13]5DSM513IVY\n\n```\nqueue_type *Queue;\nint *Shortest_length;\nint queue_lock, tour_lock;\nmain()\n{\n    Tmk_startup();\n    queue_lock = 0;\n    tour_lock = 1;\n    if (Tmk_proc_id == 0)\n        Queue = Tmk_malloc(sizeof(queue_type));\n    Shortest_length = Tmk_malloc(sizeof(int));\n    initialize Heap and Shortest_length\n        Tmk_barrier(0);\n    Tmk_lock_acquire(queue_lock);\n    Exit if queue is empty;\n    Keep adding to queue\n        until a long,\n        promising tour appears at the head;\n    Path = Delete the tour from the head;\n    Tmk_lock_release(queue_lock);\n    length = recursively\n    try\n        all cities not on Path,\n            find the shortest tour length\n                Tmk_lock_acquire(tour_lock);\n    if (length < *Shortest_length)\n        *Shortest_length = length;\n    Tmk_lock_release(tour_lock);\n}\n\n```\n\n4 The TreadMarks TSP \n\n\n\nDSMIVY 34IVY\n\nIVYsequential consistency [9]IVY 4TSPIVY \n\n6Jacobi \n\n\n\n\n\n![](https://github.com/ikenchina/img1/raw/master/1/treadmarks/ivh1.png)\n\nIVH DSM\n\n\n# 4 Lazy Release Consistency\n\n\n\n## 4.1 Release Consistency\n\n[5] Gharachorloo \n\nDSM\n\n2JacobiTSPJacobibarrier 1 barrier 2barrier 2barrierbarrier\n\nTSP \n\n \n\n TreadMarks TreadMarks\n\n\n\n![6](https://github.com/ikenchina/img1/raw/master/1/treadmarks/false_sharing1.png)\n\nJacobi\n\n\n\n## 4.2 Lazy Release Consistency\n\nTreadMarks[6]MuninMunin\n\nlazy release consistencyeager release consistencyMunin\n\n# 5 Multiple-Writer Protocols\n\nDSM \n\nDSM\n\n\n\nTreadMarks7protection faultsdiffs TreadMarkstwintwindiffdifftwin diff \n\ndiffdiff\n\n\n\n#  TreadMarksThe TreadMarks System\n\nTreadMarksUnixUnixUnixTreadMarksCC++FORTRANTreadMarks SPARCDECStationDEC / AlphaIBM RS-6000IBM SP-1SGIATM TreadMarks\n\nTreadMarksBerkeleyATMTreadMarksUDP / IPAAL3 / 4ATM LANTreadMarksUDP / IPAAL3 / 4ATMbest-efforts delivery protocol UDP / IPAAL3 / 4TreadMarks\n\nTreadMarksTreadMarksTreadMarksTreadMarksSIGIOSIGIOAAL3 / 4select\n\nTreadMarksmprotectSIGSEGVSIGSEGVbcopytwinprocedure\n\n![7](https://github.com/ikenchina/img1/raw/master/1/treadmarks/diff1.png)\n\nDiffCreation\n\n# 7 Applications\n\nTreadMarks[7]TreadMarksmixed integer programminggenetic linkage analysis\n\n\n\n## 7.1 Mixed Integer Programming\n\nMIPLPLPMIP01 89\n\n![8](https://github.com/ikenchina/img1/raw/master/1/treadmarks/mip3.png)\n\n\n\n 8 (MIP) \n\n\n\n![9](https://github.com/ikenchina/img1/raw/master/1/treadmarks/mip_two1.png)\n\n\t 9 MIP\n\n\n\n\n\n![](https://github.com/ikenchina/img1/raw/master/1/treadmarks/branch_and_bound_mip2.png)\n\n10 MIP\n\n\n\nLeeMIPTreadMarks [11]MIPLPLPLP $x_{i} =  \\left \\lfloor x_{i} \\right \\rfloor$  $x_{i} =  \\left \\lceil x_{i} \\right \\rceil$ 10LP`plunging``cutting planes` LP\n\nMIPLIB51118Ultrix 4.3100Mbps Fore ATMDecStation-5000 / 2402,000 MIPLIB[2] 8IBM SP-CPU30\n\n\n\n![](https://github.com/ikenchina/img1/raw/master/1/treadmarks/miplib2.png)\n\n11 MIPLIB\n\n\n\n## 7.2 Genetic Linkage\n\n\n\nMendelian12 \n\nILINK [4]LINKAGE [10]ILINKILINK\n\n\n\n13ILINK BAD\n\n\n\n![12](https://github.com/ikenchina/img1/raw/master/1/treadmarks/dna1.png)\n\n12 DNA\n\n# 8 Related Work\n\nTreadMarks\n\nPVM PVM[15]PVMTreadMarks \n\nHPF HPF [8]Jacobi TSPILINKMIPHPF\n\nOrcaOrca [16]\n\nDASH [12] \n\nEntry Consistency [1]\n\n![13](https://github.com/ikenchina/img1/raw/master/1/treadmarks/ilink.png)\n\n13 ILINK\n\n# 9 Conclusions and Further Work\n\nTreadMarks\n\n\n\n# References\n\n[1] B.N. Bershad, M.J. Zekauskas, and W.A. Sawdon. The Midway distributed shared memory system. In Proceedings of the '93 CompCon Conference, pages 528-537, February 1993.\n[2] D. Bienstock and O. Gumluk. Computational experience with a difficult mixed-integer multi-commodity  flow problem. To appear in Mathematical Programming, 1994.\n[3] J.B. Carter, J.K. Bennett, and W. Zwaenepoel. Implementation and performance of Munin. In Proceedings of the 13th ACM Symposium on Operating Systems Principles, pages 152-164, October 1991.\n[4] S. Dwarkadas, A.A. Schffer, R.W. Cottingham Jr., A.L. Cox, P. Keleher, and W. Zwaenepoel. Parallelization of general linkage analysis problems. Human Heredity, 44:127-141, 1994.\n[5] K. Gharachorloo, D. Lenoski, J. Laudon, P. Gibbons, A. Gupta, and J. Hennessy. Memory consistency and event ordering in scalable shared-memory multiprocessors. In Proceedings of the 17th Annual International Symposium on Computer Architecture, pages 15-26, May 1990.\n[6] P. Keleher, A. L. Cox, and W. Zwaenepoel. Lazy release consistency for software distributed shared memory. In Proceedings of the 19th Annual International Symposium on Computer Architecture, pages 13-21, May 1992.\n[7] P. Keleher, S. Dwarkadas, A. Cox, and W. Zwaenepoel. Treadmarks: Distributed shared memory on standard workstations and operating systems. In Proceedings of the 1994 Winter Usenix Conference, pages 115-131, January 1994.\n[8] C. Koelbel, D. Loveman, R. Schreiber, G. Steele, Jr., and M. Zosel. The High Performance Fortran Handbook. The MIT Press, 1994.\n[9] L. Lamport. How to make a multiprocessor computer that correctly executes multiprocess programs. IEEE Transactions on Computers, C-28(9):690{691, September 1979.\n[10] G. M. Lathrop, J. M. Lalouel, C. Julier, and J. Ott. Strategies for multilocus linkage analysis in humans. Proc. Natl. Acad. Sci. USA, 81:3443-3446, June 1984.\n[11] E. Lee, R. Bixby, W. Cook, and A.L. Cox. Parallelism in mixed integer programming. Sub\u0002mitted for publication, 1994.\n[12] D. Lenoski, J. Laudon, K. Gharachorloo, A. Gupta, and J. Hennessy. The directory-based cache coherence protocol for the DASH multiprocessor. In Proceedings of the 17th Annual International Symposium on Computer Architecture, pages 148-159, May 1990.\n[13] K. Li and P. Hudak. Memory coherence in shared virtual memory systems. ACM Transactions on Computer Systems, 7(4):321-359, November 1989.\n[14] M. Litzkow, M. Livny, and M. Mutka. Condor - a hunter of idle workstations. In Proceedings of the 8th International Conference on Distributed Computing Systems, pages 104-111, June 1988.\n[15] V. Sunderam. PVM: A framework for parallel distributed computing. Concurrency:Practice and Experience, 2(4):315-339, December 1990.\n[16] A.S. Tanenbaum, M.F. Kaashoek, and H.E. Bal. Parallel programming using shared ob jects and broadcasting. IEEE Computer, 25(8):10-20, August 1992.\n[17] A.S. Tanenbaum, R. van Renesse, H. van Staveren, G.J. Sharp, S.J. Mullender, J. Jansen, and G. van Rossum. Experiences with the Amoeba distributed operating system. Communications of the ACM, 33(12):46-63, December 1990.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","slug":"TreadMarks","published":1,"updated":"2020-04-15T07:45:14.004Z","comments":1,"photos":[],"link":"","_id":"ck9115hpf0000ppfcvq9z2p4f","content":"<blockquote>\n<p>TreadMarks: <a id=\"more\"></a>  </p>\n</blockquote>\n<p>: TreadMarks: Shared Memory Computing on Networks of Workstations</p>\n<p>Christiana Amza, Alan L. Cox, Sandhya Dwarkadas, Pete Keleher,<br>Honghui Lu, Ramakrishnan Ra jamony, Weimin Yu and Willy Zwaenepoel<br>Department of Computer Science<br>Rice University    </p>\n<h1 id=\"Abstract\"><a href=\"#Abstract\" class=\"headerlink\" title=\"Abstract\"></a>Abstract</h1><p>TreadMarks  TreadMarks</p>\n<h1 id=\"1--Introduction\"><a href=\"#1--Introduction\" class=\"headerlink\" title=\"1  Introduction\"></a>1  Introduction</h1><p>[17][14]<br></p>\n<p>TreadMarksDSMDSM[13]1DSMNDSMDSMDSMDSMTreadMarks [7]UnixUnixDSMTreadMarkslazy release consistency()[6][3]TreadMarks23456TreadMarks789</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/arch1.png\" alt=\"\"></p>\n<p></p>\n<h1 id=\"2-Shared-Memory-Programming\"><a href=\"#2-Shared-Memory-Programming\" class=\"headerlink\" title=\"2 Shared Memory Programming\"></a>2 Shared Memory Programming</h1><h2 id=\"2-1-Application-Programming-Interface\"><a href=\"#2-1-Application-Programming-Interface\" class=\"headerlink\" title=\"2.1 Application Programming Interface\"></a>2.1 Application Programming Interface</h2><p>TreadMarks APIC2   </p>\n<p>TreadMarksbarrier()exclusive locks() Tmk barrier() Tmk lockTmk releaseTreadMarks TreadMarks</p>\n<h2 id=\"2-2-Two-Simple-Illustrations\"><a href=\"#2-2-Two-Simple-Illustrations\" class=\"headerlink\" title=\"2.2 Two Simple Illustrations\"></a>2.2 Two Simple Illustrations</h2><p>34TreadMarks APIJacobiTSP   7</p>\n<p>JacobiJacobi </p>\n<p>3TreadMarks0Jacobi Tmk barrier(0) 0Tmk barrier(1) Tmk barrier(2) </p>\n<p>TSP</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/* the maximum number of parallel processes supported by TreadMarks */</span><br><span class=\"line\">#define TMK_NPROCS</span><br><span class=\"line\">/* the actual number of parallel processes after Tmk_startup */</span><br><span class=\"line\">extern unsigned Tmk_nprocs;</span><br><span class=\"line\">/* the process id, an integer in the range 0 ... Tmk_nprocs - 1 */</span><br><span class=\"line\">extern unsigned Tmk_proc_id;</span><br><span class=\"line\">/* the number of lock synchronization objects provided by TreadMarks */</span><br><span class=\"line\">#define TMK_NLOCKS</span><br><span class=\"line\">/* the number of barrier synchronization objects provided by TreadMarks */</span><br><span class=\"line\">#define TMK_NBARRIERS</span><br><span class=\"line\">/* Initialize TreadMarks and start the remote processes */</span><br><span class=\"line\">void Tmk_startup(argc, argv) int argc; char **argv;</span><br><span class=\"line\">/* Terminate the calling process. Other processes are unaffected. */</span><br><span class=\"line\">void Tmk_exit(status) int status;</span><br><span class=\"line\">/* Block the calling process until every other process arrives at the barrier. */</span><br><span class=\"line\">void Tmk_barrier(id) unsigned id;</span><br><span class=\"line\">/* Block the calling process until it acquires the specified lock. */</span><br><span class=\"line\">void Tmk_lock_acquire(id) unsigned id;</span><br><span class=\"line\">/* Release the specified lock. */</span><br><span class=\"line\">void Tmk_lock_release(id) unsigned id;</span><br><span class=\"line\">/* Allocate the specified number of bytes of shared memory */</span><br><span class=\"line\">char *Tmk_malloc(size) unsigned size;</span><br><span class=\"line\">/* Free shared memory allocated by Tmk_malloc. */</span><br><span class=\"line\">void Tmk_free(ptr) char *ptr;</span><br></pre></td></tr></table></figure>\n\n<p> 2 TreadMarks C</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#define M 1024</span><br><span class=\"line\">#define N 1024</span><br><span class=\"line\">float **grid;</span><br><span class=\"line\">float scratch[M][N];</span><br><span class=\"line\"></span><br><span class=\"line\">Tmk_startup();</span><br><span class=\"line\"></span><br><span class=\"line\">if (Tmk_proc_id == 0)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    grid = Tmk_malloc(M * N * sizeof(float));</span><br><span class=\"line\">    initialize grid;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Tmk_barrier(0);</span><br><span class=\"line\">length = M / Tmk_nprocs;</span><br><span class=\"line\">begin = length * Tmk_proc_id;</span><br><span class=\"line\">end = length * (Tmk_proc_id + 1);</span><br><span class=\"line\">for (number of iterations)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    for (i = begin; i &lt; end; i++)</span><br><span class=\"line\">        for (j = 0; j &lt; N; j++)</span><br><span class=\"line\">            scratch[i][j] = (grid[i - 1][j] + grid[i + 1][j] +</span><br><span class=\"line\">                             grid[i][j - 1] + grid[i][j + 1]) / 4;</span><br><span class=\"line\">    Tmk_barrier(1);</span><br><span class=\"line\">    for (i = begin; i &lt; end; i++)</span><br><span class=\"line\">        for (j = 0; j &lt; N; j++)</span><br><span class=\"line\">            grid[i][j] = scratch[i][j];</span><br><span class=\"line\">    Tmk_barrier(2);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> 3 The TreadMarks Jacobi </p>\n<h1 id=\"Implementation-Challenges\"><a href=\"#Implementation-Challenges\" class=\"headerlink\" title=\"Implementation Challenges\"></a>Implementation Challenges</h1><p>DSMDSMIVY[13]5DSM513IVY</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">queue_type *Queue;</span><br><span class=\"line\">int *Shortest_length;</span><br><span class=\"line\">int queue_lock, tour_lock;</span><br><span class=\"line\">main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    Tmk_startup();</span><br><span class=\"line\">    queue_lock = 0;</span><br><span class=\"line\">    tour_lock = 1;</span><br><span class=\"line\">    if (Tmk_proc_id == 0)</span><br><span class=\"line\">        Queue = Tmk_malloc(sizeof(queue_type));</span><br><span class=\"line\">    Shortest_length = Tmk_malloc(sizeof(int));</span><br><span class=\"line\">    initialize Heap and Shortest_length</span><br><span class=\"line\">        Tmk_barrier(0);</span><br><span class=\"line\">    Tmk_lock_acquire(queue_lock);</span><br><span class=\"line\">    Exit if queue is empty;</span><br><span class=\"line\">    Keep adding to queue</span><br><span class=\"line\">        until a long,</span><br><span class=\"line\">        promising tour appears at the head;</span><br><span class=\"line\">    Path = Delete the tour from the head;</span><br><span class=\"line\">    Tmk_lock_release(queue_lock);</span><br><span class=\"line\">    length = recursively</span><br><span class=\"line\">    try</span><br><span class=\"line\">        all cities not on Path,</span><br><span class=\"line\">            find the shortest tour length</span><br><span class=\"line\">                Tmk_lock_acquire(tour_lock);</span><br><span class=\"line\">    if (length &lt; *Shortest_length)</span><br><span class=\"line\">        *Shortest_length = length;</span><br><span class=\"line\">    Tmk_lock_release(tour_lock);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>4 The TreadMarks TSP </p>\n<p>DSMIVY 34IVY</p>\n<p>IVYsequential consistency [9]IVY 4TSPIVY </p>\n<p>6Jacobi </p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/ivh1.png\" alt=\"\"></p>\n<p>IVH DSM</p>\n<h1 id=\"4-Lazy-Release-Consistency\"><a href=\"#4-Lazy-Release-Consistency\" class=\"headerlink\" title=\"4 Lazy Release Consistency\"></a>4 Lazy Release Consistency</h1><h2 id=\"4-1-Release-Consistency\"><a href=\"#4-1-Release-Consistency\" class=\"headerlink\" title=\"4.1 Release Consistency\"></a>4.1 Release Consistency</h2><p>[5] Gharachorloo </p>\n<p>DSM</p>\n<p>2JacobiTSPJacobibarrier 1 barrier 2barrier 2barrierbarrier</p>\n<p>TSP </p>\n<p> </p>\n<p> TreadMarks TreadMarks</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/false_sharing1.png\" alt=\"6\"></p>\n<p>Jacobi</p>\n<h2 id=\"4-2-Lazy-Release-Consistency\"><a href=\"#4-2-Lazy-Release-Consistency\" class=\"headerlink\" title=\"4.2 Lazy Release Consistency\"></a>4.2 Lazy Release Consistency</h2><p>TreadMarks[6]MuninMunin</p>\n<p>lazy release consistencyeager release consistencyMunin</p>\n<h1 id=\"5-Multiple-Writer-Protocols\"><a href=\"#5-Multiple-Writer-Protocols\" class=\"headerlink\" title=\"5 Multiple-Writer Protocols\"></a>5 Multiple-Writer Protocols</h1><p>DSM </p>\n<p>DSM</p>\n<p></p>\n<p>TreadMarks7protection faultsdiffs TreadMarkstwintwindiffdifftwin diff </p>\n<p>diffdiff</p>\n<h1 id=\"-TreadMarksThe-TreadMarks-System\"><a href=\"#-TreadMarksThe-TreadMarks-System\" class=\"headerlink\" title=\" TreadMarksThe TreadMarks System\"></a> TreadMarksThe TreadMarks System</h1><p>TreadMarksUnixUnixUnixTreadMarksCC++FORTRANTreadMarks SPARCDECStationDEC / AlphaIBM RS-6000IBM SP-1SGIATM TreadMarks</p>\n<p>TreadMarksBerkeleyATMTreadMarksUDP / IPAAL3 / 4ATM LANTreadMarksUDP / IPAAL3 / 4ATMbest-efforts delivery protocol UDP / IPAAL3 / 4TreadMarks</p>\n<p>TreadMarksTreadMarksTreadMarksTreadMarksSIGIOSIGIOAAL3 / 4select</p>\n<p>TreadMarksmprotectSIGSEGVSIGSEGVbcopytwinprocedure</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/diff1.png\" alt=\"7\"></p>\n<p>DiffCreation</p>\n<h1 id=\"7-Applications\"><a href=\"#7-Applications\" class=\"headerlink\" title=\"7 Applications\"></a>7 Applications</h1><p>TreadMarks[7]TreadMarksmixed integer programminggenetic linkage analysis</p>\n<h2 id=\"7-1-Mixed-Integer-Programming\"><a href=\"#7-1-Mixed-Integer-Programming\" class=\"headerlink\" title=\"7.1 Mixed Integer Programming\"></a>7.1 Mixed Integer Programming</h2><p>MIPLPLPMIP01 89</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/mip3.png\" alt=\"8\"></p>\n<p> 8 (MIP) </p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/mip_two1.png\" alt=\"9\"></p>\n<p>     9 MIP</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/branch_and_bound_mip2.png\" alt=\"\"></p>\n<p>10 MIP</p>\n<p>LeeMIPTreadMarks [11]MIPLPLPLP $x_{i} =  \\left \\lfloor x_{i} \\right \\rfloor$  $x_{i} =  \\left \\lceil x_{i} \\right \\rceil$ 10LP<code>plunging</code><code>cutting planes</code> LP</p>\n<p>MIPLIB51118Ultrix 4.3100Mbps Fore ATMDecStation-5000 / 2402,000 MIPLIB[2] 8IBM SP-CPU30</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/miplib2.png\" alt=\"\"></p>\n<p>11 MIPLIB</p>\n<h2 id=\"7-2-Genetic-Linkage\"><a href=\"#7-2-Genetic-Linkage\" class=\"headerlink\" title=\"7.2 Genetic Linkage\"></a>7.2 Genetic Linkage</h2><p></p>\n<p>Mendelian12 </p>\n<p>ILINK [4]LINKAGE [10]ILINKILINK</p>\n<p></p>\n<p>13ILINK BAD</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/dna1.png\" alt=\"12\"></p>\n<p>12 DNA</p>\n<h1 id=\"8-Related-Work\"><a href=\"#8-Related-Work\" class=\"headerlink\" title=\"8 Related Work\"></a>8 Related Work</h1><p>TreadMarks</p>\n<p>PVM PVM[15]PVMTreadMarks </p>\n<p>HPF HPF [8]Jacobi TSPILINKMIPHPF</p>\n<p>OrcaOrca [16]</p>\n<p>DASH [12] </p>\n<p>Entry Consistency [1]</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/ilink.png\" alt=\"13\"></p>\n<p>13 ILINK</p>\n<h1 id=\"9-Conclusions-and-Further-Work\"><a href=\"#9-Conclusions-and-Further-Work\" class=\"headerlink\" title=\"9 Conclusions and Further Work\"></a>9 Conclusions and Further Work</h1><p>TreadMarks</p>\n<h1 id=\"References\"><a href=\"#References\" class=\"headerlink\" title=\"References\"></a>References</h1><p>[1] B.N. Bershad, M.J. Zekauskas, and W.A. Sawdon. The Midway distributed shared memory system. In Proceedings of the 93 CompCon Conference, pages 528-537, February 1993.<br>[2] D. Bienstock and O. Gumluk. Computational experience with a difficult mixed-integer multi-commodity  flow problem. To appear in Mathematical Programming, 1994.<br>[3] J.B. Carter, J.K. Bennett, and W. Zwaenepoel. Implementation and performance of Munin. In Proceedings of the 13th ACM Symposium on Operating Systems Principles, pages 152-164, October 1991.<br>[4] S. Dwarkadas, A.A. Schffer, R.W. Cottingham Jr., A.L. Cox, P. Keleher, and W. Zwaenepoel. Parallelization of general linkage analysis problems. Human Heredity, 44:127-141, 1994.<br>[5] K. Gharachorloo, D. Lenoski, J. Laudon, P. Gibbons, A. Gupta, and J. Hennessy. Memory consistency and event ordering in scalable shared-memory multiprocessors. In Proceedings of the 17th Annual International Symposium on Computer Architecture, pages 15-26, May 1990.<br>[6] P. Keleher, A. L. Cox, and W. Zwaenepoel. Lazy release consistency for software distributed shared memory. In Proceedings of the 19th Annual International Symposium on Computer Architecture, pages 13-21, May 1992.<br>[7] P. Keleher, S. Dwarkadas, A. Cox, and W. Zwaenepoel. Treadmarks: Distributed shared memory on standard workstations and operating systems. In Proceedings of the 1994 Winter Usenix Conference, pages 115-131, January 1994.<br>[8] C. Koelbel, D. Loveman, R. Schreiber, G. Steele, Jr., and M. Zosel. The High Performance Fortran Handbook. The MIT Press, 1994.<br>[9] L. Lamport. How to make a multiprocessor computer that correctly executes multiprocess programs. IEEE Transactions on Computers, C-28(9):690{691, September 1979.<br>[10] G. M. Lathrop, J. M. Lalouel, C. Julier, and J. Ott. Strategies for multilocus linkage analysis in humans. Proc. Natl. Acad. Sci. USA, 81:3443-3446, June 1984.<br>[11] E. Lee, R. Bixby, W. Cook, and A.L. Cox. Parallelism in mixed integer programming. Sub\u0002mitted for publication, 1994.<br>[12] D. Lenoski, J. Laudon, K. Gharachorloo, A. Gupta, and J. Hennessy. The directory-based cache coherence protocol for the DASH multiprocessor. In Proceedings of the 17th Annual International Symposium on Computer Architecture, pages 148-159, May 1990.<br>[13] K. Li and P. Hudak. Memory coherence in shared virtual memory systems. ACM Transactions on Computer Systems, 7(4):321-359, November 1989.<br>[14] M. Litzkow, M. Livny, and M. Mutka. Condor - a hunter of idle workstations. In Proceedings of the 8th International Conference on Distributed Computing Systems, pages 104-111, June 1988.<br>[15] V. Sunderam. PVM: A framework for parallel distributed computing. Concurrency:Practice and Experience, 2(4):315-339, December 1990.<br>[16] A.S. Tanenbaum, M.F. Kaashoek, and H.E. Bal. Parallel programming using shared ob jects and broadcasting. IEEE Computer, 25(8):10-20, August 1992.<br>[17] A.S. Tanenbaum, R. van Renesse, H. van Staveren, G.J. Sharp, S.J. Mullender, J. Jansen, and G. van Rossum. Experiences with the Amoeba distributed operating system. Communications of the ACM, 33(12):46-63, December 1990.</p>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>TreadMarks: ","more":"</p>\n</blockquote>\n<p>: TreadMarks: Shared Memory Computing on Networks of Workstations</p>\n<p>Christiana Amza, Alan L. Cox, Sandhya Dwarkadas, Pete Keleher,<br>Honghui Lu, Ramakrishnan Ra jamony, Weimin Yu and Willy Zwaenepoel<br>Department of Computer Science<br>Rice University    </p>\n<h1 id=\"Abstract\"><a href=\"#Abstract\" class=\"headerlink\" title=\"Abstract\"></a>Abstract</h1><p>TreadMarks  TreadMarks</p>\n<h1 id=\"1--Introduction\"><a href=\"#1--Introduction\" class=\"headerlink\" title=\"1  Introduction\"></a>1  Introduction</h1><p>[17][14]<br></p>\n<p>TreadMarksDSMDSM[13]1DSMNDSMDSMDSMDSMTreadMarks [7]UnixUnixDSMTreadMarkslazy release consistency()[6][3]TreadMarks23456TreadMarks789</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/arch1.png\" alt=\"\"></p>\n<p></p>\n<h1 id=\"2-Shared-Memory-Programming\"><a href=\"#2-Shared-Memory-Programming\" class=\"headerlink\" title=\"2 Shared Memory Programming\"></a>2 Shared Memory Programming</h1><h2 id=\"2-1-Application-Programming-Interface\"><a href=\"#2-1-Application-Programming-Interface\" class=\"headerlink\" title=\"2.1 Application Programming Interface\"></a>2.1 Application Programming Interface</h2><p>TreadMarks APIC2   </p>\n<p>TreadMarksbarrier()exclusive locks() Tmk barrier() Tmk lockTmk releaseTreadMarks TreadMarks</p>\n<h2 id=\"2-2-Two-Simple-Illustrations\"><a href=\"#2-2-Two-Simple-Illustrations\" class=\"headerlink\" title=\"2.2 Two Simple Illustrations\"></a>2.2 Two Simple Illustrations</h2><p>34TreadMarks APIJacobiTSP   7</p>\n<p>JacobiJacobi </p>\n<p>3TreadMarks0Jacobi Tmk barrier(0) 0Tmk barrier(1) Tmk barrier(2) </p>\n<p>TSP</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/* the maximum number of parallel processes supported by TreadMarks */</span><br><span class=\"line\">#define TMK_NPROCS</span><br><span class=\"line\">/* the actual number of parallel processes after Tmk_startup */</span><br><span class=\"line\">extern unsigned Tmk_nprocs;</span><br><span class=\"line\">/* the process id, an integer in the range 0 ... Tmk_nprocs - 1 */</span><br><span class=\"line\">extern unsigned Tmk_proc_id;</span><br><span class=\"line\">/* the number of lock synchronization objects provided by TreadMarks */</span><br><span class=\"line\">#define TMK_NLOCKS</span><br><span class=\"line\">/* the number of barrier synchronization objects provided by TreadMarks */</span><br><span class=\"line\">#define TMK_NBARRIERS</span><br><span class=\"line\">/* Initialize TreadMarks and start the remote processes */</span><br><span class=\"line\">void Tmk_startup(argc, argv) int argc; char **argv;</span><br><span class=\"line\">/* Terminate the calling process. Other processes are unaffected. */</span><br><span class=\"line\">void Tmk_exit(status) int status;</span><br><span class=\"line\">/* Block the calling process until every other process arrives at the barrier. */</span><br><span class=\"line\">void Tmk_barrier(id) unsigned id;</span><br><span class=\"line\">/* Block the calling process until it acquires the specified lock. */</span><br><span class=\"line\">void Tmk_lock_acquire(id) unsigned id;</span><br><span class=\"line\">/* Release the specified lock. */</span><br><span class=\"line\">void Tmk_lock_release(id) unsigned id;</span><br><span class=\"line\">/* Allocate the specified number of bytes of shared memory */</span><br><span class=\"line\">char *Tmk_malloc(size) unsigned size;</span><br><span class=\"line\">/* Free shared memory allocated by Tmk_malloc. */</span><br><span class=\"line\">void Tmk_free(ptr) char *ptr;</span><br></pre></td></tr></table></figure>\n\n<p> 2 TreadMarks C</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#define M 1024</span><br><span class=\"line\">#define N 1024</span><br><span class=\"line\">float **grid;</span><br><span class=\"line\">float scratch[M][N];</span><br><span class=\"line\"></span><br><span class=\"line\">Tmk_startup();</span><br><span class=\"line\"></span><br><span class=\"line\">if (Tmk_proc_id == 0)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    grid = Tmk_malloc(M * N * sizeof(float));</span><br><span class=\"line\">    initialize grid;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Tmk_barrier(0);</span><br><span class=\"line\">length = M / Tmk_nprocs;</span><br><span class=\"line\">begin = length * Tmk_proc_id;</span><br><span class=\"line\">end = length * (Tmk_proc_id + 1);</span><br><span class=\"line\">for (number of iterations)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    for (i = begin; i &lt; end; i++)</span><br><span class=\"line\">        for (j = 0; j &lt; N; j++)</span><br><span class=\"line\">            scratch[i][j] = (grid[i - 1][j] + grid[i + 1][j] +</span><br><span class=\"line\">                             grid[i][j - 1] + grid[i][j + 1]) / 4;</span><br><span class=\"line\">    Tmk_barrier(1);</span><br><span class=\"line\">    for (i = begin; i &lt; end; i++)</span><br><span class=\"line\">        for (j = 0; j &lt; N; j++)</span><br><span class=\"line\">            grid[i][j] = scratch[i][j];</span><br><span class=\"line\">    Tmk_barrier(2);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> 3 The TreadMarks Jacobi </p>\n<h1 id=\"Implementation-Challenges\"><a href=\"#Implementation-Challenges\" class=\"headerlink\" title=\"Implementation Challenges\"></a>Implementation Challenges</h1><p>DSMDSMIVY[13]5DSM513IVY</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">queue_type *Queue;</span><br><span class=\"line\">int *Shortest_length;</span><br><span class=\"line\">int queue_lock, tour_lock;</span><br><span class=\"line\">main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    Tmk_startup();</span><br><span class=\"line\">    queue_lock = 0;</span><br><span class=\"line\">    tour_lock = 1;</span><br><span class=\"line\">    if (Tmk_proc_id == 0)</span><br><span class=\"line\">        Queue = Tmk_malloc(sizeof(queue_type));</span><br><span class=\"line\">    Shortest_length = Tmk_malloc(sizeof(int));</span><br><span class=\"line\">    initialize Heap and Shortest_length</span><br><span class=\"line\">        Tmk_barrier(0);</span><br><span class=\"line\">    Tmk_lock_acquire(queue_lock);</span><br><span class=\"line\">    Exit if queue is empty;</span><br><span class=\"line\">    Keep adding to queue</span><br><span class=\"line\">        until a long,</span><br><span class=\"line\">        promising tour appears at the head;</span><br><span class=\"line\">    Path = Delete the tour from the head;</span><br><span class=\"line\">    Tmk_lock_release(queue_lock);</span><br><span class=\"line\">    length = recursively</span><br><span class=\"line\">    try</span><br><span class=\"line\">        all cities not on Path,</span><br><span class=\"line\">            find the shortest tour length</span><br><span class=\"line\">                Tmk_lock_acquire(tour_lock);</span><br><span class=\"line\">    if (length &lt; *Shortest_length)</span><br><span class=\"line\">        *Shortest_length = length;</span><br><span class=\"line\">    Tmk_lock_release(tour_lock);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>4 The TreadMarks TSP </p>\n<p>DSMIVY 34IVY</p>\n<p>IVYsequential consistency [9]IVY 4TSPIVY </p>\n<p>6Jacobi </p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/ivh1.png\" alt=\"\"></p>\n<p>IVH DSM</p>\n<h1 id=\"4-Lazy-Release-Consistency\"><a href=\"#4-Lazy-Release-Consistency\" class=\"headerlink\" title=\"4 Lazy Release Consistency\"></a>4 Lazy Release Consistency</h1><h2 id=\"4-1-Release-Consistency\"><a href=\"#4-1-Release-Consistency\" class=\"headerlink\" title=\"4.1 Release Consistency\"></a>4.1 Release Consistency</h2><p>[5] Gharachorloo </p>\n<p>DSM</p>\n<p>2JacobiTSPJacobibarrier 1 barrier 2barrier 2barrierbarrier</p>\n<p>TSP </p>\n<p> </p>\n<p> TreadMarks TreadMarks</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/false_sharing1.png\" alt=\"6\"></p>\n<p>Jacobi</p>\n<h2 id=\"4-2-Lazy-Release-Consistency\"><a href=\"#4-2-Lazy-Release-Consistency\" class=\"headerlink\" title=\"4.2 Lazy Release Consistency\"></a>4.2 Lazy Release Consistency</h2><p>TreadMarks[6]MuninMunin</p>\n<p>lazy release consistencyeager release consistencyMunin</p>\n<h1 id=\"5-Multiple-Writer-Protocols\"><a href=\"#5-Multiple-Writer-Protocols\" class=\"headerlink\" title=\"5 Multiple-Writer Protocols\"></a>5 Multiple-Writer Protocols</h1><p>DSM </p>\n<p>DSM</p>\n<p></p>\n<p>TreadMarks7protection faultsdiffs TreadMarkstwintwindiffdifftwin diff </p>\n<p>diffdiff</p>\n<h1 id=\"-TreadMarksThe-TreadMarks-System\"><a href=\"#-TreadMarksThe-TreadMarks-System\" class=\"headerlink\" title=\" TreadMarksThe TreadMarks System\"></a> TreadMarksThe TreadMarks System</h1><p>TreadMarksUnixUnixUnixTreadMarksCC++FORTRANTreadMarks SPARCDECStationDEC / AlphaIBM RS-6000IBM SP-1SGIATM TreadMarks</p>\n<p>TreadMarksBerkeleyATMTreadMarksUDP / IPAAL3 / 4ATM LANTreadMarksUDP / IPAAL3 / 4ATMbest-efforts delivery protocol UDP / IPAAL3 / 4TreadMarks</p>\n<p>TreadMarksTreadMarksTreadMarksTreadMarksSIGIOSIGIOAAL3 / 4select</p>\n<p>TreadMarksmprotectSIGSEGVSIGSEGVbcopytwinprocedure</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/diff1.png\" alt=\"7\"></p>\n<p>DiffCreation</p>\n<h1 id=\"7-Applications\"><a href=\"#7-Applications\" class=\"headerlink\" title=\"7 Applications\"></a>7 Applications</h1><p>TreadMarks[7]TreadMarksmixed integer programminggenetic linkage analysis</p>\n<h2 id=\"7-1-Mixed-Integer-Programming\"><a href=\"#7-1-Mixed-Integer-Programming\" class=\"headerlink\" title=\"7.1 Mixed Integer Programming\"></a>7.1 Mixed Integer Programming</h2><p>MIPLPLPMIP01 89</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/mip3.png\" alt=\"8\"></p>\n<p> 8 (MIP) </p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/mip_two1.png\" alt=\"9\"></p>\n<p>     9 MIP</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/branch_and_bound_mip2.png\" alt=\"\"></p>\n<p>10 MIP</p>\n<p>LeeMIPTreadMarks [11]MIPLPLPLP $x_{i} =  \\left \\lfloor x_{i} \\right \\rfloor$  $x_{i} =  \\left \\lceil x_{i} \\right \\rceil$ 10LP<code>plunging</code><code>cutting planes</code> LP</p>\n<p>MIPLIB51118Ultrix 4.3100Mbps Fore ATMDecStation-5000 / 2402,000 MIPLIB[2] 8IBM SP-CPU30</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/miplib2.png\" alt=\"\"></p>\n<p>11 MIPLIB</p>\n<h2 id=\"7-2-Genetic-Linkage\"><a href=\"#7-2-Genetic-Linkage\" class=\"headerlink\" title=\"7.2 Genetic Linkage\"></a>7.2 Genetic Linkage</h2><p></p>\n<p>Mendelian12 </p>\n<p>ILINK [4]LINKAGE [10]ILINKILINK</p>\n<p></p>\n<p>13ILINK BAD</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/dna1.png\" alt=\"12\"></p>\n<p>12 DNA</p>\n<h1 id=\"8-Related-Work\"><a href=\"#8-Related-Work\" class=\"headerlink\" title=\"8 Related Work\"></a>8 Related Work</h1><p>TreadMarks</p>\n<p>PVM PVM[15]PVMTreadMarks </p>\n<p>HPF HPF [8]Jacobi TSPILINKMIPHPF</p>\n<p>OrcaOrca [16]</p>\n<p>DASH [12] </p>\n<p>Entry Consistency [1]</p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/treadmarks/ilink.png\" alt=\"13\"></p>\n<p>13 ILINK</p>\n<h1 id=\"9-Conclusions-and-Further-Work\"><a href=\"#9-Conclusions-and-Further-Work\" class=\"headerlink\" title=\"9 Conclusions and Further Work\"></a>9 Conclusions and Further Work</h1><p>TreadMarks</p>\n<h1 id=\"References\"><a href=\"#References\" class=\"headerlink\" title=\"References\"></a>References</h1><p>[1] B.N. Bershad, M.J. Zekauskas, and W.A. Sawdon. The Midway distributed shared memory system. In Proceedings of the 93 CompCon Conference, pages 528-537, February 1993.<br>[2] D. Bienstock and O. Gumluk. Computational experience with a difficult mixed-integer multi-commodity  flow problem. To appear in Mathematical Programming, 1994.<br>[3] J.B. Carter, J.K. Bennett, and W. Zwaenepoel. Implementation and performance of Munin. In Proceedings of the 13th ACM Symposium on Operating Systems Principles, pages 152-164, October 1991.<br>[4] S. Dwarkadas, A.A. Schffer, R.W. Cottingham Jr., A.L. Cox, P. Keleher, and W. Zwaenepoel. Parallelization of general linkage analysis problems. Human Heredity, 44:127-141, 1994.<br>[5] K. Gharachorloo, D. Lenoski, J. Laudon, P. Gibbons, A. Gupta, and J. Hennessy. Memory consistency and event ordering in scalable shared-memory multiprocessors. In Proceedings of the 17th Annual International Symposium on Computer Architecture, pages 15-26, May 1990.<br>[6] P. Keleher, A. L. Cox, and W. Zwaenepoel. Lazy release consistency for software distributed shared memory. In Proceedings of the 19th Annual International Symposium on Computer Architecture, pages 13-21, May 1992.<br>[7] P. Keleher, S. Dwarkadas, A. Cox, and W. Zwaenepoel. Treadmarks: Distributed shared memory on standard workstations and operating systems. In Proceedings of the 1994 Winter Usenix Conference, pages 115-131, January 1994.<br>[8] C. Koelbel, D. Loveman, R. Schreiber, G. Steele, Jr., and M. Zosel. The High Performance Fortran Handbook. The MIT Press, 1994.<br>[9] L. Lamport. How to make a multiprocessor computer that correctly executes multiprocess programs. IEEE Transactions on Computers, C-28(9):690{691, September 1979.<br>[10] G. M. Lathrop, J. M. Lalouel, C. Julier, and J. Ott. Strategies for multilocus linkage analysis in humans. Proc. Natl. Acad. Sci. USA, 81:3443-3446, June 1984.<br>[11] E. Lee, R. Bixby, W. Cook, and A.L. Cox. Parallelism in mixed integer programming. Sub\u0002mitted for publication, 1994.<br>[12] D. Lenoski, J. Laudon, K. Gharachorloo, A. Gupta, and J. Hennessy. The directory-based cache coherence protocol for the DASH multiprocessor. In Proceedings of the 17th Annual International Symposium on Computer Architecture, pages 148-159, May 1990.<br>[13] K. Li and P. Hudak. Memory coherence in shared virtual memory systems. ACM Transactions on Computer Systems, 7(4):321-359, November 1989.<br>[14] M. Litzkow, M. Livny, and M. Mutka. Condor - a hunter of idle workstations. In Proceedings of the 8th International Conference on Distributed Computing Systems, pages 104-111, June 1988.<br>[15] V. Sunderam. PVM: A framework for parallel distributed computing. Concurrency:Practice and Experience, 2(4):315-339, December 1990.<br>[16] A.S. Tanenbaum, M.F. Kaashoek, and H.E. Bal. Parallel programming using shared ob jects and broadcasting. IEEE Computer, 25(8):10-20, August 1992.<br>[17] A.S. Tanenbaum, R. van Renesse, H. van Staveren, G.J. Sharp, S.J. Mullender, J. Jansen, and G. van Rossum. Experiences with the Amoeba distributed operating system. Communications of the ACM, 33(12):46-63, December 1990.</p>"},{"category":"read","title":"grpc","date":"2018-06-01T16:00:00.000Z","_content":"\n\n> grpc <!-- more -->  \n\n\n\n# gRPC\n\n\n\n# \n\n\ngRPCgoogleHTTP/2Protobuf RPC   \n\n\n   \n  tracing  \n   \n   TCP \n\n\n\n****\n\n- \n- \n- \n- \n\n\n\n\n# \n\n**HTTP/2**\n\nHTTP/2    \ngRPC HTTP2 HTTP Body Header \n\n\n**IDLProtoBuffer**\n\ngRPCProtoBufProtoBufGoogleXMLJSON   \nProtoBuf  \n\n\n\n****\n\ngRPC  \n\n C#, C++, Dart, Go, Java, Node, Objective-C, PHP, Python, Ruby  \n\n[](https://grpc.io/docs/quickstart/)\n\n\n# HTTP/2\n\n## HTTP/2\n\nHTTP/1.x 1  \nHTTP/2 2\n\nHTTP/1  HTTP/2 GET/PUST/PUT/DELETE200/404/500Range RequestCacheingAuthenticationURL\n\n\n**HTTP/2**\n- Stream  streams\n- Message  requestresponse\n- FrameHTTP/2  Frame  stream message  frame \n\n\n\n**HTTP/2 **   \n\nHTTP/2(frame)\n\n  \nID\n\n\n[Frame : ](https://httpwg.org/specs/rfc7540.html#rfc.section.4.1)\n```\n+-----------------------------------------------+\n|                 Length (24)                   |\n+---------------+---------------+---------------+\n|   Type (8)    |   Flags (8)   |\n+-+-------------+---------------+-------------------------------+\n|R|                 Stream Identifier (31)                      |\n+=+=============================================================+\n|                   Frame Payload (0...)                      ...\n+---------------------------------------------------------------+\n```\n\n- Length   Frame \n- Type Frame  DATAHEADERSSETTINGS \n- Flags 88stream(END_STREAM)header(END_HEADERS)priority\n- R\n- Stream Identifierframe stream 0 frame (SETTINGS)\n- Frame Payload\n\n\n\n\n****  \n- HEADERS HTTP/1 Headers\n- DATA HTTP/1 Body\n- CONTINUATION HEADERS+CONTINUATION\n- SETTINGS \n- WINDOW_UPDATE \n- PUSH_PROMISE \n- PRIORITY \n- PING RTT\n- RST_STREAM \n- GOAWAY \n\n\n\n## HTTP/2 \n\n**Binary Format**\n\nHTTP/1   \nHTTP/2\n\n\n\n**MultiPlexing**\n\nHTTP/1 requestrequest TCP connectionTCP connection\n\nHTTP/2 TCP connectionstreams(SETTINGS_MAX_CONCURRENT_STREAMS) streams frames  \n\n\nSETTINGS`SETTINGS_MAX_CONCURRENT_STREAMS`  \nstreams  \n\n>  ID  server  client  GOAWAY frame  client \n\n\n\n**header**\n\nHTTP/1 header\n\nHTTP/2 \n- HPACK \n- headersheaders\n  - HTTP/2 headlist  headerheader\n\n\n[HPACK: Header Compression for HTTP/2](http://http2.github.io/http2-spec/compression.html)\n\n\n****\n\nserver push :   \n\n\nServer PushPUSH_PROMISE\nPUSH_PROMISE\n\n\n\n\n****\n\n  \n\n HEADERS  PRIORITY  PRIORITY \n\n[](http://http2.github.io/http2-spec/#StreamPriority)\n\n\n**Flow Control**\n\nHTTP/2 receiver streamconnection  \nTCPconnection  \n\n\n \n- Flow control  : Receiver  stream  window size\n- Flow control  : Receiver  sender   stream  flow control window size\n- Flow control  \n- Flow control WINDOW_UPDATE\n- Flow control  hop-by-hop end-to-end nginxproxyflow controlnginxserverclientnginxconnection\n\n\n> Connection  stream  flow-control window  65535  \nConnection  stream (stream) SETTINGS  `SETTINGS_INITIAL_WINDOW_SIZE` stream flow-control window \n\n\n\n> flow control window size\n\n\n\n****\n\nHTTP/1 bodylengthTCP connectionTCP\n\nHTTP/2  RST_STREAM frame \n\n\n## HTTP/2 demo\n\nHTTP/1  HTTP/2    \nhttps://http2.akamai.com/demo\n\nhttp2   \nhttps://http2.golang.org/\n\n\n\n# ProtoBuf \n\n## ProtoBuf \n\n**Google Protocol Buffer**  \n\n RPC \n\n\n- \n- \n- \n- \n- \n\n\n**gRPCprotobuf**\n\ngRPC protobuf IDL rpc \nproto\n\n-     \n- rpc   gRPC\n\n\n\n\n\n## protobuf \n\nhttps://developers.google.com/protocol-buffers/docs/proto#scalar\n\n\n## \n\nuser.proto\n```\nsyntax = \"proto3\";\n\nimport \"google/protobuf/any.proto\";\n\n//package user;\noption go_package = \"protos_golang/user\";\n\nmessage User {\n  int32 id = 1;\n  string name = 2;\n  uint32 age = 3;\n  enum Flag {\n    NORMAL = 0;\n    VIP = 1;\n    SVIP = 2;\n  }\n  repeated int32 friends_ids = 5;\n  reserved 6, 7, 8;\n  message Command {\n      int32 id = 1;\n      oneof cmd_value {\n         string name = 2;\n         int32 age = 3;\n      }\n  }\n  Command cmd = 9;\n  map<int32, string> tags = 10;\n  google.protobuf.Any details = 11;\n}\n```\n\n**package**\n\npackage\npackage(go)(c++, java)\n\n`option go_package = \"protos_golang/user\";`   \n`$LANGUAGE_package` import pathpackage\n\n\n**import**\n\n.proto  \nproto `package.` proto  \n`common.Flag` \n\n****\n\n  \n \n\n\n\n****\n\n`syntax = \"proto2\"; ` proto2  \n`syntax = \"proto3\"; ` proto3  \n\n\n****\n\nrequired  optional proto2proto3  \nproto3optional[](https://github.com/protocolbuffers/protobuf/issues/2497) \n\n- required : \n- optional \n- repeated \n- reserved protobuf\n\n\n****\n\n enum 0\n\n\n**oneof**\n\noneof(UNION)\n\n**map**\n\nmap   \nkey_type  int  string floatdouble  bytes\n\n**any**\n\nAny:\n- bytes : bytes\n- URL : \n\n`import google/protobuf/any.proto`any\n\nanyproto2extension\n\n\n\n****\n\n\n\n\n## \n\n```\nsyntax = \"proto2\";\n\nimport \"user.proto\";\n\nservice UserService {\n// rpc interface\n    rpc GetUserInfo(UserRequest) returns (UserResponse) {}\n}\n\nmessage UserRequest {\n    uint32 id = 1;\n}\n\nmessage UserResponse {\n    user.User user = 1;\n}\n```\n\n .proto  RPC   stubs\n\n`import \"user.proto\";` userproto\n\n\n\n## \n\nprotoc  \nprotoc`protoc-gen-$LANGUAGE`   \n\n`--go_out`protoc`go``protoc-gen-go`\n\n\n\n****\n- protoc  protoc-gen-xx\n- `CodeGeneratorRequest`protobuf protoc-gen-xx\n  - protoc-gen-xx`CodeGeneratorRequest`\n  - `CodeGeneratorRequest``FileDescriptorProto`proto\n  - `FileDescriptorProto`\n  - `CodeGeneratorResponse`\n- protocprotoc-gen-xx\n\n\n\n[plugin.proto](https://github.com/protocolbuffers/protobuf/blob/master/src/google/protobuf/compiler/plugin.proto)`CodeGeneratorRequest`  `CodeGeneratorResponse`protoc  \n\n[descriptor.proto](https://github.com/protocolbuffers/protobuf/blob/master/src/google/protobuf/descriptor.proto)`.proto`\n\n\n**plugins**\n\nplugins\n\ngo grpc\n```\nprotoc --go_out=plugins=grpc:. pb/user.proto\n```\ngrpc proto-gen-goplugin  \n\n[](https://github.com/golang/protobuf/blob/master/protoc-gen-go/grpc/grpc.go#L72) \n\n`Name()`grpcplugin`plugins=grpc`\n```\n// Name returns the name of this plugin, \"grpc\".\nfunc (g *grpc) Name() string {\n\treturn \"grpc\"\n}\n```\n\n\n\n\n\n\n# gRPC \n\n## \n\n\n![image](https://grpc.io/img/landing-2.svg)\n\n\ngRPC   \nrpcgRPC   \n\"stub\"rpc  \n\n\n\n\n## \n\n\ngRPCHTTP2steam identifierIDstream\n\nHEADER frame  \nprotobufDATA frame\n\n\n### \n\nRequest Request-Headers  Data  EOS (END_STREAM)  \n\n\n\n![image](https://github.com/ikenchina/img1/raw/master/1/network/rpc/grpc/debug/wireshark/grpc_request_stream_decoded_wireshark.png)\n\n\n**Request-Headers**  \n\nRequest-Headers  HEADERS  CONTINUATION frames   \nFlags`END_HEADERS`Request-Headers  \n\n\nRequest-Headers  `Call-Definition`  `Custom-Metadata` :\n- Call-Definition :  Method, Scheme, Path, TE, Authority, Timeout, Content-Type ,Message-Type, Message-Encoding, Message-Accept-Encoding, User-Agent\n- Custom-Metadata :  key-valuekey gRPCkey `grpc-` \n\n\n**Data**\n\n Data frame  \nFlags`END_STREAM`Data \n\n\n**request**\n\n```\n# request-headers \n\nHEADERS (flags = END_HEADERS)\n:method = POST\n:scheme = http\n:path = /user.UserService/GetUserInfo\n:authority = localhost:50000\ngrpc-timeout = 999127u\ncontent-type = grpc-go/1.20.0-dev\n\n## metadata\nservice : test_client\ntraceid : xxxx\n\n# data\nDATA (flags = END_STREAM)\n<Length-Prefixed Message>\n```\n\n\n\n### \n\nResponse  Response-Headers  Data  Trailers   \n Trailers-Only\n\n\n\n\n![image](https://github.com/ikenchina/img1/raw/master/1/network/rpc/grpc/debug/wireshark/grpc_response_stream_decoded_wireshark.png)\n\n\n**Response-Headers**\n\nResponse-Headers  : HTTP-Status, Message-Encoding, Message-Accept-Encoding, Content-Type, Custom-Metadata\n\n**Data**\n\n Data frame  \nFlags`END_STREAM`Data \n\n**Trailers**\n\nTrailers-Only  HTTP-Status, Content-Type, Trailers\n\nTrailers  Status, Status-Message, Custom-Metadata\n\nTrailers  \nbody \n\n\n\n```\n# response-headers\n\nHEADERS (flags = END_HEADERS)\n:status = status: 200 \ncontent-type = application/grpc\n\n## metadata\nservice: server_test\nspanid: xxxx\n\n\n# data\nDATA\n<Length-Prefixed Message>\n\n# headers\nHEADERS (flags = END_STREAM, END_HEADERS)\ngrpc-status: 0\n\n## trailers metadata\ntimestamp: 1560656283730441829\n\n```\n\n\n**Status code**\n\n[HTTPgRPC](https://github.com/grpc/grpc/blob/master/doc/statuscodes.md)\n\n\n\n\n## gRPC\n\ngRPC: \n\n1 unary RPC \n\nrpc \n\n```\n# \n# proto\nrpc GetUserInfo (UserRequest) returns (UserResponse) {}\n```\n\n\n2 Server-side streaming RPC \n\nrpc \n\n\n\n```\n# \n# proto\nrpc UserLocationsStream(UserRequest) returns (stream LocationsResponse) {}\n```\n\n\n\n3 Client-side streaming RPC \n\nrpc \n\n\n\n```\n# \n# proto\nrpc BackupStream(stream BackupRequest) returns (BackupResponse) {}\n```\n\n4 Bidirectional streaming RPC \n\nrpc \n\n\n\n```\n# \n# proto\nrpc LiveChat(stream Message) returns (stream Message) {}\n```\n\n\n\n## \n\n\n**waitForReady**\n\nconnectionreadyconnection ready (deadline) \n`fail fast`\n\n\n**timeout**\n\n  \nDEADLINE_EXCEEDED \n\n\n**maxRequestMessageBytes**\n\npayload size()  \nRESOURCE_EXHAUSTED \n\n\n**maxResponseMessageBytes**\n\npayload size()  \nRESOURCE_EXHAUSTED \n\n\n\n---\n\n\n# gRPC \n\ngodemo\n\n\n## \n\n**protoc**\n\nmac\n```\nbrew install protobuf\n```\n\nlinux\n```\nPROTOC_ZIP=protoc-3.5.1-linux-x86_64.zip\ncurl -OL https://github.com/protocolbuffers/protobuf/releases/download/v3.5.1/$PROTOC_ZIP\n\nsudo unzip -o $PROTOC_ZIP -d /usr/local bin/protoc\nsudo unzip -o $PROTOC_ZIP -d /usr/local include/*\nrm -f $PROTOC_ZIP\n```\n\n**golangprotobuffers**\n```\ngo get -u github.com/golang/protobuf/{protoc-gen-go,proto}\n\n```\n\n## Coding\n\n### proto\n\n```\nsyntax = \"proto3\";\n\nimport \"google/protobuf/any.proto\";\n\n//package user;\noption go_package = \"protos_golang/user\";\n\nmessage User {\n  int32 id = 1;\n  string name = 2;\n  uint32 age = 3;\n  enum Flag {\n    NORMAL = 0;\n    VIP = 1;\n    SVIP = 2;\n  }\n  repeated int32 friends_ids = 5;\n  reserved 6, 7, 8;\n  message Command {\n      int32 id = 1;\n      oneof cmd_value {\n         string name = 2;\n         int32 age = 3;\n      }\n  }\n  Command cmd = 9;\n  map<int32, string> tags = 10;\n  google.protobuf.Any details = 11;\n}\n\nservice UserService {\n// rpc interface\n    rpc GetUserInfo(UserRequest) returns (UserResponse) {}\n}\n\nmessage UserRequest {\n    uint32 id = 1;\n}\n\nmessage UserResponse {\n    User user = 1;\n}\n```\n\n### \n\n****\n```\n## protos_golang  \n## user : golang package \noption go_package = \"protos_golang/user\";\n```\n\n\n****\n\n- rpc`plugins=grpc`\n- `--go_out=.`  ``; :`--go_out=/tmp`\n-   \n  - .pb`go_package` :  `./$go_package/user.pb.go`\n  - .pb`go_package` :  `./pb/user.pb.go`\n\n```\nprotoc --go_out=plugins=grpc:. pb/user.proto\n\n# rpc\nprotoc --go_out=. pb/user.proto\n```\n\n\n\n### \n\n\n```\npackage main\n\nimport (\n\t\"context\"\n\t\"log\"\n\t\"net\"\n\n    \"google.golang.org/grpc\"\n    \"google.golang.org/grpc/reflection\"\n    \n\tpb \"testgrpc/protos_golang/user\"\n)\n\nconst (\n\tport = \":50000\"\n)\n\n// grpc server\ntype server struct{}\n\n// gRPC\nfunc (s *server) GetUserInfo(ctx context.Context, in *pb.UserRequest) (*pb.UserResponse, error) {\n\n\treturn &pb.UserResponse{\n\t\tUser: &pb.User{\n\t\t\tName: \"test_user\",\n\t\t},\n\t}, nil\n}\n\n// \nfunc LogUnaryInterceptorMiddleware() grpc.UnaryServerInterceptor {\n\treturn func(ctx context.Context, req interface{}, info *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (r interface{}, err error) {\n\t\tr, err = handler(ctx, req)\n\n\t\tfmt.Printf(\"fullMethod(%s), errCode(%v)\\n\", info.FullMethod, err)\n\t\treturn r, err\n\t}\n}\n\n\nfunc main() {\n\tlis, err := net.Listen(\"tcp\", port)\n\tif err != nil {\n\t\tlog.Fatalf(\"failed to listen: %v\", err)\n\t}\n\n    // \n    options := grpc.UnaryInterceptor(LogUnaryInterceptorMiddleware())\n\ts := grpc.NewServer(options)\n\t\n\t// \n\tpb.RegisterUserServiceServer(s, &server{})\n\t\n\t// \n\treflection.Register(s)\n\t\n\t// \n\tif err := s.Serve(lis); err != nil {\n\t\tlog.Fatalf(\"failed to serve: %v\", err)\n\t}\n}\n\n```\n\n\n\n\n### \n```\n\npackage main\n\nimport (\n\t\"context\"\n\t\"log\"\n\t\"time\"\n\n\t\"google.golang.org/grpc\"\n\n\tpb \"testgrpc/protos_golang/user\"\n)\n\nconst (\n\taddress = \"localhost:50000\"\n)\n\nfunc main() {\n\n\tconn, err := grpc.Dial(address, grpc.WithInsecure())\n\tif err != nil {\n\t\tlog.Fatalf(\"did not connect: %v\", err)\n\t}\n\tdefer conn.Close()\n\tc := pb.NewUserServiceClient(conn)\n\n\tctx, cancel := context.WithTimeout(context.Background(), time.Second)\n\tdefer cancel()\n\n\tr, err := c.GetUserInfo(ctx, &pb.UserRequest{})\n\tif err != nil {\n\t\tlog.Fatalf(\"fatal: %v\", err)\n\t}\n\n\tlog.Printf(\"response: %s\", r)\n}\n\n```\n\n\n\n### \n\nreflection  \n```\nreflection.Register(grpcServer)\n```\n\n\n\n- [grpc_cli](https://github.com/grpc/grpc/blob/master/doc/command_line_tool.md : \n- [grpcurl](https://github.com/fullstorydev/grpcurl) : go\n\n\n\n**service**\n\n`-plaintext`\n```\n$ grpcurl -plaintext localhost:50000 list \ngrpc.reflection.v1alpha.ServerReflection\nuser.UserService\n```\n\n****\n\n```\n$ grpcurl -plaintext localhost:50000 list  user.UserService\nuser.UserService.GetUserInfo\n```\n\n****\n\n```\n$ grpcurl -plaintext localhost:50000 describe user.UserService.GetUserInfo\nuser.UserService.GetUserInfo is a method:\nrpc GetUserInfo ( .user.UserRequest ) returns ( .user.UserResponse );\n```\n\n****\n\n```\n$ grpcurl -plaintext localhost:50000 describe .user.UserRequest\nuser.UserRequest is a message:\nmessage UserRequest {\n  uint32 id = 1;\n}\n\n```\n\n****\n\njson \n\n```\n$ grpcurl -plaintext -d '{\"id\":1}'   localhost:50000  user.UserService.GetUserInfo\n{\n  \"user\": {\n    \"name\": \"test_user\"\n  }\n}\n```\n\n\n\n\n## go gRPC \n\n### \n\n\n****\n\nrpc  \n\n\n[](https://godoc.org/google.golang.org/grpc/metadata)\n\n\n****\n\n :\n-  : grpcurl reflectionlist\n- gRPC \n\n\n[](https://godoc.org/google.golang.org/grpc/reflection)\n\n\n\n\n****\n\n\n\n\n[](https://godoc.org/google.golang.org/grpc/balancer)\n\n\n****  \n\ngRPC\n- SSL/TLS\n- Token\n\n\n\n\n[](https://godoc.org/google.golang.org/grpc/credentials)  \n- alts  \n- google \n- oauth\n- \n\n\n[go-grpc-middleware](https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/auth)\n\n\n\n****\n\n\n`Check`  \n\n\n\n[](https://godoc.org/google.golang.org/grpc/health)\n\n\n**keepalive**\n\nHTTP/2.0 pings connection   \nkeepaliveconnection\n\n\n[](https://godoc.org/google.golang.org/grpc/keepalive)\n\n\n**naming**\n\n  \n  \n\nbalancer  \n\n[](https://godoc.org/google.golang.org/grpc/naming)\n\n\n\n****\n\n  \n\nbalancer \n\n[go-grpc-middleware](https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/ratelimit)\n\n\n\n\n**recovery**\n\ngRPC  \n\n[go-grpc-middleware](https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/recovery)  recover gopanic gRPC\n\n\n\n\n****\n\ngRPC\n\n[go-grpc-middleware](https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/retry)\n\n\n\n\n**tracing**\n\ntracingopentracing``\n\ntracingtraceid,spanid,,,  \nspanidspanidparent_spanidrpc\n\n\n[go-grpc-middlewareopentracingmiddleware](https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/tracing/opentracing)\n\n[open-tracing](https://opentracing.io/docs/)\n\n\n\n\n### \n\n[go-kit](https://github.com/go-kit) :   \n[micro](https://github.com/micro) :   \n[go-chassis](https://github.com/go-chassis/go-chassis) : go  \n[go-grpc-middleware](https://github.com/grpc-ecosystem/go-grpc-middleware) :   \n[grpc-gateway](https://github.com/grpc-ecosystem/grpc-gateway)  protoc  gRPC  RESTful API  swagger   \n\n\n\n\n\n### gRPC  \n\n**LB(Balancing-aware Client)**\n\n\n\n- \n- \n- \n- \n\n\n- \n- sdk\n\n\n\n[](https://godoc.org/google.golang.org/grpc/balancer)\n\n\n\n\n**LB(Proxy Model)**\n\nproxy   \n\n\n\n- \n- \n- \n\n\n***Nginx***\n\n> Nginx(1.13.10gRPC) \n\n\n\n\n```\nupstream grpcservers {\n    server localhost:50000;\n    server localhost:50001;\n}\n\nserver {\n    listen 9000 http2;\n\n    # router\n    location /user.UserService {\n        grpc_pass grpc://grpcservers;\n        error_page 502 = /error502grpc;\n    }\n    \n    # gRPC\n    location = /error502grpc {\n        internal;\n        default_type application/grpc;\n        add_header grpc-status 14;\n        add_header grpc-message \"unavailable\";\n        return 204;\n    }\n}\n```\n\n[nginx gRPC module](https://nginx.org/en/docs/http/ngx_http_grpc_module.html)\n\n\n\n\n**LB(External Load Balancing Service)**\n\nLB  \nsdk  \nservice mesh\n\n\n- \n- \n\n  \n- [Istio](https://istio.io/)  \n- [Envoy](https://github.com/lyft/envoy)\n\n\n\n\n\n\n\n---\n\n# gRPC \n\n## \n\n grpc  RPC  HTTP/2 \n \n[grpc-ecosystem](https://github.com/grpc-ecosystem) gRPC  \n\n\n[awesome-grpc](https://github.com/grpc-ecosystem/awesome-grpc) gRPC   \n\n\n\n\n## grpc \n\n****\n\n-  : https://grpc.io/docs/ \n- github  grpc  doc  https://github.com/grpc/grpc/tree/master/doc\n-  : https://grpc.io/blog/\n\n****\n\nhttps://grpc.io/community/ \n- \n- Gitter\n- Reddit\n- Meetup Group \n\n\n\n\n\n\n\n\n\n\n# \n\n[grpc.io](https://grpc.io/docs/guides)\n\n[developers.google.com](https://developers.google.com/protocol-buffers/docs)\n\n[gRPC github doc](https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-HTTP2.md#Requests)\n\n[http2 specs](https://tools.ietf.org/html/rfc7540)    \nor   \n[github http2 spec](http://http2.github.io/http2-spec/#StreamPriority)\n","source":"_posts/grpc.md","raw":"---\ncategory: \"read\"\ntitle:  \"grpc\"\ncategories: \n- 2018\ntags:\n- rpc\n- grpc\ndate: 2018-06-02\n---\n\n\n> grpc <!-- more -->  \n\n\n\n# gRPC\n\n\n\n# \n\n\ngRPCgoogleHTTP/2Protobuf RPC   \n\n\n   \n  tracing  \n   \n   TCP \n\n\n\n****\n\n- \n- \n- \n- \n\n\n\n\n# \n\n**HTTP/2**\n\nHTTP/2    \ngRPC HTTP2 HTTP Body Header \n\n\n**IDLProtoBuffer**\n\ngRPCProtoBufProtoBufGoogleXMLJSON   \nProtoBuf  \n\n\n\n****\n\ngRPC  \n\n C#, C++, Dart, Go, Java, Node, Objective-C, PHP, Python, Ruby  \n\n[](https://grpc.io/docs/quickstart/)\n\n\n# HTTP/2\n\n## HTTP/2\n\nHTTP/1.x 1  \nHTTP/2 2\n\nHTTP/1  HTTP/2 GET/PUST/PUT/DELETE200/404/500Range RequestCacheingAuthenticationURL\n\n\n**HTTP/2**\n- Stream  streams\n- Message  requestresponse\n- FrameHTTP/2  Frame  stream message  frame \n\n\n\n**HTTP/2 **   \n\nHTTP/2(frame)\n\n  \nID\n\n\n[Frame : ](https://httpwg.org/specs/rfc7540.html#rfc.section.4.1)\n```\n+-----------------------------------------------+\n|                 Length (24)                   |\n+---------------+---------------+---------------+\n|   Type (8)    |   Flags (8)   |\n+-+-------------+---------------+-------------------------------+\n|R|                 Stream Identifier (31)                      |\n+=+=============================================================+\n|                   Frame Payload (0...)                      ...\n+---------------------------------------------------------------+\n```\n\n- Length   Frame \n- Type Frame  DATAHEADERSSETTINGS \n- Flags 88stream(END_STREAM)header(END_HEADERS)priority\n- R\n- Stream Identifierframe stream 0 frame (SETTINGS)\n- Frame Payload\n\n\n\n\n****  \n- HEADERS HTTP/1 Headers\n- DATA HTTP/1 Body\n- CONTINUATION HEADERS+CONTINUATION\n- SETTINGS \n- WINDOW_UPDATE \n- PUSH_PROMISE \n- PRIORITY \n- PING RTT\n- RST_STREAM \n- GOAWAY \n\n\n\n## HTTP/2 \n\n**Binary Format**\n\nHTTP/1   \nHTTP/2\n\n\n\n**MultiPlexing**\n\nHTTP/1 requestrequest TCP connectionTCP connection\n\nHTTP/2 TCP connectionstreams(SETTINGS_MAX_CONCURRENT_STREAMS) streams frames  \n\n\nSETTINGS`SETTINGS_MAX_CONCURRENT_STREAMS`  \nstreams  \n\n>  ID  server  client  GOAWAY frame  client \n\n\n\n**header**\n\nHTTP/1 header\n\nHTTP/2 \n- HPACK \n- headersheaders\n  - HTTP/2 headlist  headerheader\n\n\n[HPACK: Header Compression for HTTP/2](http://http2.github.io/http2-spec/compression.html)\n\n\n****\n\nserver push :   \n\n\nServer PushPUSH_PROMISE\nPUSH_PROMISE\n\n\n\n\n****\n\n  \n\n HEADERS  PRIORITY  PRIORITY \n\n[](http://http2.github.io/http2-spec/#StreamPriority)\n\n\n**Flow Control**\n\nHTTP/2 receiver streamconnection  \nTCPconnection  \n\n\n \n- Flow control  : Receiver  stream  window size\n- Flow control  : Receiver  sender   stream  flow control window size\n- Flow control  \n- Flow control WINDOW_UPDATE\n- Flow control  hop-by-hop end-to-end nginxproxyflow controlnginxserverclientnginxconnection\n\n\n> Connection  stream  flow-control window  65535  \nConnection  stream (stream) SETTINGS  `SETTINGS_INITIAL_WINDOW_SIZE` stream flow-control window \n\n\n\n> flow control window size\n\n\n\n****\n\nHTTP/1 bodylengthTCP connectionTCP\n\nHTTP/2  RST_STREAM frame \n\n\n## HTTP/2 demo\n\nHTTP/1  HTTP/2    \nhttps://http2.akamai.com/demo\n\nhttp2   \nhttps://http2.golang.org/\n\n\n\n# ProtoBuf \n\n## ProtoBuf \n\n**Google Protocol Buffer**  \n\n RPC \n\n\n- \n- \n- \n- \n- \n\n\n**gRPCprotobuf**\n\ngRPC protobuf IDL rpc \nproto\n\n-     \n- rpc   gRPC\n\n\n\n\n\n## protobuf \n\nhttps://developers.google.com/protocol-buffers/docs/proto#scalar\n\n\n## \n\nuser.proto\n```\nsyntax = \"proto3\";\n\nimport \"google/protobuf/any.proto\";\n\n//package user;\noption go_package = \"protos_golang/user\";\n\nmessage User {\n  int32 id = 1;\n  string name = 2;\n  uint32 age = 3;\n  enum Flag {\n    NORMAL = 0;\n    VIP = 1;\n    SVIP = 2;\n  }\n  repeated int32 friends_ids = 5;\n  reserved 6, 7, 8;\n  message Command {\n      int32 id = 1;\n      oneof cmd_value {\n         string name = 2;\n         int32 age = 3;\n      }\n  }\n  Command cmd = 9;\n  map<int32, string> tags = 10;\n  google.protobuf.Any details = 11;\n}\n```\n\n**package**\n\npackage\npackage(go)(c++, java)\n\n`option go_package = \"protos_golang/user\";`   \n`$LANGUAGE_package` import pathpackage\n\n\n**import**\n\n.proto  \nproto `package.` proto  \n`common.Flag` \n\n****\n\n  \n \n\n\n\n****\n\n`syntax = \"proto2\"; ` proto2  \n`syntax = \"proto3\"; ` proto3  \n\n\n****\n\nrequired  optional proto2proto3  \nproto3optional[](https://github.com/protocolbuffers/protobuf/issues/2497) \n\n- required : \n- optional \n- repeated \n- reserved protobuf\n\n\n****\n\n enum 0\n\n\n**oneof**\n\noneof(UNION)\n\n**map**\n\nmap   \nkey_type  int  string floatdouble  bytes\n\n**any**\n\nAny:\n- bytes : bytes\n- URL : \n\n`import google/protobuf/any.proto`any\n\nanyproto2extension\n\n\n\n****\n\n\n\n\n## \n\n```\nsyntax = \"proto2\";\n\nimport \"user.proto\";\n\nservice UserService {\n// rpc interface\n    rpc GetUserInfo(UserRequest) returns (UserResponse) {}\n}\n\nmessage UserRequest {\n    uint32 id = 1;\n}\n\nmessage UserResponse {\n    user.User user = 1;\n}\n```\n\n .proto  RPC   stubs\n\n`import \"user.proto\";` userproto\n\n\n\n## \n\nprotoc  \nprotoc`protoc-gen-$LANGUAGE`   \n\n`--go_out`protoc`go``protoc-gen-go`\n\n\n\n****\n- protoc  protoc-gen-xx\n- `CodeGeneratorRequest`protobuf protoc-gen-xx\n  - protoc-gen-xx`CodeGeneratorRequest`\n  - `CodeGeneratorRequest``FileDescriptorProto`proto\n  - `FileDescriptorProto`\n  - `CodeGeneratorResponse`\n- protocprotoc-gen-xx\n\n\n\n[plugin.proto](https://github.com/protocolbuffers/protobuf/blob/master/src/google/protobuf/compiler/plugin.proto)`CodeGeneratorRequest`  `CodeGeneratorResponse`protoc  \n\n[descriptor.proto](https://github.com/protocolbuffers/protobuf/blob/master/src/google/protobuf/descriptor.proto)`.proto`\n\n\n**plugins**\n\nplugins\n\ngo grpc\n```\nprotoc --go_out=plugins=grpc:. pb/user.proto\n```\ngrpc proto-gen-goplugin  \n\n[](https://github.com/golang/protobuf/blob/master/protoc-gen-go/grpc/grpc.go#L72) \n\n`Name()`grpcplugin`plugins=grpc`\n```\n// Name returns the name of this plugin, \"grpc\".\nfunc (g *grpc) Name() string {\n\treturn \"grpc\"\n}\n```\n\n\n\n\n\n\n# gRPC \n\n## \n\n\n![image](https://grpc.io/img/landing-2.svg)\n\n\ngRPC   \nrpcgRPC   \n\"stub\"rpc  \n\n\n\n\n## \n\n\ngRPCHTTP2steam identifierIDstream\n\nHEADER frame  \nprotobufDATA frame\n\n\n### \n\nRequest Request-Headers  Data  EOS (END_STREAM)  \n\n\n\n![image](https://github.com/ikenchina/img1/raw/master/1/network/rpc/grpc/debug/wireshark/grpc_request_stream_decoded_wireshark.png)\n\n\n**Request-Headers**  \n\nRequest-Headers  HEADERS  CONTINUATION frames   \nFlags`END_HEADERS`Request-Headers  \n\n\nRequest-Headers  `Call-Definition`  `Custom-Metadata` :\n- Call-Definition :  Method, Scheme, Path, TE, Authority, Timeout, Content-Type ,Message-Type, Message-Encoding, Message-Accept-Encoding, User-Agent\n- Custom-Metadata :  key-valuekey gRPCkey `grpc-` \n\n\n**Data**\n\n Data frame  \nFlags`END_STREAM`Data \n\n\n**request**\n\n```\n# request-headers \n\nHEADERS (flags = END_HEADERS)\n:method = POST\n:scheme = http\n:path = /user.UserService/GetUserInfo\n:authority = localhost:50000\ngrpc-timeout = 999127u\ncontent-type = grpc-go/1.20.0-dev\n\n## metadata\nservice : test_client\ntraceid : xxxx\n\n# data\nDATA (flags = END_STREAM)\n<Length-Prefixed Message>\n```\n\n\n\n### \n\nResponse  Response-Headers  Data  Trailers   \n Trailers-Only\n\n\n\n\n![image](https://github.com/ikenchina/img1/raw/master/1/network/rpc/grpc/debug/wireshark/grpc_response_stream_decoded_wireshark.png)\n\n\n**Response-Headers**\n\nResponse-Headers  : HTTP-Status, Message-Encoding, Message-Accept-Encoding, Content-Type, Custom-Metadata\n\n**Data**\n\n Data frame  \nFlags`END_STREAM`Data \n\n**Trailers**\n\nTrailers-Only  HTTP-Status, Content-Type, Trailers\n\nTrailers  Status, Status-Message, Custom-Metadata\n\nTrailers  \nbody \n\n\n\n```\n# response-headers\n\nHEADERS (flags = END_HEADERS)\n:status = status: 200 \ncontent-type = application/grpc\n\n## metadata\nservice: server_test\nspanid: xxxx\n\n\n# data\nDATA\n<Length-Prefixed Message>\n\n# headers\nHEADERS (flags = END_STREAM, END_HEADERS)\ngrpc-status: 0\n\n## trailers metadata\ntimestamp: 1560656283730441829\n\n```\n\n\n**Status code**\n\n[HTTPgRPC](https://github.com/grpc/grpc/blob/master/doc/statuscodes.md)\n\n\n\n\n## gRPC\n\ngRPC: \n\n1 unary RPC \n\nrpc \n\n```\n# \n# proto\nrpc GetUserInfo (UserRequest) returns (UserResponse) {}\n```\n\n\n2 Server-side streaming RPC \n\nrpc \n\n\n\n```\n# \n# proto\nrpc UserLocationsStream(UserRequest) returns (stream LocationsResponse) {}\n```\n\n\n\n3 Client-side streaming RPC \n\nrpc \n\n\n\n```\n# \n# proto\nrpc BackupStream(stream BackupRequest) returns (BackupResponse) {}\n```\n\n4 Bidirectional streaming RPC \n\nrpc \n\n\n\n```\n# \n# proto\nrpc LiveChat(stream Message) returns (stream Message) {}\n```\n\n\n\n## \n\n\n**waitForReady**\n\nconnectionreadyconnection ready (deadline) \n`fail fast`\n\n\n**timeout**\n\n  \nDEADLINE_EXCEEDED \n\n\n**maxRequestMessageBytes**\n\npayload size()  \nRESOURCE_EXHAUSTED \n\n\n**maxResponseMessageBytes**\n\npayload size()  \nRESOURCE_EXHAUSTED \n\n\n\n---\n\n\n# gRPC \n\ngodemo\n\n\n## \n\n**protoc**\n\nmac\n```\nbrew install protobuf\n```\n\nlinux\n```\nPROTOC_ZIP=protoc-3.5.1-linux-x86_64.zip\ncurl -OL https://github.com/protocolbuffers/protobuf/releases/download/v3.5.1/$PROTOC_ZIP\n\nsudo unzip -o $PROTOC_ZIP -d /usr/local bin/protoc\nsudo unzip -o $PROTOC_ZIP -d /usr/local include/*\nrm -f $PROTOC_ZIP\n```\n\n**golangprotobuffers**\n```\ngo get -u github.com/golang/protobuf/{protoc-gen-go,proto}\n\n```\n\n## Coding\n\n### proto\n\n```\nsyntax = \"proto3\";\n\nimport \"google/protobuf/any.proto\";\n\n//package user;\noption go_package = \"protos_golang/user\";\n\nmessage User {\n  int32 id = 1;\n  string name = 2;\n  uint32 age = 3;\n  enum Flag {\n    NORMAL = 0;\n    VIP = 1;\n    SVIP = 2;\n  }\n  repeated int32 friends_ids = 5;\n  reserved 6, 7, 8;\n  message Command {\n      int32 id = 1;\n      oneof cmd_value {\n         string name = 2;\n         int32 age = 3;\n      }\n  }\n  Command cmd = 9;\n  map<int32, string> tags = 10;\n  google.protobuf.Any details = 11;\n}\n\nservice UserService {\n// rpc interface\n    rpc GetUserInfo(UserRequest) returns (UserResponse) {}\n}\n\nmessage UserRequest {\n    uint32 id = 1;\n}\n\nmessage UserResponse {\n    User user = 1;\n}\n```\n\n### \n\n****\n```\n## protos_golang  \n## user : golang package \noption go_package = \"protos_golang/user\";\n```\n\n\n****\n\n- rpc`plugins=grpc`\n- `--go_out=.`  ``; :`--go_out=/tmp`\n-   \n  - .pb`go_package` :  `./$go_package/user.pb.go`\n  - .pb`go_package` :  `./pb/user.pb.go`\n\n```\nprotoc --go_out=plugins=grpc:. pb/user.proto\n\n# rpc\nprotoc --go_out=. pb/user.proto\n```\n\n\n\n### \n\n\n```\npackage main\n\nimport (\n\t\"context\"\n\t\"log\"\n\t\"net\"\n\n    \"google.golang.org/grpc\"\n    \"google.golang.org/grpc/reflection\"\n    \n\tpb \"testgrpc/protos_golang/user\"\n)\n\nconst (\n\tport = \":50000\"\n)\n\n// grpc server\ntype server struct{}\n\n// gRPC\nfunc (s *server) GetUserInfo(ctx context.Context, in *pb.UserRequest) (*pb.UserResponse, error) {\n\n\treturn &pb.UserResponse{\n\t\tUser: &pb.User{\n\t\t\tName: \"test_user\",\n\t\t},\n\t}, nil\n}\n\n// \nfunc LogUnaryInterceptorMiddleware() grpc.UnaryServerInterceptor {\n\treturn func(ctx context.Context, req interface{}, info *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (r interface{}, err error) {\n\t\tr, err = handler(ctx, req)\n\n\t\tfmt.Printf(\"fullMethod(%s), errCode(%v)\\n\", info.FullMethod, err)\n\t\treturn r, err\n\t}\n}\n\n\nfunc main() {\n\tlis, err := net.Listen(\"tcp\", port)\n\tif err != nil {\n\t\tlog.Fatalf(\"failed to listen: %v\", err)\n\t}\n\n    // \n    options := grpc.UnaryInterceptor(LogUnaryInterceptorMiddleware())\n\ts := grpc.NewServer(options)\n\t\n\t// \n\tpb.RegisterUserServiceServer(s, &server{})\n\t\n\t// \n\treflection.Register(s)\n\t\n\t// \n\tif err := s.Serve(lis); err != nil {\n\t\tlog.Fatalf(\"failed to serve: %v\", err)\n\t}\n}\n\n```\n\n\n\n\n### \n```\n\npackage main\n\nimport (\n\t\"context\"\n\t\"log\"\n\t\"time\"\n\n\t\"google.golang.org/grpc\"\n\n\tpb \"testgrpc/protos_golang/user\"\n)\n\nconst (\n\taddress = \"localhost:50000\"\n)\n\nfunc main() {\n\n\tconn, err := grpc.Dial(address, grpc.WithInsecure())\n\tif err != nil {\n\t\tlog.Fatalf(\"did not connect: %v\", err)\n\t}\n\tdefer conn.Close()\n\tc := pb.NewUserServiceClient(conn)\n\n\tctx, cancel := context.WithTimeout(context.Background(), time.Second)\n\tdefer cancel()\n\n\tr, err := c.GetUserInfo(ctx, &pb.UserRequest{})\n\tif err != nil {\n\t\tlog.Fatalf(\"fatal: %v\", err)\n\t}\n\n\tlog.Printf(\"response: %s\", r)\n}\n\n```\n\n\n\n### \n\nreflection  \n```\nreflection.Register(grpcServer)\n```\n\n\n\n- [grpc_cli](https://github.com/grpc/grpc/blob/master/doc/command_line_tool.md : \n- [grpcurl](https://github.com/fullstorydev/grpcurl) : go\n\n\n\n**service**\n\n`-plaintext`\n```\n$ grpcurl -plaintext localhost:50000 list \ngrpc.reflection.v1alpha.ServerReflection\nuser.UserService\n```\n\n****\n\n```\n$ grpcurl -plaintext localhost:50000 list  user.UserService\nuser.UserService.GetUserInfo\n```\n\n****\n\n```\n$ grpcurl -plaintext localhost:50000 describe user.UserService.GetUserInfo\nuser.UserService.GetUserInfo is a method:\nrpc GetUserInfo ( .user.UserRequest ) returns ( .user.UserResponse );\n```\n\n****\n\n```\n$ grpcurl -plaintext localhost:50000 describe .user.UserRequest\nuser.UserRequest is a message:\nmessage UserRequest {\n  uint32 id = 1;\n}\n\n```\n\n****\n\njson \n\n```\n$ grpcurl -plaintext -d '{\"id\":1}'   localhost:50000  user.UserService.GetUserInfo\n{\n  \"user\": {\n    \"name\": \"test_user\"\n  }\n}\n```\n\n\n\n\n## go gRPC \n\n### \n\n\n****\n\nrpc  \n\n\n[](https://godoc.org/google.golang.org/grpc/metadata)\n\n\n****\n\n :\n-  : grpcurl reflectionlist\n- gRPC \n\n\n[](https://godoc.org/google.golang.org/grpc/reflection)\n\n\n\n\n****\n\n\n\n\n[](https://godoc.org/google.golang.org/grpc/balancer)\n\n\n****  \n\ngRPC\n- SSL/TLS\n- Token\n\n\n\n\n[](https://godoc.org/google.golang.org/grpc/credentials)  \n- alts  \n- google \n- oauth\n- \n\n\n[go-grpc-middleware](https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/auth)\n\n\n\n****\n\n\n`Check`  \n\n\n\n[](https://godoc.org/google.golang.org/grpc/health)\n\n\n**keepalive**\n\nHTTP/2.0 pings connection   \nkeepaliveconnection\n\n\n[](https://godoc.org/google.golang.org/grpc/keepalive)\n\n\n**naming**\n\n  \n  \n\nbalancer  \n\n[](https://godoc.org/google.golang.org/grpc/naming)\n\n\n\n****\n\n  \n\nbalancer \n\n[go-grpc-middleware](https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/ratelimit)\n\n\n\n\n**recovery**\n\ngRPC  \n\n[go-grpc-middleware](https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/recovery)  recover gopanic gRPC\n\n\n\n\n****\n\ngRPC\n\n[go-grpc-middleware](https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/retry)\n\n\n\n\n**tracing**\n\ntracingopentracing``\n\ntracingtraceid,spanid,,,  \nspanidspanidparent_spanidrpc\n\n\n[go-grpc-middlewareopentracingmiddleware](https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/tracing/opentracing)\n\n[open-tracing](https://opentracing.io/docs/)\n\n\n\n\n### \n\n[go-kit](https://github.com/go-kit) :   \n[micro](https://github.com/micro) :   \n[go-chassis](https://github.com/go-chassis/go-chassis) : go  \n[go-grpc-middleware](https://github.com/grpc-ecosystem/go-grpc-middleware) :   \n[grpc-gateway](https://github.com/grpc-ecosystem/grpc-gateway)  protoc  gRPC  RESTful API  swagger   \n\n\n\n\n\n### gRPC  \n\n**LB(Balancing-aware Client)**\n\n\n\n- \n- \n- \n- \n\n\n- \n- sdk\n\n\n\n[](https://godoc.org/google.golang.org/grpc/balancer)\n\n\n\n\n**LB(Proxy Model)**\n\nproxy   \n\n\n\n- \n- \n- \n\n\n***Nginx***\n\n> Nginx(1.13.10gRPC) \n\n\n\n\n```\nupstream grpcservers {\n    server localhost:50000;\n    server localhost:50001;\n}\n\nserver {\n    listen 9000 http2;\n\n    # router\n    location /user.UserService {\n        grpc_pass grpc://grpcservers;\n        error_page 502 = /error502grpc;\n    }\n    \n    # gRPC\n    location = /error502grpc {\n        internal;\n        default_type application/grpc;\n        add_header grpc-status 14;\n        add_header grpc-message \"unavailable\";\n        return 204;\n    }\n}\n```\n\n[nginx gRPC module](https://nginx.org/en/docs/http/ngx_http_grpc_module.html)\n\n\n\n\n**LB(External Load Balancing Service)**\n\nLB  \nsdk  \nservice mesh\n\n\n- \n- \n\n  \n- [Istio](https://istio.io/)  \n- [Envoy](https://github.com/lyft/envoy)\n\n\n\n\n\n\n\n---\n\n# gRPC \n\n## \n\n grpc  RPC  HTTP/2 \n \n[grpc-ecosystem](https://github.com/grpc-ecosystem) gRPC  \n\n\n[awesome-grpc](https://github.com/grpc-ecosystem/awesome-grpc) gRPC   \n\n\n\n\n## grpc \n\n****\n\n-  : https://grpc.io/docs/ \n- github  grpc  doc  https://github.com/grpc/grpc/tree/master/doc\n-  : https://grpc.io/blog/\n\n****\n\nhttps://grpc.io/community/ \n- \n- Gitter\n- Reddit\n- Meetup Group \n\n\n\n\n\n\n\n\n\n\n# \n\n[grpc.io](https://grpc.io/docs/guides)\n\n[developers.google.com](https://developers.google.com/protocol-buffers/docs)\n\n[gRPC github doc](https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-HTTP2.md#Requests)\n\n[http2 specs](https://tools.ietf.org/html/rfc7540)    \nor   \n[github http2 spec](http://http2.github.io/http2-spec/#StreamPriority)\n","slug":"grpc","published":1,"updated":"2020-04-15T04:22:01.900Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck9115hpk0002ppfcvrvp01pb","content":"<blockquote>\n<p>grpc <a id=\"more\"></a>  </p>\n</blockquote>\n<h1 id=\"gRPC\"><a href=\"#gRPC\" class=\"headerlink\" title=\"gRPC\"></a>gRPC</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>gRPCgoogleHTTP/2Protobuf RPC   </p>\n<p><br>  tracing<br>  <br>   TCP </p>\n<p><strong></strong></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><strong>HTTP/2</strong></p>\n<p>HTTP/2  <br>gRPC HTTP2 HTTP Body Header </p>\n<p><strong>IDLProtoBuffer</strong></p>\n<p>gRPCProtoBufProtoBufGoogleXMLJSON<br>ProtoBuf<br></p>\n<p><strong></strong></p>\n<p>gRPC  </p>\n<p> C#, C++, Dart, Go, Java, Node, Objective-C, PHP, Python, Ruby  </p>\n<p><a href=\"https://grpc.io/docs/quickstart/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h1 id=\"HTTP-2\"><a href=\"#HTTP-2\" class=\"headerlink\" title=\"HTTP/2\"></a>HTTP/2</h1><h2 id=\"HTTP-2-1\"><a href=\"#HTTP-2-1\" class=\"headerlink\" title=\"HTTP/2\"></a>HTTP/2</h2><p>HTTP/1.x 1<br>HTTP/2 2</p>\n<p>HTTP/1  HTTP/2 GET/PUST/PUT/DELETE200/404/500Range RequestCacheingAuthenticationURL</p>\n<p><strong>HTTP/2</strong></p>\n<ul>\n<li>Stream  streams</li>\n<li>Message  requestresponse</li>\n<li>FrameHTTP/2  Frame  stream message  frame </li>\n</ul>\n<p><strong>HTTP/2 </strong>   </p>\n<p>HTTP/2(frame)<br><br><br>ID</p>\n<p><a href=\"https://httpwg.org/specs/rfc7540.html#rfc.section.4.1\" target=\"_blank\" rel=\"noopener\">Frame : </a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">+-----------------------------------------------+</span><br><span class=\"line\">|                 Length (24)                   |</span><br><span class=\"line\">+---------------+---------------+---------------+</span><br><span class=\"line\">|   Type (8)    |   Flags (8)   |</span><br><span class=\"line\">+-+-------------+---------------+-------------------------------+</span><br><span class=\"line\">|R|                 Stream Identifier (31)                      |</span><br><span class=\"line\">+=+=============================================================+</span><br><span class=\"line\">|                   Frame Payload (0...)                      ...</span><br><span class=\"line\">+---------------------------------------------------------------+</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Length   Frame </li>\n<li>Type Frame  DATAHEADERSSETTINGS </li>\n<li>Flags 88stream(END_STREAM)header(END_HEADERS)priority</li>\n<li>R</li>\n<li>Stream Identifierframe stream 0 frame (SETTINGS)</li>\n<li>Frame Payload</li>\n</ul>\n<p><strong></strong>  </p>\n<ul>\n<li>HEADERS HTTP/1 Headers</li>\n<li>DATA HTTP/1 Body</li>\n<li>CONTINUATION HEADERS+CONTINUATION</li>\n<li>SETTINGS </li>\n<li>WINDOW_UPDATE </li>\n<li>PUSH_PROMISE </li>\n<li>PRIORITY </li>\n<li>PING RTT</li>\n<li>RST_STREAM </li>\n<li>GOAWAY </li>\n</ul>\n<h2 id=\"HTTP-2-\"><a href=\"#HTTP-2-\" class=\"headerlink\" title=\"HTTP/2 \"></a>HTTP/2 </h2><p><strong>Binary Format</strong></p>\n<p>HTTP/1 <br>HTTP/2</p>\n<p><strong>MultiPlexing</strong></p>\n<p>HTTP/1 requestrequest TCP connectionTCP connection</p>\n<p>HTTP/2 TCP connectionstreams(SETTINGS_MAX_CONCURRENT_STREAMS) streams frames  </p>\n<p>SETTINGS<code>SETTINGS_MAX_CONCURRENT_STREAMS</code><br>streams  </p>\n<blockquote>\n<p> ID  server  client  GOAWAY frame  client </p>\n</blockquote>\n<p><strong>header</strong></p>\n<p>HTTP/1 header</p>\n<p>HTTP/2 </p>\n<ul>\n<li>HPACK </li>\n<li>headersheaders<ul>\n<li>HTTP/2 headlist  headerheader</li>\n</ul>\n</li>\n</ul>\n<p><a href=\"http://http2.github.io/http2-spec/compression.html\" target=\"_blank\" rel=\"noopener\">HPACK: Header Compression for HTTP/2</a></p>\n<p><strong></strong></p>\n<p>server push :   </p>\n<p>Server PushPUSH_PROMISE<br>PUSH_PROMISE</p>\n<p><strong></strong></p>\n<p>  </p>\n<p> HEADERS  PRIORITY  PRIORITY </p>\n<p><a href=\"http://http2.github.io/http2-spec/#StreamPriority\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong>Flow Control</strong></p>\n<p>HTTP/2 receiver streamconnection<br>TCPconnection  </p>\n<p> </p>\n<ul>\n<li>Flow control  : Receiver  stream  window size</li>\n<li>Flow control  : Receiver  sender   stream  flow control window size</li>\n<li>Flow control  </li>\n<li>Flow control WINDOW_UPDATE</li>\n<li>Flow control  hop-by-hop end-to-end nginxproxyflow controlnginxserverclientnginxconnection</li>\n</ul>\n<blockquote>\n<p>Connection  stream  flow-control window  65535<br>Connection  stream (stream) SETTINGS  <code>SETTINGS_INITIAL_WINDOW_SIZE</code> stream flow-control window </p>\n</blockquote>\n<blockquote>\n<p>flow control window size</p>\n</blockquote>\n<p><strong></strong></p>\n<p>HTTP/1 bodylengthTCP connectionTCP</p>\n<p>HTTP/2  RST_STREAM frame </p>\n<h2 id=\"HTTP-2-demo\"><a href=\"#HTTP-2-demo\" class=\"headerlink\" title=\"HTTP/2 demo\"></a>HTTP/2 demo</h2><p>HTTP/1  HTTP/2 <br><a href=\"https://http2.akamai.com/demo\" target=\"_blank\" rel=\"noopener\">https://http2.akamai.com/demo</a></p>\n<p>http2 <br><a href=\"https://http2.golang.org/\" target=\"_blank\" rel=\"noopener\">https://http2.golang.org/</a></p>\n<h1 id=\"ProtoBuf\"><a href=\"#ProtoBuf\" class=\"headerlink\" title=\"ProtoBuf\"></a>ProtoBuf</h1><h2 id=\"ProtoBuf-1\"><a href=\"#ProtoBuf-1\" class=\"headerlink\" title=\"ProtoBuf\"></a>ProtoBuf</h2><p><strong>Google Protocol Buffer</strong>  </p>\n<p> RPC </p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><strong>gRPCprotobuf</strong></p>\n<p>gRPC protobuf IDL rpc <br>proto</p>\n<ul>\n<li>    </li>\n<li>rpc   gRPC</li>\n</ul>\n<h2 id=\"protobuf-\"><a href=\"#protobuf-\" class=\"headerlink\" title=\"protobuf \"></a>protobuf </h2><p><a href=\"https://developers.google.com/protocol-buffers/docs/proto#scalar\" target=\"_blank\" rel=\"noopener\">https://developers.google.com/protocol-buffers/docs/proto#scalar</a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>user.proto</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">syntax = &quot;proto3&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;google/protobuf/any.proto&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">//package user;</span><br><span class=\"line\">option go_package = &quot;protos_golang/user&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">message User &#123;</span><br><span class=\"line\">  int32 id = 1;</span><br><span class=\"line\">  string name = 2;</span><br><span class=\"line\">  uint32 age = 3;</span><br><span class=\"line\">  enum Flag &#123;</span><br><span class=\"line\">    NORMAL = 0;</span><br><span class=\"line\">    VIP = 1;</span><br><span class=\"line\">    SVIP = 2;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  repeated int32 friends_ids = 5;</span><br><span class=\"line\">  reserved 6, 7, 8;</span><br><span class=\"line\">  message Command &#123;</span><br><span class=\"line\">      int32 id = 1;</span><br><span class=\"line\">      oneof cmd_value &#123;</span><br><span class=\"line\">         string name = 2;</span><br><span class=\"line\">         int32 age = 3;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  Command cmd = 9;</span><br><span class=\"line\">  map&lt;int32, string&gt; tags = 10;</span><br><span class=\"line\">  google.protobuf.Any details = 11;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>package</strong></p>\n<p>package<br>package(go)(c++, java)</p>\n<p><code>option go_package = &quot;protos_golang/user&quot;;</code><br><code>$LANGUAGE_package</code> import pathpackage</p>\n<p><strong>import</strong></p>\n<p>.proto<br>proto <code>package.</code> proto<br><code>common.Flag</code> </p>\n<p><strong></strong></p>\n<p><br> </p>\n<p><strong></strong></p>\n<p><code>syntax = &quot;proto2&quot;;</code> proto2<br><code>syntax = &quot;proto3&quot;;</code> proto3  </p>\n<p><strong></strong></p>\n<p>required  optional proto2proto3<br>proto3optional<a href=\"https://github.com/protocolbuffers/protobuf/issues/2497\" target=\"_blank\" rel=\"noopener\"></a> </p>\n<ul>\n<li>required : </li>\n<li>optional </li>\n<li>repeated </li>\n<li>reserved protobuf</li>\n</ul>\n<p><strong></strong></p>\n<p> enum 0</p>\n<p><strong>oneof</strong></p>\n<p>oneof(UNION)</p>\n<p><strong>map</strong></p>\n<p>map <br>key_type  int  string floatdouble  bytes</p>\n<p><strong>any</strong></p>\n<p>Any:</p>\n<ul>\n<li>bytes : bytes</li>\n<li>URL : </li>\n</ul>\n<p><code>import google/protobuf/any.proto</code>any</p>\n<p>anyproto2extension</p>\n<p><strong></strong></p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">syntax = &quot;proto2&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;user.proto&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">service UserService &#123;</span><br><span class=\"line\">// rpc interface</span><br><span class=\"line\">    rpc GetUserInfo(UserRequest) returns (UserResponse) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">message UserRequest &#123;</span><br><span class=\"line\">    uint32 id = 1;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">message UserResponse &#123;</span><br><span class=\"line\">    user.User user = 1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> .proto  RPC   stubs</p>\n<p><code>import &quot;user.proto&quot;;</code> userproto</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>protoc<br>protoc<code>protoc-gen-$LANGUAGE</code> <br><br><code>--go_out</code>protoc<code>go</code><code>protoc-gen-go</code></p>\n<p><strong></strong></p>\n<ul>\n<li>protoc  protoc-gen-xx</li>\n<li><code>CodeGeneratorRequest</code>protobuf protoc-gen-xx<ul>\n<li>protoc-gen-xx<code>CodeGeneratorRequest</code></li>\n<li><code>CodeGeneratorRequest</code><code>FileDescriptorProto</code>proto</li>\n<li><code>FileDescriptorProto</code></li>\n<li><code>CodeGeneratorResponse</code></li>\n</ul>\n</li>\n<li>protocprotoc-gen-xx</li>\n</ul>\n<p><a href=\"https://github.com/protocolbuffers/protobuf/blob/master/src/google/protobuf/compiler/plugin.proto\" target=\"_blank\" rel=\"noopener\">plugin.proto</a><code>CodeGeneratorRequest</code>  <code>CodeGeneratorResponse</code>protoc  </p>\n<p><a href=\"https://github.com/protocolbuffers/protobuf/blob/master/src/google/protobuf/descriptor.proto\" target=\"_blank\" rel=\"noopener\">descriptor.proto</a><code>.proto</code></p>\n<p><strong>plugins</strong></p>\n<p>plugins</p>\n<p>go grpc</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">protoc --go_out=plugins=grpc:. pb/user.proto</span><br></pre></td></tr></table></figure>\n\n<p>grpc proto-gen-goplugin  </p>\n<p><a href=\"https://github.com/golang/protobuf/blob/master/protoc-gen-go/grpc/grpc.go#L72\" target=\"_blank\" rel=\"noopener\"></a> </p>\n<p><code>Name()</code>grpcplugin<code>plugins=grpc</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Name returns the name of this plugin, &quot;grpc&quot;.</span><br><span class=\"line\">func (g *grpc) Name() string &#123;</span><br><span class=\"line\">\treturn &quot;grpc&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"gRPC-\"><a href=\"#gRPC-\" class=\"headerlink\" title=\"gRPC \"></a>gRPC </h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"https://grpc.io/img/landing-2.svg\" alt=\"image\"></p>\n<p>gRPC <br>rpcgRPC<br>stubrpc  </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>gRPCHTTP2steam identifierIDstream</p>\n<p>HEADER frame<br>protobufDATA frame</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Request Request-Headers  Data  EOS (END_STREAM)  </p>\n<p></p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/network/rpc/grpc/debug/wireshark/grpc_request_stream_decoded_wireshark.png\" alt=\"image\"></p>\n<p><strong>Request-Headers</strong>  </p>\n<p>Request-Headers  HEADERS  CONTINUATION frames <br>Flags<code>END_HEADERS</code>Request-Headers  </p>\n<p>Request-Headers  <code>Call-Definition</code>  <code>Custom-Metadata</code> :</p>\n<ul>\n<li>Call-Definition :  Method, Scheme, Path, TE, Authority, Timeout, Content-Type ,Message-Type, Message-Encoding, Message-Accept-Encoding, User-Agent</li>\n<li>Custom-Metadata :  key-valuekey gRPCkey <code>grpc-</code> </li>\n</ul>\n<p><strong>Data</strong></p>\n<p> Data frame<br>Flags<code>END_STREAM</code>Data </p>\n<p><strong>request</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># request-headers </span><br><span class=\"line\"></span><br><span class=\"line\">HEADERS (flags = END_HEADERS)</span><br><span class=\"line\">:method = POST</span><br><span class=\"line\">:scheme = http</span><br><span class=\"line\">:path = /user.UserService/GetUserInfo</span><br><span class=\"line\">:authority = localhost:50000</span><br><span class=\"line\">grpc-timeout = 999127u</span><br><span class=\"line\">content-type = grpc-go/1.20.0-dev</span><br><span class=\"line\"></span><br><span class=\"line\">## metadata</span><br><span class=\"line\">service : test_client</span><br><span class=\"line\">traceid : xxxx</span><br><span class=\"line\"></span><br><span class=\"line\"># data</span><br><span class=\"line\">DATA (flags = END_STREAM)</span><br><span class=\"line\">&lt;Length-Prefixed Message&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Response  Response-Headers  Data  Trailers <br> Trailers-Only</p>\n<p></p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/network/rpc/grpc/debug/wireshark/grpc_response_stream_decoded_wireshark.png\" alt=\"image\"></p>\n<p><strong>Response-Headers</strong></p>\n<p>Response-Headers  : HTTP-Status, Message-Encoding, Message-Accept-Encoding, Content-Type, Custom-Metadata</p>\n<p><strong>Data</strong></p>\n<p> Data frame<br>Flags<code>END_STREAM</code>Data </p>\n<p><strong>Trailers</strong></p>\n<p>Trailers-Only  HTTP-Status, Content-Type, Trailers</p>\n<p>Trailers  Status, Status-Message, Custom-Metadata</p>\n<p>Trailers<br>body </p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># response-headers</span><br><span class=\"line\"></span><br><span class=\"line\">HEADERS (flags = END_HEADERS)</span><br><span class=\"line\">:status = status: 200 </span><br><span class=\"line\">content-type = application/grpc</span><br><span class=\"line\"></span><br><span class=\"line\">## metadata</span><br><span class=\"line\">service: server_test</span><br><span class=\"line\">spanid: xxxx</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># data</span><br><span class=\"line\">DATA</span><br><span class=\"line\">&lt;Length-Prefixed Message&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"># headers</span><br><span class=\"line\">HEADERS (flags = END_STREAM, END_HEADERS)</span><br><span class=\"line\">grpc-status: 0</span><br><span class=\"line\"></span><br><span class=\"line\">## trailers metadata</span><br><span class=\"line\">timestamp: 1560656283730441829</span><br></pre></td></tr></table></figure>\n\n<p><strong>Status code</strong></p>\n<p><a href=\"https://github.com/grpc/grpc/blob/master/doc/statuscodes.md\" target=\"_blank\" rel=\"noopener\">HTTPgRPC</a></p>\n<h2 id=\"gRPC\"><a href=\"#gRPC\" class=\"headerlink\" title=\"gRPC\"></a>gRPC</h2><p>gRPC: </p>\n<p>1 unary RPC </p>\n<p>rpc </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># </span><br><span class=\"line\"># proto</span><br><span class=\"line\">rpc GetUserInfo (UserRequest) returns (UserResponse) &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>2 Server-side streaming RPC </p>\n<p>rpc </p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># </span><br><span class=\"line\"># proto</span><br><span class=\"line\">rpc UserLocationsStream(UserRequest) returns (stream LocationsResponse) &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>3 Client-side streaming RPC </p>\n<p>rpc </p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># </span><br><span class=\"line\"># proto</span><br><span class=\"line\">rpc BackupStream(stream BackupRequest) returns (BackupResponse) &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>4 Bidirectional streaming RPC </p>\n<p>rpc </p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># </span><br><span class=\"line\"># proto</span><br><span class=\"line\">rpc LiveChat(stream Message) returns (stream Message) &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>waitForReady</strong></p>\n<p>connectionreadyconnection ready (deadline)<br><code>fail fast</code></p>\n<p><strong>timeout</strong></p>\n<p><br>DEADLINE_EXCEEDED </p>\n<p><strong>maxRequestMessageBytes</strong></p>\n<p>payload size()<br>RESOURCE_EXHAUSTED </p>\n<p><strong>maxResponseMessageBytes</strong></p>\n<p>payload size()<br>RESOURCE_EXHAUSTED </p>\n<hr>\n<h1 id=\"gRPC-\"><a href=\"#gRPC-\" class=\"headerlink\" title=\"gRPC \"></a>gRPC </h1><p>godemo</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>protoc</strong></p>\n<p>mac</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install protobuf</span><br></pre></td></tr></table></figure>\n\n<p>linux</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PROTOC_ZIP=protoc-3.5.1-linux-x86_64.zip</span><br><span class=\"line\">curl -OL https://github.com/protocolbuffers/protobuf/releases/download/v3.5.1/$PROTOC_ZIP</span><br><span class=\"line\"></span><br><span class=\"line\">sudo unzip -o $PROTOC_ZIP -d /usr/local bin/protoc</span><br><span class=\"line\">sudo unzip -o $PROTOC_ZIP -d /usr/local include/*</span><br><span class=\"line\">rm -f $PROTOC_ZIP</span><br></pre></td></tr></table></figure>\n\n<p><strong>golangprotobuffers</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go get -u github.com/golang/protobuf/&#123;protoc-gen-go,proto&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Coding\"><a href=\"#Coding\" class=\"headerlink\" title=\"Coding\"></a>Coding</h2><h3 id=\"proto\"><a href=\"#proto\" class=\"headerlink\" title=\"proto\"></a>proto</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">syntax = &quot;proto3&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;google/protobuf/any.proto&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">//package user;</span><br><span class=\"line\">option go_package = &quot;protos_golang/user&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">message User &#123;</span><br><span class=\"line\">  int32 id = 1;</span><br><span class=\"line\">  string name = 2;</span><br><span class=\"line\">  uint32 age = 3;</span><br><span class=\"line\">  enum Flag &#123;</span><br><span class=\"line\">    NORMAL = 0;</span><br><span class=\"line\">    VIP = 1;</span><br><span class=\"line\">    SVIP = 2;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  repeated int32 friends_ids = 5;</span><br><span class=\"line\">  reserved 6, 7, 8;</span><br><span class=\"line\">  message Command &#123;</span><br><span class=\"line\">      int32 id = 1;</span><br><span class=\"line\">      oneof cmd_value &#123;</span><br><span class=\"line\">         string name = 2;</span><br><span class=\"line\">         int32 age = 3;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  Command cmd = 9;</span><br><span class=\"line\">  map&lt;int32, string&gt; tags = 10;</span><br><span class=\"line\">  google.protobuf.Any details = 11;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">service UserService &#123;</span><br><span class=\"line\">// rpc interface</span><br><span class=\"line\">    rpc GetUserInfo(UserRequest) returns (UserResponse) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">message UserRequest &#123;</span><br><span class=\"line\">    uint32 id = 1;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">message UserResponse &#123;</span><br><span class=\"line\">    User user = 1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">## protos_golang  </span><br><span class=\"line\">## user : golang package </span><br><span class=\"line\">option go_package = &quot;protos_golang/user&quot;;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<ul>\n<li>rpc<code>plugins=grpc</code></li>\n<li><code>--go_out=.</code>  <code></code>; :<code>--go_out=/tmp</code></li>\n<li>  <ul>\n<li>.pb<code>go_package</code> :  <code>./$go_package/user.pb.go</code></li>\n<li>.pb<code>go_package</code> :  <code>./pb/user.pb.go</code></li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">protoc --go_out=plugins=grpc:. pb/user.proto</span><br><span class=\"line\"></span><br><span class=\"line\"># rpc</span><br><span class=\"line\">protoc --go_out=. pb/user.proto</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import (</span><br><span class=\"line\">\t&quot;context&quot;</span><br><span class=\"line\">\t&quot;log&quot;</span><br><span class=\"line\">\t&quot;net&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">    &quot;google.golang.org/grpc&quot;</span><br><span class=\"line\">    &quot;google.golang.org/grpc/reflection&quot;</span><br><span class=\"line\">    </span><br><span class=\"line\">\tpb &quot;testgrpc/protos_golang/user&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">const (</span><br><span class=\"line\">\tport = &quot;:50000&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">// grpc server</span><br><span class=\"line\">type server struct&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// gRPC</span><br><span class=\"line\">func (s *server) GetUserInfo(ctx context.Context, in *pb.UserRequest) (*pb.UserResponse, error) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\treturn &amp;pb.UserResponse&#123;</span><br><span class=\"line\">\t\tUser: &amp;pb.User&#123;</span><br><span class=\"line\">\t\t\tName: &quot;test_user&quot;,</span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t&#125;, nil</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// </span><br><span class=\"line\">func LogUnaryInterceptorMiddleware() grpc.UnaryServerInterceptor &#123;</span><br><span class=\"line\">\treturn func(ctx context.Context, req interface&#123;&#125;, info *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (r interface&#123;&#125;, err error) &#123;</span><br><span class=\"line\">\t\tr, err = handler(ctx, req)</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tfmt.Printf(&quot;fullMethod(%s), errCode(%v)\\n&quot;, info.FullMethod, err)</span><br><span class=\"line\">\t\treturn r, err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">\tlis, err := net.Listen(&quot;tcp&quot;, port)</span><br><span class=\"line\">\tif err != nil &#123;</span><br><span class=\"line\">\t\tlog.Fatalf(&quot;failed to listen: %v&quot;, err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    options := grpc.UnaryInterceptor(LogUnaryInterceptorMiddleware())</span><br><span class=\"line\">\ts := grpc.NewServer(options)</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t// </span><br><span class=\"line\">\tpb.RegisterUserServiceServer(s, &amp;server&#123;&#125;)</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t// </span><br><span class=\"line\">\treflection.Register(s)</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t// </span><br><span class=\"line\">\tif err := s.Serve(lis); err != nil &#123;</span><br><span class=\"line\">\t\tlog.Fatalf(&quot;failed to serve: %v&quot;, err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import (</span><br><span class=\"line\">\t&quot;context&quot;</span><br><span class=\"line\">\t&quot;log&quot;</span><br><span class=\"line\">\t&quot;time&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&quot;google.golang.org/grpc&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpb &quot;testgrpc/protos_golang/user&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">const (</span><br><span class=\"line\">\taddress = &quot;localhost:50000&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\tconn, err := grpc.Dial(address, grpc.WithInsecure())</span><br><span class=\"line\">\tif err != nil &#123;</span><br><span class=\"line\">\t\tlog.Fatalf(&quot;did not connect: %v&quot;, err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tdefer conn.Close()</span><br><span class=\"line\">\tc := pb.NewUserServiceClient(conn)</span><br><span class=\"line\"></span><br><span class=\"line\">\tctx, cancel := context.WithTimeout(context.Background(), time.Second)</span><br><span class=\"line\">\tdefer cancel()</span><br><span class=\"line\"></span><br><span class=\"line\">\tr, err := c.GetUserInfo(ctx, &amp;pb.UserRequest&#123;&#125;)</span><br><span class=\"line\">\tif err != nil &#123;</span><br><span class=\"line\">\t\tlog.Fatalf(&quot;fatal: %v&quot;, err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tlog.Printf(&quot;response: %s&quot;, r)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>reflection  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">reflection.Register(grpcServer)</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ul>\n<li>[grpc_cli](<a href=\"https://github.com/grpc/grpc/blob/master/doc/command_line_tool.md\" target=\"_blank\" rel=\"noopener\">https://github.com/grpc/grpc/blob/master/doc/command_line_tool.md</a> : </li>\n<li><a href=\"https://github.com/fullstorydev/grpcurl\" target=\"_blank\" rel=\"noopener\">grpcurl</a> : go</li>\n</ul>\n<p><strong>service</strong></p>\n<p><code>-plaintext</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ grpcurl -plaintext localhost:50000 list </span><br><span class=\"line\">grpc.reflection.v1alpha.ServerReflection</span><br><span class=\"line\">user.UserService</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ grpcurl -plaintext localhost:50000 list  user.UserService</span><br><span class=\"line\">user.UserService.GetUserInfo</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ grpcurl -plaintext localhost:50000 describe user.UserService.GetUserInfo</span><br><span class=\"line\">user.UserService.GetUserInfo is a method:</span><br><span class=\"line\">rpc GetUserInfo ( .user.UserRequest ) returns ( .user.UserResponse );</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ grpcurl -plaintext localhost:50000 describe .user.UserRequest</span><br><span class=\"line\">user.UserRequest is a message:</span><br><span class=\"line\">message UserRequest &#123;</span><br><span class=\"line\">  uint32 id = 1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<p>json </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ grpcurl -plaintext -d &apos;&#123;&quot;id&quot;:1&#125;&apos;   localhost:50000  user.UserService.GetUserInfo</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;user&quot;: &#123;</span><br><span class=\"line\">    &quot;name&quot;: &quot;test_user&quot;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"go-gRPC-\"><a href=\"#go-gRPC-\" class=\"headerlink\" title=\"go gRPC \"></a>go gRPC </h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<p>rpc<br></p>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/metadata\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong></strong></p>\n<p> :</p>\n<ul>\n<li> : grpcurl reflectionlist</li>\n<li>gRPC </li>\n</ul>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/reflection\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong></strong></p>\n<p></p>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/balancer\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong></strong>  </p>\n<p>gRPC</p>\n<ul>\n<li>SSL/TLS</li>\n<li>Token</li>\n</ul>\n<p></p>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/credentials\" target=\"_blank\" rel=\"noopener\"></a>  </p>\n<ul>\n<li>alts  </li>\n<li>google </li>\n<li>oauth</li>\n<li></li>\n</ul>\n<p><a href=\"https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/auth\" target=\"_blank\" rel=\"noopener\">go-grpc-middleware</a></p>\n<p><strong></strong></p>\n<p><code>Check</code><br></p>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/health\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong>keepalive</strong></p>\n<p>HTTP/2.0 pings connection <br>keepaliveconnection</p>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/keepalive\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong>naming</strong></p>\n<p><br>  </p>\n<p>balancer  </p>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/naming\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong></strong></p>\n<p>  </p>\n<p>balancer </p>\n<p><a href=\"https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/ratelimit\" target=\"_blank\" rel=\"noopener\">go-grpc-middleware</a></p>\n<p><strong>recovery</strong></p>\n<p>gRPC  </p>\n<p><a href=\"https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/recovery\" target=\"_blank\" rel=\"noopener\">go-grpc-middleware</a>  recover gopanic gRPC</p>\n<p><strong></strong></p>\n<p>gRPC</p>\n<p><a href=\"https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/retry\" target=\"_blank\" rel=\"noopener\">go-grpc-middleware</a></p>\n<p><strong>tracing</strong></p>\n<p>tracingopentracing<code></code></p>\n<p>tracingtraceid,spanid,,,<br>spanidspanidparent_spanidrpc</p>\n<p><a href=\"https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/tracing/opentracing\" target=\"_blank\" rel=\"noopener\">go-grpc-middlewareopentracingmiddleware</a></p>\n<p><a href=\"https://opentracing.io/docs/\" target=\"_blank\" rel=\"noopener\">open-tracing</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://github.com/go-kit\" target=\"_blank\" rel=\"noopener\">go-kit</a> : <br><a href=\"https://github.com/micro\" target=\"_blank\" rel=\"noopener\">micro</a> : <br><a href=\"https://github.com/go-chassis/go-chassis\" target=\"_blank\" rel=\"noopener\">go-chassis</a> : go<br><a href=\"https://github.com/grpc-ecosystem/go-grpc-middleware\" target=\"_blank\" rel=\"noopener\">go-grpc-middleware</a> : <br><a href=\"https://github.com/grpc-ecosystem/grpc-gateway\" target=\"_blank\" rel=\"noopener\">grpc-gateway</a>  protoc  gRPC  RESTful API  swagger   </p>\n<h3 id=\"gRPC--\"><a href=\"#gRPC--\" class=\"headerlink\" title=\"gRPC  \"></a>gRPC  </h3><p><strong>LB(Balancing-aware Client)</strong></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n<li>sdk</li>\n</ul>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/balancer\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong>LB(Proxy Model)</strong></p>\n<p>proxy <br></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><strong><em>Nginx</em></strong></p>\n<blockquote>\n<p>Nginx(1.13.10gRPC) </p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream grpcservers &#123;</span><br><span class=\"line\">    server localhost:50000;</span><br><span class=\"line\">    server localhost:50001;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 9000 http2;</span><br><span class=\"line\"></span><br><span class=\"line\">    # router</span><br><span class=\"line\">    location /user.UserService &#123;</span><br><span class=\"line\">        grpc_pass grpc://grpcservers;</span><br><span class=\"line\">        error_page 502 = /error502grpc;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    # gRPC</span><br><span class=\"line\">    location = /error502grpc &#123;</span><br><span class=\"line\">        internal;</span><br><span class=\"line\">        default_type application/grpc;</span><br><span class=\"line\">        add_header grpc-status 14;</span><br><span class=\"line\">        add_header grpc-message &quot;unavailable&quot;;</span><br><span class=\"line\">        return 204;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://nginx.org/en/docs/http/ngx_http_grpc_module.html\" target=\"_blank\" rel=\"noopener\">nginx gRPC module</a></p>\n<p><strong>LB(External Load Balancing Service)</strong></p>\n<p>LB<br>sdk<br>service mesh</p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>  </p>\n<ul>\n<li><a href=\"https://istio.io/\" target=\"_blank\" rel=\"noopener\">Istio</a>  </li>\n<li><a href=\"https://github.com/lyft/envoy\" target=\"_blank\" rel=\"noopener\">Envoy</a></li>\n</ul>\n<hr>\n<h1 id=\"gRPC-\"><a href=\"#gRPC-\" class=\"headerlink\" title=\"gRPC \"></a>gRPC </h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> grpc  RPC  HTTP/2 </p>\n<p><a href=\"https://github.com/grpc-ecosystem\" target=\"_blank\" rel=\"noopener\">grpc-ecosystem</a> gRPC  </p>\n<p><a href=\"https://github.com/grpc-ecosystem/awesome-grpc\" target=\"_blank\" rel=\"noopener\">awesome-grpc</a> gRPC   </p>\n<h2 id=\"grpc-\"><a href=\"#grpc-\" class=\"headerlink\" title=\"grpc \"></a>grpc </h2><p><strong></strong></p>\n<ul>\n<li> : <a href=\"https://grpc.io/docs/\" target=\"_blank\" rel=\"noopener\">https://grpc.io/docs/</a> </li>\n<li>github  grpc  doc  <a href=\"https://github.com/grpc/grpc/tree/master/doc\" target=\"_blank\" rel=\"noopener\">https://github.com/grpc/grpc/tree/master/doc</a></li>\n<li> : <a href=\"https://grpc.io/blog/\" target=\"_blank\" rel=\"noopener\">https://grpc.io/blog/</a></li>\n</ul>\n<p><strong></strong></p>\n<p><a href=\"https://grpc.io/community/\" target=\"_blank\" rel=\"noopener\">https://grpc.io/community/</a> </p>\n<ul>\n<li></li>\n<li>Gitter</li>\n<li>Reddit</li>\n<li>Meetup Group </li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><a href=\"https://grpc.io/docs/guides\" target=\"_blank\" rel=\"noopener\">grpc.io</a></p>\n<p><a href=\"https://developers.google.com/protocol-buffers/docs\" target=\"_blank\" rel=\"noopener\">developers.google.com</a></p>\n<p><a href=\"https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-HTTP2.md#Requests\" target=\"_blank\" rel=\"noopener\">gRPC github doc</a></p>\n<p><a href=\"https://tools.ietf.org/html/rfc7540\" target=\"_blank\" rel=\"noopener\">http2 specs</a><br>or<br><a href=\"http://http2.github.io/http2-spec/#StreamPriority\" target=\"_blank\" rel=\"noopener\">github http2 spec</a></p>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>grpc ","more":"</p>\n</blockquote>\n<h1 id=\"gRPC\"><a href=\"#gRPC\" class=\"headerlink\" title=\"gRPC\"></a>gRPC</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>gRPCgoogleHTTP/2Protobuf RPC   </p>\n<p><br>  tracing<br>  <br>   TCP </p>\n<p><strong></strong></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><strong>HTTP/2</strong></p>\n<p>HTTP/2  <br>gRPC HTTP2 HTTP Body Header </p>\n<p><strong>IDLProtoBuffer</strong></p>\n<p>gRPCProtoBufProtoBufGoogleXMLJSON<br>ProtoBuf<br></p>\n<p><strong></strong></p>\n<p>gRPC  </p>\n<p> C#, C++, Dart, Go, Java, Node, Objective-C, PHP, Python, Ruby  </p>\n<p><a href=\"https://grpc.io/docs/quickstart/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h1 id=\"HTTP-2\"><a href=\"#HTTP-2\" class=\"headerlink\" title=\"HTTP/2\"></a>HTTP/2</h1><h2 id=\"HTTP-2-1\"><a href=\"#HTTP-2-1\" class=\"headerlink\" title=\"HTTP/2\"></a>HTTP/2</h2><p>HTTP/1.x 1<br>HTTP/2 2</p>\n<p>HTTP/1  HTTP/2 GET/PUST/PUT/DELETE200/404/500Range RequestCacheingAuthenticationURL</p>\n<p><strong>HTTP/2</strong></p>\n<ul>\n<li>Stream  streams</li>\n<li>Message  requestresponse</li>\n<li>FrameHTTP/2  Frame  stream message  frame </li>\n</ul>\n<p><strong>HTTP/2 </strong>   </p>\n<p>HTTP/2(frame)<br><br><br>ID</p>\n<p><a href=\"https://httpwg.org/specs/rfc7540.html#rfc.section.4.1\" target=\"_blank\" rel=\"noopener\">Frame : </a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">+-----------------------------------------------+</span><br><span class=\"line\">|                 Length (24)                   |</span><br><span class=\"line\">+---------------+---------------+---------------+</span><br><span class=\"line\">|   Type (8)    |   Flags (8)   |</span><br><span class=\"line\">+-+-------------+---------------+-------------------------------+</span><br><span class=\"line\">|R|                 Stream Identifier (31)                      |</span><br><span class=\"line\">+=+=============================================================+</span><br><span class=\"line\">|                   Frame Payload (0...)                      ...</span><br><span class=\"line\">+---------------------------------------------------------------+</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Length   Frame </li>\n<li>Type Frame  DATAHEADERSSETTINGS </li>\n<li>Flags 88stream(END_STREAM)header(END_HEADERS)priority</li>\n<li>R</li>\n<li>Stream Identifierframe stream 0 frame (SETTINGS)</li>\n<li>Frame Payload</li>\n</ul>\n<p><strong></strong>  </p>\n<ul>\n<li>HEADERS HTTP/1 Headers</li>\n<li>DATA HTTP/1 Body</li>\n<li>CONTINUATION HEADERS+CONTINUATION</li>\n<li>SETTINGS </li>\n<li>WINDOW_UPDATE </li>\n<li>PUSH_PROMISE </li>\n<li>PRIORITY </li>\n<li>PING RTT</li>\n<li>RST_STREAM </li>\n<li>GOAWAY </li>\n</ul>\n<h2 id=\"HTTP-2-\"><a href=\"#HTTP-2-\" class=\"headerlink\" title=\"HTTP/2 \"></a>HTTP/2 </h2><p><strong>Binary Format</strong></p>\n<p>HTTP/1 <br>HTTP/2</p>\n<p><strong>MultiPlexing</strong></p>\n<p>HTTP/1 requestrequest TCP connectionTCP connection</p>\n<p>HTTP/2 TCP connectionstreams(SETTINGS_MAX_CONCURRENT_STREAMS) streams frames  </p>\n<p>SETTINGS<code>SETTINGS_MAX_CONCURRENT_STREAMS</code><br>streams  </p>\n<blockquote>\n<p> ID  server  client  GOAWAY frame  client </p>\n</blockquote>\n<p><strong>header</strong></p>\n<p>HTTP/1 header</p>\n<p>HTTP/2 </p>\n<ul>\n<li>HPACK </li>\n<li>headersheaders<ul>\n<li>HTTP/2 headlist  headerheader</li>\n</ul>\n</li>\n</ul>\n<p><a href=\"http://http2.github.io/http2-spec/compression.html\" target=\"_blank\" rel=\"noopener\">HPACK: Header Compression for HTTP/2</a></p>\n<p><strong></strong></p>\n<p>server push :   </p>\n<p>Server PushPUSH_PROMISE<br>PUSH_PROMISE</p>\n<p><strong></strong></p>\n<p>  </p>\n<p> HEADERS  PRIORITY  PRIORITY </p>\n<p><a href=\"http://http2.github.io/http2-spec/#StreamPriority\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong>Flow Control</strong></p>\n<p>HTTP/2 receiver streamconnection<br>TCPconnection  </p>\n<p> </p>\n<ul>\n<li>Flow control  : Receiver  stream  window size</li>\n<li>Flow control  : Receiver  sender   stream  flow control window size</li>\n<li>Flow control  </li>\n<li>Flow control WINDOW_UPDATE</li>\n<li>Flow control  hop-by-hop end-to-end nginxproxyflow controlnginxserverclientnginxconnection</li>\n</ul>\n<blockquote>\n<p>Connection  stream  flow-control window  65535<br>Connection  stream (stream) SETTINGS  <code>SETTINGS_INITIAL_WINDOW_SIZE</code> stream flow-control window </p>\n</blockquote>\n<blockquote>\n<p>flow control window size</p>\n</blockquote>\n<p><strong></strong></p>\n<p>HTTP/1 bodylengthTCP connectionTCP</p>\n<p>HTTP/2  RST_STREAM frame </p>\n<h2 id=\"HTTP-2-demo\"><a href=\"#HTTP-2-demo\" class=\"headerlink\" title=\"HTTP/2 demo\"></a>HTTP/2 demo</h2><p>HTTP/1  HTTP/2 <br><a href=\"https://http2.akamai.com/demo\" target=\"_blank\" rel=\"noopener\">https://http2.akamai.com/demo</a></p>\n<p>http2 <br><a href=\"https://http2.golang.org/\" target=\"_blank\" rel=\"noopener\">https://http2.golang.org/</a></p>\n<h1 id=\"ProtoBuf\"><a href=\"#ProtoBuf\" class=\"headerlink\" title=\"ProtoBuf\"></a>ProtoBuf</h1><h2 id=\"ProtoBuf-1\"><a href=\"#ProtoBuf-1\" class=\"headerlink\" title=\"ProtoBuf\"></a>ProtoBuf</h2><p><strong>Google Protocol Buffer</strong>  </p>\n<p> RPC </p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><strong>gRPCprotobuf</strong></p>\n<p>gRPC protobuf IDL rpc <br>proto</p>\n<ul>\n<li>    </li>\n<li>rpc   gRPC</li>\n</ul>\n<h2 id=\"protobuf-\"><a href=\"#protobuf-\" class=\"headerlink\" title=\"protobuf \"></a>protobuf </h2><p><a href=\"https://developers.google.com/protocol-buffers/docs/proto#scalar\" target=\"_blank\" rel=\"noopener\">https://developers.google.com/protocol-buffers/docs/proto#scalar</a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>user.proto</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">syntax = &quot;proto3&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;google/protobuf/any.proto&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">//package user;</span><br><span class=\"line\">option go_package = &quot;protos_golang/user&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">message User &#123;</span><br><span class=\"line\">  int32 id = 1;</span><br><span class=\"line\">  string name = 2;</span><br><span class=\"line\">  uint32 age = 3;</span><br><span class=\"line\">  enum Flag &#123;</span><br><span class=\"line\">    NORMAL = 0;</span><br><span class=\"line\">    VIP = 1;</span><br><span class=\"line\">    SVIP = 2;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  repeated int32 friends_ids = 5;</span><br><span class=\"line\">  reserved 6, 7, 8;</span><br><span class=\"line\">  message Command &#123;</span><br><span class=\"line\">      int32 id = 1;</span><br><span class=\"line\">      oneof cmd_value &#123;</span><br><span class=\"line\">         string name = 2;</span><br><span class=\"line\">         int32 age = 3;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  Command cmd = 9;</span><br><span class=\"line\">  map&lt;int32, string&gt; tags = 10;</span><br><span class=\"line\">  google.protobuf.Any details = 11;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>package</strong></p>\n<p>package<br>package(go)(c++, java)</p>\n<p><code>option go_package = &quot;protos_golang/user&quot;;</code><br><code>$LANGUAGE_package</code> import pathpackage</p>\n<p><strong>import</strong></p>\n<p>.proto<br>proto <code>package.</code> proto<br><code>common.Flag</code> </p>\n<p><strong></strong></p>\n<p><br> </p>\n<p><strong></strong></p>\n<p><code>syntax = &quot;proto2&quot;;</code> proto2<br><code>syntax = &quot;proto3&quot;;</code> proto3  </p>\n<p><strong></strong></p>\n<p>required  optional proto2proto3<br>proto3optional<a href=\"https://github.com/protocolbuffers/protobuf/issues/2497\" target=\"_blank\" rel=\"noopener\"></a> </p>\n<ul>\n<li>required : </li>\n<li>optional </li>\n<li>repeated </li>\n<li>reserved protobuf</li>\n</ul>\n<p><strong></strong></p>\n<p> enum 0</p>\n<p><strong>oneof</strong></p>\n<p>oneof(UNION)</p>\n<p><strong>map</strong></p>\n<p>map <br>key_type  int  string floatdouble  bytes</p>\n<p><strong>any</strong></p>\n<p>Any:</p>\n<ul>\n<li>bytes : bytes</li>\n<li>URL : </li>\n</ul>\n<p><code>import google/protobuf/any.proto</code>any</p>\n<p>anyproto2extension</p>\n<p><strong></strong></p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">syntax = &quot;proto2&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;user.proto&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">service UserService &#123;</span><br><span class=\"line\">// rpc interface</span><br><span class=\"line\">    rpc GetUserInfo(UserRequest) returns (UserResponse) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">message UserRequest &#123;</span><br><span class=\"line\">    uint32 id = 1;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">message UserResponse &#123;</span><br><span class=\"line\">    user.User user = 1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> .proto  RPC   stubs</p>\n<p><code>import &quot;user.proto&quot;;</code> userproto</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>protoc<br>protoc<code>protoc-gen-$LANGUAGE</code> <br><br><code>--go_out</code>protoc<code>go</code><code>protoc-gen-go</code></p>\n<p><strong></strong></p>\n<ul>\n<li>protoc  protoc-gen-xx</li>\n<li><code>CodeGeneratorRequest</code>protobuf protoc-gen-xx<ul>\n<li>protoc-gen-xx<code>CodeGeneratorRequest</code></li>\n<li><code>CodeGeneratorRequest</code><code>FileDescriptorProto</code>proto</li>\n<li><code>FileDescriptorProto</code></li>\n<li><code>CodeGeneratorResponse</code></li>\n</ul>\n</li>\n<li>protocprotoc-gen-xx</li>\n</ul>\n<p><a href=\"https://github.com/protocolbuffers/protobuf/blob/master/src/google/protobuf/compiler/plugin.proto\" target=\"_blank\" rel=\"noopener\">plugin.proto</a><code>CodeGeneratorRequest</code>  <code>CodeGeneratorResponse</code>protoc  </p>\n<p><a href=\"https://github.com/protocolbuffers/protobuf/blob/master/src/google/protobuf/descriptor.proto\" target=\"_blank\" rel=\"noopener\">descriptor.proto</a><code>.proto</code></p>\n<p><strong>plugins</strong></p>\n<p>plugins</p>\n<p>go grpc</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">protoc --go_out=plugins=grpc:. pb/user.proto</span><br></pre></td></tr></table></figure>\n\n<p>grpc proto-gen-goplugin  </p>\n<p><a href=\"https://github.com/golang/protobuf/blob/master/protoc-gen-go/grpc/grpc.go#L72\" target=\"_blank\" rel=\"noopener\"></a> </p>\n<p><code>Name()</code>grpcplugin<code>plugins=grpc</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Name returns the name of this plugin, &quot;grpc&quot;.</span><br><span class=\"line\">func (g *grpc) Name() string &#123;</span><br><span class=\"line\">\treturn &quot;grpc&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"gRPC-\"><a href=\"#gRPC-\" class=\"headerlink\" title=\"gRPC \"></a>gRPC </h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"https://grpc.io/img/landing-2.svg\" alt=\"image\"></p>\n<p>gRPC <br>rpcgRPC<br>stubrpc  </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>gRPCHTTP2steam identifierIDstream</p>\n<p>HEADER frame<br>protobufDATA frame</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Request Request-Headers  Data  EOS (END_STREAM)  </p>\n<p></p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/network/rpc/grpc/debug/wireshark/grpc_request_stream_decoded_wireshark.png\" alt=\"image\"></p>\n<p><strong>Request-Headers</strong>  </p>\n<p>Request-Headers  HEADERS  CONTINUATION frames <br>Flags<code>END_HEADERS</code>Request-Headers  </p>\n<p>Request-Headers  <code>Call-Definition</code>  <code>Custom-Metadata</code> :</p>\n<ul>\n<li>Call-Definition :  Method, Scheme, Path, TE, Authority, Timeout, Content-Type ,Message-Type, Message-Encoding, Message-Accept-Encoding, User-Agent</li>\n<li>Custom-Metadata :  key-valuekey gRPCkey <code>grpc-</code> </li>\n</ul>\n<p><strong>Data</strong></p>\n<p> Data frame<br>Flags<code>END_STREAM</code>Data </p>\n<p><strong>request</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># request-headers </span><br><span class=\"line\"></span><br><span class=\"line\">HEADERS (flags = END_HEADERS)</span><br><span class=\"line\">:method = POST</span><br><span class=\"line\">:scheme = http</span><br><span class=\"line\">:path = /user.UserService/GetUserInfo</span><br><span class=\"line\">:authority = localhost:50000</span><br><span class=\"line\">grpc-timeout = 999127u</span><br><span class=\"line\">content-type = grpc-go/1.20.0-dev</span><br><span class=\"line\"></span><br><span class=\"line\">## metadata</span><br><span class=\"line\">service : test_client</span><br><span class=\"line\">traceid : xxxx</span><br><span class=\"line\"></span><br><span class=\"line\"># data</span><br><span class=\"line\">DATA (flags = END_STREAM)</span><br><span class=\"line\">&lt;Length-Prefixed Message&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Response  Response-Headers  Data  Trailers <br> Trailers-Only</p>\n<p></p>\n<p><img src=\"https://github.com/ikenchina/img1/raw/master/1/network/rpc/grpc/debug/wireshark/grpc_response_stream_decoded_wireshark.png\" alt=\"image\"></p>\n<p><strong>Response-Headers</strong></p>\n<p>Response-Headers  : HTTP-Status, Message-Encoding, Message-Accept-Encoding, Content-Type, Custom-Metadata</p>\n<p><strong>Data</strong></p>\n<p> Data frame<br>Flags<code>END_STREAM</code>Data </p>\n<p><strong>Trailers</strong></p>\n<p>Trailers-Only  HTTP-Status, Content-Type, Trailers</p>\n<p>Trailers  Status, Status-Message, Custom-Metadata</p>\n<p>Trailers<br>body </p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># response-headers</span><br><span class=\"line\"></span><br><span class=\"line\">HEADERS (flags = END_HEADERS)</span><br><span class=\"line\">:status = status: 200 </span><br><span class=\"line\">content-type = application/grpc</span><br><span class=\"line\"></span><br><span class=\"line\">## metadata</span><br><span class=\"line\">service: server_test</span><br><span class=\"line\">spanid: xxxx</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># data</span><br><span class=\"line\">DATA</span><br><span class=\"line\">&lt;Length-Prefixed Message&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"># headers</span><br><span class=\"line\">HEADERS (flags = END_STREAM, END_HEADERS)</span><br><span class=\"line\">grpc-status: 0</span><br><span class=\"line\"></span><br><span class=\"line\">## trailers metadata</span><br><span class=\"line\">timestamp: 1560656283730441829</span><br></pre></td></tr></table></figure>\n\n<p><strong>Status code</strong></p>\n<p><a href=\"https://github.com/grpc/grpc/blob/master/doc/statuscodes.md\" target=\"_blank\" rel=\"noopener\">HTTPgRPC</a></p>\n<h2 id=\"gRPC\"><a href=\"#gRPC\" class=\"headerlink\" title=\"gRPC\"></a>gRPC</h2><p>gRPC: </p>\n<p>1 unary RPC </p>\n<p>rpc </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># </span><br><span class=\"line\"># proto</span><br><span class=\"line\">rpc GetUserInfo (UserRequest) returns (UserResponse) &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>2 Server-side streaming RPC </p>\n<p>rpc </p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># </span><br><span class=\"line\"># proto</span><br><span class=\"line\">rpc UserLocationsStream(UserRequest) returns (stream LocationsResponse) &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>3 Client-side streaming RPC </p>\n<p>rpc </p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># </span><br><span class=\"line\"># proto</span><br><span class=\"line\">rpc BackupStream(stream BackupRequest) returns (BackupResponse) &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>4 Bidirectional streaming RPC </p>\n<p>rpc </p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># </span><br><span class=\"line\"># proto</span><br><span class=\"line\">rpc LiveChat(stream Message) returns (stream Message) &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>waitForReady</strong></p>\n<p>connectionreadyconnection ready (deadline)<br><code>fail fast</code></p>\n<p><strong>timeout</strong></p>\n<p><br>DEADLINE_EXCEEDED </p>\n<p><strong>maxRequestMessageBytes</strong></p>\n<p>payload size()<br>RESOURCE_EXHAUSTED </p>\n<p><strong>maxResponseMessageBytes</strong></p>\n<p>payload size()<br>RESOURCE_EXHAUSTED </p>\n<hr>\n<h1 id=\"gRPC-\"><a href=\"#gRPC-\" class=\"headerlink\" title=\"gRPC \"></a>gRPC </h1><p>godemo</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>protoc</strong></p>\n<p>mac</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install protobuf</span><br></pre></td></tr></table></figure>\n\n<p>linux</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PROTOC_ZIP=protoc-3.5.1-linux-x86_64.zip</span><br><span class=\"line\">curl -OL https://github.com/protocolbuffers/protobuf/releases/download/v3.5.1/$PROTOC_ZIP</span><br><span class=\"line\"></span><br><span class=\"line\">sudo unzip -o $PROTOC_ZIP -d /usr/local bin/protoc</span><br><span class=\"line\">sudo unzip -o $PROTOC_ZIP -d /usr/local include/*</span><br><span class=\"line\">rm -f $PROTOC_ZIP</span><br></pre></td></tr></table></figure>\n\n<p><strong>golangprotobuffers</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go get -u github.com/golang/protobuf/&#123;protoc-gen-go,proto&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Coding\"><a href=\"#Coding\" class=\"headerlink\" title=\"Coding\"></a>Coding</h2><h3 id=\"proto\"><a href=\"#proto\" class=\"headerlink\" title=\"proto\"></a>proto</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">syntax = &quot;proto3&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;google/protobuf/any.proto&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">//package user;</span><br><span class=\"line\">option go_package = &quot;protos_golang/user&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">message User &#123;</span><br><span class=\"line\">  int32 id = 1;</span><br><span class=\"line\">  string name = 2;</span><br><span class=\"line\">  uint32 age = 3;</span><br><span class=\"line\">  enum Flag &#123;</span><br><span class=\"line\">    NORMAL = 0;</span><br><span class=\"line\">    VIP = 1;</span><br><span class=\"line\">    SVIP = 2;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  repeated int32 friends_ids = 5;</span><br><span class=\"line\">  reserved 6, 7, 8;</span><br><span class=\"line\">  message Command &#123;</span><br><span class=\"line\">      int32 id = 1;</span><br><span class=\"line\">      oneof cmd_value &#123;</span><br><span class=\"line\">         string name = 2;</span><br><span class=\"line\">         int32 age = 3;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  Command cmd = 9;</span><br><span class=\"line\">  map&lt;int32, string&gt; tags = 10;</span><br><span class=\"line\">  google.protobuf.Any details = 11;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">service UserService &#123;</span><br><span class=\"line\">// rpc interface</span><br><span class=\"line\">    rpc GetUserInfo(UserRequest) returns (UserResponse) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">message UserRequest &#123;</span><br><span class=\"line\">    uint32 id = 1;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">message UserResponse &#123;</span><br><span class=\"line\">    User user = 1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">## protos_golang  </span><br><span class=\"line\">## user : golang package </span><br><span class=\"line\">option go_package = &quot;protos_golang/user&quot;;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<ul>\n<li>rpc<code>plugins=grpc</code></li>\n<li><code>--go_out=.</code>  <code></code>; :<code>--go_out=/tmp</code></li>\n<li>  <ul>\n<li>.pb<code>go_package</code> :  <code>./$go_package/user.pb.go</code></li>\n<li>.pb<code>go_package</code> :  <code>./pb/user.pb.go</code></li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">protoc --go_out=plugins=grpc:. pb/user.proto</span><br><span class=\"line\"></span><br><span class=\"line\"># rpc</span><br><span class=\"line\">protoc --go_out=. pb/user.proto</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import (</span><br><span class=\"line\">\t&quot;context&quot;</span><br><span class=\"line\">\t&quot;log&quot;</span><br><span class=\"line\">\t&quot;net&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">    &quot;google.golang.org/grpc&quot;</span><br><span class=\"line\">    &quot;google.golang.org/grpc/reflection&quot;</span><br><span class=\"line\">    </span><br><span class=\"line\">\tpb &quot;testgrpc/protos_golang/user&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">const (</span><br><span class=\"line\">\tport = &quot;:50000&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">// grpc server</span><br><span class=\"line\">type server struct&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// gRPC</span><br><span class=\"line\">func (s *server) GetUserInfo(ctx context.Context, in *pb.UserRequest) (*pb.UserResponse, error) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\treturn &amp;pb.UserResponse&#123;</span><br><span class=\"line\">\t\tUser: &amp;pb.User&#123;</span><br><span class=\"line\">\t\t\tName: &quot;test_user&quot;,</span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t&#125;, nil</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// </span><br><span class=\"line\">func LogUnaryInterceptorMiddleware() grpc.UnaryServerInterceptor &#123;</span><br><span class=\"line\">\treturn func(ctx context.Context, req interface&#123;&#125;, info *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (r interface&#123;&#125;, err error) &#123;</span><br><span class=\"line\">\t\tr, err = handler(ctx, req)</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tfmt.Printf(&quot;fullMethod(%s), errCode(%v)\\n&quot;, info.FullMethod, err)</span><br><span class=\"line\">\t\treturn r, err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">\tlis, err := net.Listen(&quot;tcp&quot;, port)</span><br><span class=\"line\">\tif err != nil &#123;</span><br><span class=\"line\">\t\tlog.Fatalf(&quot;failed to listen: %v&quot;, err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    options := grpc.UnaryInterceptor(LogUnaryInterceptorMiddleware())</span><br><span class=\"line\">\ts := grpc.NewServer(options)</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t// </span><br><span class=\"line\">\tpb.RegisterUserServiceServer(s, &amp;server&#123;&#125;)</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t// </span><br><span class=\"line\">\treflection.Register(s)</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t// </span><br><span class=\"line\">\tif err := s.Serve(lis); err != nil &#123;</span><br><span class=\"line\">\t\tlog.Fatalf(&quot;failed to serve: %v&quot;, err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import (</span><br><span class=\"line\">\t&quot;context&quot;</span><br><span class=\"line\">\t&quot;log&quot;</span><br><span class=\"line\">\t&quot;time&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&quot;google.golang.org/grpc&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpb &quot;testgrpc/protos_golang/user&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">const (</span><br><span class=\"line\">\taddress = &quot;localhost:50000&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\tconn, err := grpc.Dial(address, grpc.WithInsecure())</span><br><span class=\"line\">\tif err != nil &#123;</span><br><span class=\"line\">\t\tlog.Fatalf(&quot;did not connect: %v&quot;, err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tdefer conn.Close()</span><br><span class=\"line\">\tc := pb.NewUserServiceClient(conn)</span><br><span class=\"line\"></span><br><span class=\"line\">\tctx, cancel := context.WithTimeout(context.Background(), time.Second)</span><br><span class=\"line\">\tdefer cancel()</span><br><span class=\"line\"></span><br><span class=\"line\">\tr, err := c.GetUserInfo(ctx, &amp;pb.UserRequest&#123;&#125;)</span><br><span class=\"line\">\tif err != nil &#123;</span><br><span class=\"line\">\t\tlog.Fatalf(&quot;fatal: %v&quot;, err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tlog.Printf(&quot;response: %s&quot;, r)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>reflection  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">reflection.Register(grpcServer)</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ul>\n<li>[grpc_cli](<a href=\"https://github.com/grpc/grpc/blob/master/doc/command_line_tool.md\" target=\"_blank\" rel=\"noopener\">https://github.com/grpc/grpc/blob/master/doc/command_line_tool.md</a> : </li>\n<li><a href=\"https://github.com/fullstorydev/grpcurl\" target=\"_blank\" rel=\"noopener\">grpcurl</a> : go</li>\n</ul>\n<p><strong>service</strong></p>\n<p><code>-plaintext</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ grpcurl -plaintext localhost:50000 list </span><br><span class=\"line\">grpc.reflection.v1alpha.ServerReflection</span><br><span class=\"line\">user.UserService</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ grpcurl -plaintext localhost:50000 list  user.UserService</span><br><span class=\"line\">user.UserService.GetUserInfo</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ grpcurl -plaintext localhost:50000 describe user.UserService.GetUserInfo</span><br><span class=\"line\">user.UserService.GetUserInfo is a method:</span><br><span class=\"line\">rpc GetUserInfo ( .user.UserRequest ) returns ( .user.UserResponse );</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ grpcurl -plaintext localhost:50000 describe .user.UserRequest</span><br><span class=\"line\">user.UserRequest is a message:</span><br><span class=\"line\">message UserRequest &#123;</span><br><span class=\"line\">  uint32 id = 1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<p>json </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ grpcurl -plaintext -d &apos;&#123;&quot;id&quot;:1&#125;&apos;   localhost:50000  user.UserService.GetUserInfo</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;user&quot;: &#123;</span><br><span class=\"line\">    &quot;name&quot;: &quot;test_user&quot;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"go-gRPC-\"><a href=\"#go-gRPC-\" class=\"headerlink\" title=\"go gRPC \"></a>go gRPC </h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<p>rpc<br></p>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/metadata\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong></strong></p>\n<p> :</p>\n<ul>\n<li> : grpcurl reflectionlist</li>\n<li>gRPC </li>\n</ul>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/reflection\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong></strong></p>\n<p></p>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/balancer\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong></strong>  </p>\n<p>gRPC</p>\n<ul>\n<li>SSL/TLS</li>\n<li>Token</li>\n</ul>\n<p></p>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/credentials\" target=\"_blank\" rel=\"noopener\"></a>  </p>\n<ul>\n<li>alts  </li>\n<li>google </li>\n<li>oauth</li>\n<li></li>\n</ul>\n<p><a href=\"https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/auth\" target=\"_blank\" rel=\"noopener\">go-grpc-middleware</a></p>\n<p><strong></strong></p>\n<p><code>Check</code><br></p>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/health\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong>keepalive</strong></p>\n<p>HTTP/2.0 pings connection <br>keepaliveconnection</p>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/keepalive\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong>naming</strong></p>\n<p><br>  </p>\n<p>balancer  </p>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/naming\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong></strong></p>\n<p>  </p>\n<p>balancer </p>\n<p><a href=\"https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/ratelimit\" target=\"_blank\" rel=\"noopener\">go-grpc-middleware</a></p>\n<p><strong>recovery</strong></p>\n<p>gRPC  </p>\n<p><a href=\"https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/recovery\" target=\"_blank\" rel=\"noopener\">go-grpc-middleware</a>  recover gopanic gRPC</p>\n<p><strong></strong></p>\n<p>gRPC</p>\n<p><a href=\"https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/retry\" target=\"_blank\" rel=\"noopener\">go-grpc-middleware</a></p>\n<p><strong>tracing</strong></p>\n<p>tracingopentracing<code></code></p>\n<p>tracingtraceid,spanid,,,<br>spanidspanidparent_spanidrpc</p>\n<p><a href=\"https://godoc.org/github.com/grpc-ecosystem/go-grpc-middleware/tracing/opentracing\" target=\"_blank\" rel=\"noopener\">go-grpc-middlewareopentracingmiddleware</a></p>\n<p><a href=\"https://opentracing.io/docs/\" target=\"_blank\" rel=\"noopener\">open-tracing</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://github.com/go-kit\" target=\"_blank\" rel=\"noopener\">go-kit</a> : <br><a href=\"https://github.com/micro\" target=\"_blank\" rel=\"noopener\">micro</a> : <br><a href=\"https://github.com/go-chassis/go-chassis\" target=\"_blank\" rel=\"noopener\">go-chassis</a> : go<br><a href=\"https://github.com/grpc-ecosystem/go-grpc-middleware\" target=\"_blank\" rel=\"noopener\">go-grpc-middleware</a> : <br><a href=\"https://github.com/grpc-ecosystem/grpc-gateway\" target=\"_blank\" rel=\"noopener\">grpc-gateway</a>  protoc  gRPC  RESTful API  swagger   </p>\n<h3 id=\"gRPC--\"><a href=\"#gRPC--\" class=\"headerlink\" title=\"gRPC  \"></a>gRPC  </h3><p><strong>LB(Balancing-aware Client)</strong></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n<li>sdk</li>\n</ul>\n<p><a href=\"https://godoc.org/google.golang.org/grpc/balancer\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><strong>LB(Proxy Model)</strong></p>\n<p>proxy <br></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><strong><em>Nginx</em></strong></p>\n<blockquote>\n<p>Nginx(1.13.10gRPC) </p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream grpcservers &#123;</span><br><span class=\"line\">    server localhost:50000;</span><br><span class=\"line\">    server localhost:50001;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 9000 http2;</span><br><span class=\"line\"></span><br><span class=\"line\">    # router</span><br><span class=\"line\">    location /user.UserService &#123;</span><br><span class=\"line\">        grpc_pass grpc://grpcservers;</span><br><span class=\"line\">        error_page 502 = /error502grpc;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    # gRPC</span><br><span class=\"line\">    location = /error502grpc &#123;</span><br><span class=\"line\">        internal;</span><br><span class=\"line\">        default_type application/grpc;</span><br><span class=\"line\">        add_header grpc-status 14;</span><br><span class=\"line\">        add_header grpc-message &quot;unavailable&quot;;</span><br><span class=\"line\">        return 204;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://nginx.org/en/docs/http/ngx_http_grpc_module.html\" target=\"_blank\" rel=\"noopener\">nginx gRPC module</a></p>\n<p><strong>LB(External Load Balancing Service)</strong></p>\n<p>LB<br>sdk<br>service mesh</p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>  </p>\n<ul>\n<li><a href=\"https://istio.io/\" target=\"_blank\" rel=\"noopener\">Istio</a>  </li>\n<li><a href=\"https://github.com/lyft/envoy\" target=\"_blank\" rel=\"noopener\">Envoy</a></li>\n</ul>\n<hr>\n<h1 id=\"gRPC-\"><a href=\"#gRPC-\" class=\"headerlink\" title=\"gRPC \"></a>gRPC </h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> grpc  RPC  HTTP/2 </p>\n<p><a href=\"https://github.com/grpc-ecosystem\" target=\"_blank\" rel=\"noopener\">grpc-ecosystem</a> gRPC  </p>\n<p><a href=\"https://github.com/grpc-ecosystem/awesome-grpc\" target=\"_blank\" rel=\"noopener\">awesome-grpc</a> gRPC   </p>\n<h2 id=\"grpc-\"><a href=\"#grpc-\" class=\"headerlink\" title=\"grpc \"></a>grpc </h2><p><strong></strong></p>\n<ul>\n<li> : <a href=\"https://grpc.io/docs/\" target=\"_blank\" rel=\"noopener\">https://grpc.io/docs/</a> </li>\n<li>github  grpc  doc  <a href=\"https://github.com/grpc/grpc/tree/master/doc\" target=\"_blank\" rel=\"noopener\">https://github.com/grpc/grpc/tree/master/doc</a></li>\n<li> : <a href=\"https://grpc.io/blog/\" target=\"_blank\" rel=\"noopener\">https://grpc.io/blog/</a></li>\n</ul>\n<p><strong></strong></p>\n<p><a href=\"https://grpc.io/community/\" target=\"_blank\" rel=\"noopener\">https://grpc.io/community/</a> </p>\n<ul>\n<li></li>\n<li>Gitter</li>\n<li>Reddit</li>\n<li>Meetup Group </li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><a href=\"https://grpc.io/docs/guides\" target=\"_blank\" rel=\"noopener\">grpc.io</a></p>\n<p><a href=\"https://developers.google.com/protocol-buffers/docs\" target=\"_blank\" rel=\"noopener\">developers.google.com</a></p>\n<p><a href=\"https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-HTTP2.md#Requests\" target=\"_blank\" rel=\"noopener\">gRPC github doc</a></p>\n<p><a href=\"https://tools.ietf.org/html/rfc7540\" target=\"_blank\" rel=\"noopener\">http2 specs</a><br>or<br><a href=\"http://http2.github.io/http2-spec/#StreamPriority\" target=\"_blank\" rel=\"noopener\">github http2 spec</a></p>"},{"layout":"post","title":"NUMA","date":"2018-04-11T16:00:00.000Z","_content":"\n> NUMA <!-- more -->  \n\n\n# NUMA \n\nNUMANodesocketcorethread\n\n![cputhreads](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cputhreads.jpg)\n\n\n- socketCPU;   \n- coresocket;    \n- threadhyperthreadcore   \n\nNUMANodecoreOS CPUthreadcoreSocketnode4socketsocket 2nodenode8thread`4Socket 2Node 8 4core  2 Thread = 64thread`\n\nnodeCPUnodeNUMACPUNodeCPUNodeCPUUMA\n\n![numacpus](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/numa-cpus.png)  \n NUMA Best Practices for Dell PowerEdge 12th Generation Servers\n\n\n\nnodeCPUvCPUNodenodeCPUnodeNFV(Network Function Virtualization)vCPUNodepCPUOpenStackKiloNUMA\n\n\n\n##### NUMA\n\n```\n[root@local ~]$ lscpu\nArchitecture:          x86_64\nCPU op-mode(s):        32-bit, 64-bit\nByte Order:            Little Endian\nCPU(s):                48\t\t\t\t//  48CPUthreads\nOn-line CPU(s) list:   0-47\nThread(s) per core:    2\t\t\t\t// core2threads\nCore(s) per socket:    12\t\t\t\t// socket12cores\nSocket(s):             2\t\t\t\t\t// 2sockets\nNUMA node(s):          2\t\t\t\t// 2NUMA nodes\nVendor ID:             GenuineIntel\nCPU family:            6\nModel:                 63\nModel name:            Intel(R) Xeon(R) CPU E5-2680 v3 @ 2.50GHz\nStepping:              2\nCPU MHz:               2500.089\nBogoMIPS:              4999.27\nVirtualization:        VT-x\nL1d cache:             32K\nL1i cache:             32K\nL2 cache:              256K\nL3 cache:              30720K\nNUMA node0 CPU(s):     0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46\nNUMA node1 CPU(s):     1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47\n```\n\n> 2socketssockets1numa nodenuma node12corescores2threadthreads=2x1x12x2=48.\n\n---\n\n# NUMA \n\nx86CPUUMAuniform memory access, \n\n\n\n![cpubus123](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpubus123.png)\n\n\nx86OSSMPCPUx86NUMANon-uniform memory access, \n\n\nNUMAattachCPUdie()CPUattachLocal AccessCPU attachinter-connectRemote AccessNUMANon-Uniform Memory Access\n\nSocketIMCintegrated memory controllers, socketIMCQPI link\n\n\n![cpubus-imc123](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpubus-imc123.png)\n\nsocketcorecoreSMPIMC bus\n\n![cpubus-imc124](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpubus-imc124.png)\n\nsocket1/2socketQPI link/local/remote\n\nXeon 2699 v4CPUSocket9.6GT/sQPI linkSocket2channel3DIMMsocket76.8GB/sQPI linkQPI link9.6GT/s~57.6GB/sQPI link\n\n\n![image](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpu-intel-xeon-e5-2600.png)\n\nSkylakei7 EE18coreSkylake Xeon 28Core(2017)core\nIMClocal/remoteNUMANUMASNC\n\n---\n\n# \n\n  \n- NUMALinuxKernelNUMA nodeNUMA node   \n- NUMA nodeCPUcorelocalcoreNUMA node   \n- NUMA nodenode25%nodeNUMAremote\n- NUMA node node node distances   \nnumactl -H   \n\n```\n[root@local ~]$ numactl -H\navailable: 2 nodes (0-1)\nnode 0 cpus: 0 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46\nnode 0 size: 196514 MB\nnode 0 free: 73363 MB\nnode 1 cpus: 1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45 47\nnode 1 size: 196608 MB\nnode 1 free: 117527 MB\nnode distances:\nnode   0   1 \n  0:  10  21 \n  1:  21  10 \n\n```\n\n0 node 0 node10\n\n\n![image](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/numa-sample1.png)\n\nBenchmark/NUMAQPINUMAQPI\n\nnumactlNUMAcgroupcpuset.memsNUMA node  \n\n\n**Numa:**  \n- default:()  \n- bind:  \n- interleavel:  \n- preferred:  \n\n**numactl** \n\n- interleave=nodes //node\n- membind=nodes //nodeCPUcore\n- cpunodebind=nodes //membindCPUcoreNUMA node\n- physcpubind=cpus //cpunodebindcore\n- localalloc //\n- preferred=node //\n\nMongodbNUMAinterleave=allnode\nPCI/PCIePCHPCIe  \nPCIe channelNUMA\n\nem1NUMA\n\n```\n\n[root@local ~]$ numactl --prefer netdev:em1 --show\npolicy: preferred\npreferred node: 0\nphyscpubind: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 \ncpubind: 0 1 \nnodebind: 0 1 \nmembind: 0 1 \n\n\n```\n\nPCI address 00:1f.2SATApci:   \n00:1f.2 SATA controller: Intel Corporation C610/X99 series chipset 6-Port SATA Controller [AHCI mode] (rev 05)\n\n```\n[root@local ~]$ numactl --prefer pci:00:1f.2 --show\npolicy: preferred\npreferred node: 0\nphyscpubind: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 \ncpubind: 0 1 \nnodebind: 0 1 \nmembind: 0 1 \n\n```\n\n**numa**  \n```\n[root@local ~]$ numactl --show\npolicy: default\npreferred node: current\nphyscpubind: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 \ncpubind: 0 1 \nnodebind: 0 1 \nmembind: 0 1 \n```\n\n\n\n**numa** \n```\n[root@local ~]$ numactl --hardware\navailable: 2 nodes (0-1)\nnode 0 cpus: 0 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46\nnode 0 size: 196514 MB\nnode 0 free: 73338 MB\nnode 1 cpus: 1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45 47\nnode 1 size: 196608 MB\nnode 1 free: 117521 MB\nnode distances:\nnode   0   1 \n  0:  10  21 \n  1:  21  10 \n```\n\n\n\n\n\n\n---\n\n# NUMA\n\n- [MySQL  The MySQL swap insanity problem and the effects of the NUMA architecture](http://blog.jcole.us/2010/09/28/mysql-swap-insanity-and-the-numa-architecture/)\n- [PostgreSQL  PostgreSQL, NUMA and zone reclaim mode on linux](http://frosty-postgres.blogspot.com/2012/08/postgresql-numa-and-zone-reclaim-mode.html)\n- [Oracle  Non-Uniform Memory Access (NUMA) architecture with Oracle database by examples](http://blog.yannickjaquier.com/hpux/non-uniform-memory-access-numa-architecture-with-oracle-database-by-examples.html)\n- [Java  Optimizing Linux Memory Management for Low-latency / High-throughput Databases](https://engineering.linkedin.com/performance/optimizing-linux-memory-management-low-latency-high-throughput-databases)\n\nCPUNUMA Zone Claim\n\n## NUMA\n\n\nMySQLNUMA  \n- [The MySQL swap insanity problem and the effects of the NUMA architecture](https://blog.jcole.us/2010/09/28/mysql-swap-insanity-and-the-numa-architecture/)\n- [A brief update on NUMA and MySQL](https://blog.jcole.us/2012/04/16/a-brief-update-on-numa-and-mysql/)\n\n\n>   \n\n- CPUCPU   \n- NUMACPUChip4Chip   \n- CPUChipCPURemote Access   \n- LinuxCPUCore/Chip   \n- CPU 0   \n- Reclaim/SwapChip    \n- \n\n> \n\n- numactl --interleave=all\n- MySQLsysctl -q -w - vm.drop_caches=3\n- InnodbInnodb_buffer_pool_size\n\n> NUMAMySQL SWAPMySQLInnodb Buffer PoolPageSwap\n\n- vm.zone_reclaim_mode = 0remote memoryswap out local page\n- echo -15 > /proc//oom_adjMySQLOOM_killerKill\n- memlock\n- MySQLHuge PageHuge Pageswap\n\n\n\n\n**Interleave**  \n Carrefour Interleave30%LinuxworkloadInterleavepageCPU CoreCPURemote AccessNUMACore\n\n![image](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/numa-compare1.png)\n\nMySQLInterleave` NUMARemote AcessRemote Accessinterconnect`InterleaveRemote AccessInterleave\n\nInterleaveNUMA   \nLinuxNUMACPU  \nDynamic Memory Loaction, Page Replication\n\n\n**Dynamic Memory Relocation**   \nMySQLSQLflushiomastercoreRemote AccessPage FlushPurgeMySQL CrashRecoveryrecovery   \nInterleaveCPUDynamic Memory RelocationpagememoryprofileMemory Accessprofile  \n\n\n**Page Replication**  \nCPUCPUMemory ZoneinterconnectMESIPage Replication\n\n\n## NUMA\n* BIOS\n* OSnuma=off\n* numactl numactl --interleave=all\n\n\n\n## NUMA\n\n**numa**  \nnumactl -m-physcpubindcpumemory:  \n*`numactl physcpubind=2,6 ./program`*\n\n[cpu-topology](http://www.searchtb.com/2012/12/%E7%8E%A9%E8%BD%ACcpu-topology.html)() nodenode38s28snuma node\n\n**numa**  \n[SWAP](http://huoding.com/2012/11/08/198) numaswapnumanuma nodenuma nodeswapswap  \n`numactl --interleave=all`numa node\n\n\nNUMA:  \n- numa nodenuma\n- numa node\n\n\n---\n#### :  \n\n- [NUMA-aware scheduler for Go](https://docs.google.com/document/u/0/d/1d3iI2QWURgDIsSR6G2275vMeQ_X7w-qxM2Vp7iGwwuM/pub)\n- [PostgreSQL, NUMA and zone reclaim mode on linux](http://frosty-postgres.blogspot.com/2012/08/postgresql-numa-and-zone-reclaim-mode.html)\n- [NUMA and Java Databases](https://www.slideshare.net/slidunder/numa-and-java-databases)\n- [MySQL Server and NUMA architectures](http://mikaelronstrom.blogspot.com/2010/12/mysql-server-and-numa-architectures.html)\n","source":"_posts/numa.md","raw":"---\nlayout: post\ncategory: \"2018\"\ntitle:  \"NUMA\"\ntags: [cpu]\ndate: 2018-04-12\n---\n\n> NUMA <!-- more -->  \n\n\n# NUMA \n\nNUMANodesocketcorethread\n\n![cputhreads](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cputhreads.jpg)\n\n\n- socketCPU;   \n- coresocket;    \n- threadhyperthreadcore   \n\nNUMANodecoreOS CPUthreadcoreSocketnode4socketsocket 2nodenode8thread`4Socket 2Node 8 4core  2 Thread = 64thread`\n\nnodeCPUnodeNUMACPUNodeCPUNodeCPUUMA\n\n![numacpus](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/numa-cpus.png)  \n NUMA Best Practices for Dell PowerEdge 12th Generation Servers\n\n\n\nnodeCPUvCPUNodenodeCPUnodeNFV(Network Function Virtualization)vCPUNodepCPUOpenStackKiloNUMA\n\n\n\n##### NUMA\n\n```\n[root@local ~]$ lscpu\nArchitecture:          x86_64\nCPU op-mode(s):        32-bit, 64-bit\nByte Order:            Little Endian\nCPU(s):                48\t\t\t\t//  48CPUthreads\nOn-line CPU(s) list:   0-47\nThread(s) per core:    2\t\t\t\t// core2threads\nCore(s) per socket:    12\t\t\t\t// socket12cores\nSocket(s):             2\t\t\t\t\t// 2sockets\nNUMA node(s):          2\t\t\t\t// 2NUMA nodes\nVendor ID:             GenuineIntel\nCPU family:            6\nModel:                 63\nModel name:            Intel(R) Xeon(R) CPU E5-2680 v3 @ 2.50GHz\nStepping:              2\nCPU MHz:               2500.089\nBogoMIPS:              4999.27\nVirtualization:        VT-x\nL1d cache:             32K\nL1i cache:             32K\nL2 cache:              256K\nL3 cache:              30720K\nNUMA node0 CPU(s):     0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46\nNUMA node1 CPU(s):     1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47\n```\n\n> 2socketssockets1numa nodenuma node12corescores2threadthreads=2x1x12x2=48.\n\n---\n\n# NUMA \n\nx86CPUUMAuniform memory access, \n\n\n\n![cpubus123](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpubus123.png)\n\n\nx86OSSMPCPUx86NUMANon-uniform memory access, \n\n\nNUMAattachCPUdie()CPUattachLocal AccessCPU attachinter-connectRemote AccessNUMANon-Uniform Memory Access\n\nSocketIMCintegrated memory controllers, socketIMCQPI link\n\n\n![cpubus-imc123](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpubus-imc123.png)\n\nsocketcorecoreSMPIMC bus\n\n![cpubus-imc124](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpubus-imc124.png)\n\nsocket1/2socketQPI link/local/remote\n\nXeon 2699 v4CPUSocket9.6GT/sQPI linkSocket2channel3DIMMsocket76.8GB/sQPI linkQPI link9.6GT/s~57.6GB/sQPI link\n\n\n![image](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpu-intel-xeon-e5-2600.png)\n\nSkylakei7 EE18coreSkylake Xeon 28Core(2017)core\nIMClocal/remoteNUMANUMASNC\n\n---\n\n# \n\n  \n- NUMALinuxKernelNUMA nodeNUMA node   \n- NUMA nodeCPUcorelocalcoreNUMA node   \n- NUMA nodenode25%nodeNUMAremote\n- NUMA node node node distances   \nnumactl -H   \n\n```\n[root@local ~]$ numactl -H\navailable: 2 nodes (0-1)\nnode 0 cpus: 0 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46\nnode 0 size: 196514 MB\nnode 0 free: 73363 MB\nnode 1 cpus: 1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45 47\nnode 1 size: 196608 MB\nnode 1 free: 117527 MB\nnode distances:\nnode   0   1 \n  0:  10  21 \n  1:  21  10 \n\n```\n\n0 node 0 node10\n\n\n![image](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/numa-sample1.png)\n\nBenchmark/NUMAQPINUMAQPI\n\nnumactlNUMAcgroupcpuset.memsNUMA node  \n\n\n**Numa:**  \n- default:()  \n- bind:  \n- interleavel:  \n- preferred:  \n\n**numactl** \n\n- interleave=nodes //node\n- membind=nodes //nodeCPUcore\n- cpunodebind=nodes //membindCPUcoreNUMA node\n- physcpubind=cpus //cpunodebindcore\n- localalloc //\n- preferred=node //\n\nMongodbNUMAinterleave=allnode\nPCI/PCIePCHPCIe  \nPCIe channelNUMA\n\nem1NUMA\n\n```\n\n[root@local ~]$ numactl --prefer netdev:em1 --show\npolicy: preferred\npreferred node: 0\nphyscpubind: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 \ncpubind: 0 1 \nnodebind: 0 1 \nmembind: 0 1 \n\n\n```\n\nPCI address 00:1f.2SATApci:   \n00:1f.2 SATA controller: Intel Corporation C610/X99 series chipset 6-Port SATA Controller [AHCI mode] (rev 05)\n\n```\n[root@local ~]$ numactl --prefer pci:00:1f.2 --show\npolicy: preferred\npreferred node: 0\nphyscpubind: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 \ncpubind: 0 1 \nnodebind: 0 1 \nmembind: 0 1 \n\n```\n\n**numa**  \n```\n[root@local ~]$ numactl --show\npolicy: default\npreferred node: current\nphyscpubind: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 \ncpubind: 0 1 \nnodebind: 0 1 \nmembind: 0 1 \n```\n\n\n\n**numa** \n```\n[root@local ~]$ numactl --hardware\navailable: 2 nodes (0-1)\nnode 0 cpus: 0 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46\nnode 0 size: 196514 MB\nnode 0 free: 73338 MB\nnode 1 cpus: 1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45 47\nnode 1 size: 196608 MB\nnode 1 free: 117521 MB\nnode distances:\nnode   0   1 \n  0:  10  21 \n  1:  21  10 \n```\n\n\n\n\n\n\n---\n\n# NUMA\n\n- [MySQL  The MySQL swap insanity problem and the effects of the NUMA architecture](http://blog.jcole.us/2010/09/28/mysql-swap-insanity-and-the-numa-architecture/)\n- [PostgreSQL  PostgreSQL, NUMA and zone reclaim mode on linux](http://frosty-postgres.blogspot.com/2012/08/postgresql-numa-and-zone-reclaim-mode.html)\n- [Oracle  Non-Uniform Memory Access (NUMA) architecture with Oracle database by examples](http://blog.yannickjaquier.com/hpux/non-uniform-memory-access-numa-architecture-with-oracle-database-by-examples.html)\n- [Java  Optimizing Linux Memory Management for Low-latency / High-throughput Databases](https://engineering.linkedin.com/performance/optimizing-linux-memory-management-low-latency-high-throughput-databases)\n\nCPUNUMA Zone Claim\n\n## NUMA\n\n\nMySQLNUMA  \n- [The MySQL swap insanity problem and the effects of the NUMA architecture](https://blog.jcole.us/2010/09/28/mysql-swap-insanity-and-the-numa-architecture/)\n- [A brief update on NUMA and MySQL](https://blog.jcole.us/2012/04/16/a-brief-update-on-numa-and-mysql/)\n\n\n>   \n\n- CPUCPU   \n- NUMACPUChip4Chip   \n- CPUChipCPURemote Access   \n- LinuxCPUCore/Chip   \n- CPU 0   \n- Reclaim/SwapChip    \n- \n\n> \n\n- numactl --interleave=all\n- MySQLsysctl -q -w - vm.drop_caches=3\n- InnodbInnodb_buffer_pool_size\n\n> NUMAMySQL SWAPMySQLInnodb Buffer PoolPageSwap\n\n- vm.zone_reclaim_mode = 0remote memoryswap out local page\n- echo -15 > /proc//oom_adjMySQLOOM_killerKill\n- memlock\n- MySQLHuge PageHuge Pageswap\n\n\n\n\n**Interleave**  \n Carrefour Interleave30%LinuxworkloadInterleavepageCPU CoreCPURemote AccessNUMACore\n\n![image](https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/numa-compare1.png)\n\nMySQLInterleave` NUMARemote AcessRemote Accessinterconnect`InterleaveRemote AccessInterleave\n\nInterleaveNUMA   \nLinuxNUMACPU  \nDynamic Memory Loaction, Page Replication\n\n\n**Dynamic Memory Relocation**   \nMySQLSQLflushiomastercoreRemote AccessPage FlushPurgeMySQL CrashRecoveryrecovery   \nInterleaveCPUDynamic Memory RelocationpagememoryprofileMemory Accessprofile  \n\n\n**Page Replication**  \nCPUCPUMemory ZoneinterconnectMESIPage Replication\n\n\n## NUMA\n* BIOS\n* OSnuma=off\n* numactl numactl --interleave=all\n\n\n\n## NUMA\n\n**numa**  \nnumactl -m-physcpubindcpumemory:  \n*`numactl physcpubind=2,6 ./program`*\n\n[cpu-topology](http://www.searchtb.com/2012/12/%E7%8E%A9%E8%BD%ACcpu-topology.html)() nodenode38s28snuma node\n\n**numa**  \n[SWAP](http://huoding.com/2012/11/08/198) numaswapnumanuma nodenuma nodeswapswap  \n`numactl --interleave=all`numa node\n\n\nNUMA:  \n- numa nodenuma\n- numa node\n\n\n---\n#### :  \n\n- [NUMA-aware scheduler for Go](https://docs.google.com/document/u/0/d/1d3iI2QWURgDIsSR6G2275vMeQ_X7w-qxM2Vp7iGwwuM/pub)\n- [PostgreSQL, NUMA and zone reclaim mode on linux](http://frosty-postgres.blogspot.com/2012/08/postgresql-numa-and-zone-reclaim-mode.html)\n- [NUMA and Java Databases](https://www.slideshare.net/slidunder/numa-and-java-databases)\n- [MySQL Server and NUMA architectures](http://mikaelronstrom.blogspot.com/2010/12/mysql-server-and-numa-architectures.html)\n","slug":"numa","published":1,"updated":"2020-04-15T03:28:41.896Z","comments":1,"photos":[],"link":"","_id":"ck9115hpo0006ppfcd7gc8851","content":"<blockquote>\n<p>NUMA <a id=\"more\"></a>  </p>\n</blockquote>\n<h1 id=\"NUMA-\"><a href=\"#NUMA-\" class=\"headerlink\" title=\"NUMA \"></a>NUMA </h1><p>NUMANodesocketcorethread</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cputhreads.jpg\" alt=\"cputhreads\"></p>\n<ul>\n<li>socketCPU;   </li>\n<li>coresocket;    </li>\n<li>threadhyperthreadcore   </li>\n</ul>\n<p>NUMANodecoreOS CPUthreadcoreSocketnode4socketsocket 2nodenode8thread<code>4Socket 2Node 8 4core  2 Thread = 64thread</code></p>\n<p>nodeCPUnodeNUMACPUNodeCPUNodeCPUUMA</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/numa-cpus.png\" alt=\"numacpus\"><br> NUMA Best Practices for Dell PowerEdge 12th Generation Servers</p>\n<p>nodeCPUvCPUNodenodeCPUnodeNFV(Network Function Virtualization)vCPUNodepCPUOpenStackKiloNUMA</p>\n<h5 id=\"NUMA\"><a href=\"#NUMA\" class=\"headerlink\" title=\"NUMA\"></a>NUMA</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@local ~]$ lscpu</span><br><span class=\"line\">Architecture:          x86_64</span><br><span class=\"line\">CPU op-mode(s):        32-bit, 64-bit</span><br><span class=\"line\">Byte Order:            Little Endian</span><br><span class=\"line\">CPU(s):                48\t\t\t\t//  48CPUthreads</span><br><span class=\"line\">On-line CPU(s) list:   0-47</span><br><span class=\"line\">Thread(s) per core:    2\t\t\t\t// core2threads</span><br><span class=\"line\">Core(s) per socket:    12\t\t\t\t// socket12cores</span><br><span class=\"line\">Socket(s):             2\t\t\t\t\t// 2sockets</span><br><span class=\"line\">NUMA node(s):          2\t\t\t\t// 2NUMA nodes</span><br><span class=\"line\">Vendor ID:             GenuineIntel</span><br><span class=\"line\">CPU family:            6</span><br><span class=\"line\">Model:                 63</span><br><span class=\"line\">Model name:            Intel(R) Xeon(R) CPU E5-2680 v3 @ 2.50GHz</span><br><span class=\"line\">Stepping:              2</span><br><span class=\"line\">CPU MHz:               2500.089</span><br><span class=\"line\">BogoMIPS:              4999.27</span><br><span class=\"line\">Virtualization:        VT-x</span><br><span class=\"line\">L1d cache:             32K</span><br><span class=\"line\">L1i cache:             32K</span><br><span class=\"line\">L2 cache:              256K</span><br><span class=\"line\">L3 cache:              30720K</span><br><span class=\"line\">NUMA node0 CPU(s):     0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46</span><br><span class=\"line\">NUMA node1 CPU(s):     1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>2socketssockets1numa nodenuma node12corescores2threadthreads=2x1x12x2=48.</p>\n</blockquote>\n<hr>\n<h1 id=\"NUMA-\"><a href=\"#NUMA-\" class=\"headerlink\" title=\"NUMA \"></a>NUMA </h1><p>x86CPUUMAuniform memory access, <br></p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpubus123.png\" alt=\"cpubus123\"></p>\n<p>x86OSSMPCPUx86NUMANon-uniform memory access, </p>\n<p>NUMAattachCPUdie()CPUattachLocal AccessCPU attachinter-connectRemote AccessNUMANon-Uniform Memory Access</p>\n<p>SocketIMCintegrated memory controllers, socketIMCQPI link</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpubus-imc123.png\" alt=\"cpubus-imc123\"></p>\n<p>socketcorecoreSMPIMC bus</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpubus-imc124.png\" alt=\"cpubus-imc124\"></p>\n<p>socket1/2socketQPI link/local/remote</p>\n<p>Xeon 2699 v4CPUSocket9.6GT/sQPI linkSocket2channel3DIMMsocket76.8GB/sQPI linkQPI link9.6GT/s~57.6GB/sQPI link</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpu-intel-xeon-e5-2600.png\" alt=\"image\"></p>\n<p>Skylakei7 EE18coreSkylake Xeon 28Core(2017)core<br>IMClocal/remoteNUMANUMASNC</p>\n<hr>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>  </p>\n<ul>\n<li>NUMALinuxKernelNUMA nodeNUMA node   </li>\n<li>NUMA nodeCPUcorelocalcoreNUMA node   </li>\n<li>NUMA nodenode25%nodeNUMAremote</li>\n<li>NUMA node node node distances<br>numactl -H   </li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@local ~]$ numactl -H</span><br><span class=\"line\">available: 2 nodes (0-1)</span><br><span class=\"line\">node 0 cpus: 0 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46</span><br><span class=\"line\">node 0 size: 196514 MB</span><br><span class=\"line\">node 0 free: 73363 MB</span><br><span class=\"line\">node 1 cpus: 1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45 47</span><br><span class=\"line\">node 1 size: 196608 MB</span><br><span class=\"line\">node 1 free: 117527 MB</span><br><span class=\"line\">node distances:</span><br><span class=\"line\">node   0   1 </span><br><span class=\"line\">  0:  10  21 </span><br><span class=\"line\">  1:  21  10</span><br></pre></td></tr></table></figure>\n\n<p>0 node 0 node10</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/numa-sample1.png\" alt=\"image\"></p>\n<p>Benchmark/NUMAQPINUMAQPI</p>\n<p>numactlNUMAcgroupcpuset.memsNUMA node  </p>\n<p><strong>Numa:</strong>  </p>\n<ul>\n<li>default:()  </li>\n<li>bind:  </li>\n<li>interleavel:  </li>\n<li>preferred:  </li>\n</ul>\n<p><strong>numactl</strong> </p>\n<ul>\n<li>interleave=nodes //node</li>\n<li>membind=nodes //nodeCPUcore</li>\n<li>cpunodebind=nodes //membindCPUcoreNUMA node</li>\n<li>physcpubind=cpus //cpunodebindcore</li>\n<li>localalloc //</li>\n<li>preferred=node //</li>\n</ul>\n<p>MongodbNUMAinterleave=allnode<br>PCI/PCIePCHPCIe<br>PCIe channelNUMA</p>\n<p>em1NUMA</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">[root@local ~]$ numactl --prefer netdev:em1 --show</span><br><span class=\"line\">policy: preferred</span><br><span class=\"line\">preferred node: 0</span><br><span class=\"line\">physcpubind: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 </span><br><span class=\"line\">cpubind: 0 1 </span><br><span class=\"line\">nodebind: 0 1 </span><br><span class=\"line\">membind: 0 1</span><br></pre></td></tr></table></figure>\n\n<p>PCI address 00:1f.2SATApci:<br>00:1f.2 SATA controller: Intel Corporation C610/X99 series chipset 6-Port SATA Controller [AHCI mode] (rev 05)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@local ~]$ numactl --prefer pci:00:1f.2 --show</span><br><span class=\"line\">policy: preferred</span><br><span class=\"line\">preferred node: 0</span><br><span class=\"line\">physcpubind: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 </span><br><span class=\"line\">cpubind: 0 1 </span><br><span class=\"line\">nodebind: 0 1 </span><br><span class=\"line\">membind: 0 1</span><br></pre></td></tr></table></figure>\n\n<p><strong>numa</strong>  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@local ~]$ numactl --show</span><br><span class=\"line\">policy: default</span><br><span class=\"line\">preferred node: current</span><br><span class=\"line\">physcpubind: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 </span><br><span class=\"line\">cpubind: 0 1 </span><br><span class=\"line\">nodebind: 0 1 </span><br><span class=\"line\">membind: 0 1</span><br></pre></td></tr></table></figure>\n\n<p><strong>numa</strong> </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@local ~]$ numactl --hardware</span><br><span class=\"line\">available: 2 nodes (0-1)</span><br><span class=\"line\">node 0 cpus: 0 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46</span><br><span class=\"line\">node 0 size: 196514 MB</span><br><span class=\"line\">node 0 free: 73338 MB</span><br><span class=\"line\">node 1 cpus: 1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45 47</span><br><span class=\"line\">node 1 size: 196608 MB</span><br><span class=\"line\">node 1 free: 117521 MB</span><br><span class=\"line\">node distances:</span><br><span class=\"line\">node   0   1 </span><br><span class=\"line\">  0:  10  21 </span><br><span class=\"line\">  1:  21  10</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h1 id=\"NUMA\"><a href=\"#NUMA\" class=\"headerlink\" title=\"NUMA\"></a>NUMA</h1><ul>\n<li><a href=\"http://blog.jcole.us/2010/09/28/mysql-swap-insanity-and-the-numa-architecture/\" target=\"_blank\" rel=\"noopener\">MySQL  The MySQL swap insanity problem and the effects of the NUMA architecture</a></li>\n<li><a href=\"http://frosty-postgres.blogspot.com/2012/08/postgresql-numa-and-zone-reclaim-mode.html\" target=\"_blank\" rel=\"noopener\">PostgreSQL  PostgreSQL, NUMA and zone reclaim mode on linux</a></li>\n<li><a href=\"http://blog.yannickjaquier.com/hpux/non-uniform-memory-access-numa-architecture-with-oracle-database-by-examples.html\" target=\"_blank\" rel=\"noopener\">Oracle  Non-Uniform Memory Access (NUMA) architecture with Oracle database by examples</a></li>\n<li><a href=\"https://engineering.linkedin.com/performance/optimizing-linux-memory-management-low-latency-high-throughput-databases\" target=\"_blank\" rel=\"noopener\">Java  Optimizing Linux Memory Management for Low-latency / High-throughput Databases</a></li>\n</ul>\n<p>CPUNUMA Zone Claim</p>\n<h2 id=\"NUMA\"><a href=\"#NUMA\" class=\"headerlink\" title=\"NUMA\"></a>NUMA</h2><p>MySQLNUMA  </p>\n<ul>\n<li><a href=\"https://blog.jcole.us/2010/09/28/mysql-swap-insanity-and-the-numa-architecture/\" target=\"_blank\" rel=\"noopener\">The MySQL swap insanity problem and the effects of the NUMA architecture</a></li>\n<li><a href=\"https://blog.jcole.us/2012/04/16/a-brief-update-on-numa-and-mysql/\" target=\"_blank\" rel=\"noopener\">A brief update on NUMA and MySQL</a></li>\n</ul>\n<blockquote>\n<p>  </p>\n</blockquote>\n<ul>\n<li>CPUCPU   </li>\n<li>NUMACPUChip4Chip   </li>\n<li>CPUChipCPURemote Access   </li>\n<li>LinuxCPUCore/Chip   </li>\n<li>CPU 0   </li>\n<li>Reclaim/SwapChip    </li>\n<li></li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li>numactl interleave=all</li>\n<li>MySQLsysctl -q -w - vm.drop_caches=3</li>\n<li>InnodbInnodb_buffer_pool_size</li>\n</ul>\n<blockquote>\n<p>NUMAMySQL SWAPMySQLInnodb Buffer PoolPageSwap</p>\n</blockquote>\n<ul>\n<li>vm.zone_reclaim_mode = 0remote memoryswap out local page</li>\n<li>echo -15 &gt; /proc//oom_adjMySQLOOM_killerKill</li>\n<li>memlock</li>\n<li>MySQLHuge PageHuge Pageswap</li>\n</ul>\n<p><strong>Interleave</strong><br> Carrefour Interleave30%LinuxworkloadInterleavepageCPU CoreCPURemote AccessNUMACore</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/numa-compare1.png\" alt=\"image\"></p>\n<p>MySQLInterleave<code> NUMARemote AcessRemote Accessinterconnect</code>InterleaveRemote AccessInterleave</p>\n<p>InterleaveNUMA<br>LinuxNUMACPU<br>Dynamic Memory Loaction, Page Replication</p>\n<p><strong>Dynamic Memory Relocation</strong><br>MySQLSQLflushiomastercoreRemote AccessPage FlushPurgeMySQL CrashRecoveryrecovery<br>InterleaveCPUDynamic Memory RelocationpagememoryprofileMemory Accessprofile  </p>\n<p><strong>Page Replication</strong><br>CPUCPUMemory ZoneinterconnectMESIPage Replication</p>\n<h2 id=\"NUMA\"><a href=\"#NUMA\" class=\"headerlink\" title=\"NUMA\"></a>NUMA</h2><ul>\n<li>BIOS</li>\n<li>OSnuma=off</li>\n<li>numactl numactl interleave=all</li>\n</ul>\n<h2 id=\"NUMA\"><a href=\"#NUMA\" class=\"headerlink\" title=\"NUMA\"></a>NUMA</h2><p><strong>numa</strong><br>numactl -m-physcpubindcpumemory:<br><em><code>numactl physcpubind=2,6 ./program</code></em></p>\n<p><a href=\"http://www.searchtb.com/2012/12/%E7%8E%A9%E8%BD%ACcpu-topology.html\" target=\"_blank\" rel=\"noopener\">cpu-topology</a>() nodenode38s28snuma node</p>\n<p><strong>numa</strong><br><a href=\"http://huoding.com/2012/11/08/198\" target=\"_blank\" rel=\"noopener\">SWAP</a> numaswapnumanuma nodenuma nodeswapswap<br><code>numactl --interleave=all</code>numa node</p>\n<p>NUMA:  </p>\n<ul>\n<li>numa nodenuma</li>\n<li>numa node</li>\n</ul>\n<hr>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\":\"></a>:</h4><ul>\n<li><a href=\"https://docs.google.com/document/u/0/d/1d3iI2QWURgDIsSR6G2275vMeQ_X7w-qxM2Vp7iGwwuM/pub\" target=\"_blank\" rel=\"noopener\">NUMA-aware scheduler for Go</a></li>\n<li><a href=\"http://frosty-postgres.blogspot.com/2012/08/postgresql-numa-and-zone-reclaim-mode.html\" target=\"_blank\" rel=\"noopener\">PostgreSQL, NUMA and zone reclaim mode on linux</a></li>\n<li><a href=\"https://www.slideshare.net/slidunder/numa-and-java-databases\" target=\"_blank\" rel=\"noopener\">NUMA and Java Databases</a></li>\n<li><a href=\"http://mikaelronstrom.blogspot.com/2010/12/mysql-server-and-numa-architectures.html\" target=\"_blank\" rel=\"noopener\">MySQL Server and NUMA architectures</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>NUMA ","more":"</p>\n</blockquote>\n<h1 id=\"NUMA-\"><a href=\"#NUMA-\" class=\"headerlink\" title=\"NUMA \"></a>NUMA </h1><p>NUMANodesocketcorethread</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cputhreads.jpg\" alt=\"cputhreads\"></p>\n<ul>\n<li>socketCPU;   </li>\n<li>coresocket;    </li>\n<li>threadhyperthreadcore   </li>\n</ul>\n<p>NUMANodecoreOS CPUthreadcoreSocketnode4socketsocket 2nodenode8thread<code>4Socket 2Node 8 4core  2 Thread = 64thread</code></p>\n<p>nodeCPUnodeNUMACPUNodeCPUNodeCPUUMA</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/numa-cpus.png\" alt=\"numacpus\"><br> NUMA Best Practices for Dell PowerEdge 12th Generation Servers</p>\n<p>nodeCPUvCPUNodenodeCPUnodeNFV(Network Function Virtualization)vCPUNodepCPUOpenStackKiloNUMA</p>\n<h5 id=\"NUMA\"><a href=\"#NUMA\" class=\"headerlink\" title=\"NUMA\"></a>NUMA</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@local ~]$ lscpu</span><br><span class=\"line\">Architecture:          x86_64</span><br><span class=\"line\">CPU op-mode(s):        32-bit, 64-bit</span><br><span class=\"line\">Byte Order:            Little Endian</span><br><span class=\"line\">CPU(s):                48\t\t\t\t//  48CPUthreads</span><br><span class=\"line\">On-line CPU(s) list:   0-47</span><br><span class=\"line\">Thread(s) per core:    2\t\t\t\t// core2threads</span><br><span class=\"line\">Core(s) per socket:    12\t\t\t\t// socket12cores</span><br><span class=\"line\">Socket(s):             2\t\t\t\t\t// 2sockets</span><br><span class=\"line\">NUMA node(s):          2\t\t\t\t// 2NUMA nodes</span><br><span class=\"line\">Vendor ID:             GenuineIntel</span><br><span class=\"line\">CPU family:            6</span><br><span class=\"line\">Model:                 63</span><br><span class=\"line\">Model name:            Intel(R) Xeon(R) CPU E5-2680 v3 @ 2.50GHz</span><br><span class=\"line\">Stepping:              2</span><br><span class=\"line\">CPU MHz:               2500.089</span><br><span class=\"line\">BogoMIPS:              4999.27</span><br><span class=\"line\">Virtualization:        VT-x</span><br><span class=\"line\">L1d cache:             32K</span><br><span class=\"line\">L1i cache:             32K</span><br><span class=\"line\">L2 cache:              256K</span><br><span class=\"line\">L3 cache:              30720K</span><br><span class=\"line\">NUMA node0 CPU(s):     0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46</span><br><span class=\"line\">NUMA node1 CPU(s):     1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>2socketssockets1numa nodenuma node12corescores2threadthreads=2x1x12x2=48.</p>\n</blockquote>\n<hr>\n<h1 id=\"NUMA-\"><a href=\"#NUMA-\" class=\"headerlink\" title=\"NUMA \"></a>NUMA </h1><p>x86CPUUMAuniform memory access, <br></p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpubus123.png\" alt=\"cpubus123\"></p>\n<p>x86OSSMPCPUx86NUMANon-uniform memory access, </p>\n<p>NUMAattachCPUdie()CPUattachLocal AccessCPU attachinter-connectRemote AccessNUMANon-Uniform Memory Access</p>\n<p>SocketIMCintegrated memory controllers, socketIMCQPI link</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpubus-imc123.png\" alt=\"cpubus-imc123\"></p>\n<p>socketcorecoreSMPIMC bus</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpubus-imc124.png\" alt=\"cpubus-imc124\"></p>\n<p>socket1/2socketQPI link/local/remote</p>\n<p>Xeon 2699 v4CPUSocket9.6GT/sQPI linkSocket2channel3DIMMsocket76.8GB/sQPI linkQPI link9.6GT/s~57.6GB/sQPI link</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/cpu-intel-xeon-e5-2600.png\" alt=\"image\"></p>\n<p>Skylakei7 EE18coreSkylake Xeon 28Core(2017)core<br>IMClocal/remoteNUMANUMASNC</p>\n<hr>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>  </p>\n<ul>\n<li>NUMALinuxKernelNUMA nodeNUMA node   </li>\n<li>NUMA nodeCPUcorelocalcoreNUMA node   </li>\n<li>NUMA nodenode25%nodeNUMAremote</li>\n<li>NUMA node node node distances<br>numactl -H   </li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@local ~]$ numactl -H</span><br><span class=\"line\">available: 2 nodes (0-1)</span><br><span class=\"line\">node 0 cpus: 0 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46</span><br><span class=\"line\">node 0 size: 196514 MB</span><br><span class=\"line\">node 0 free: 73363 MB</span><br><span class=\"line\">node 1 cpus: 1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45 47</span><br><span class=\"line\">node 1 size: 196608 MB</span><br><span class=\"line\">node 1 free: 117527 MB</span><br><span class=\"line\">node distances:</span><br><span class=\"line\">node   0   1 </span><br><span class=\"line\">  0:  10  21 </span><br><span class=\"line\">  1:  21  10</span><br></pre></td></tr></table></figure>\n\n<p>0 node 0 node10</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/numa-sample1.png\" alt=\"image\"></p>\n<p>Benchmark/NUMAQPINUMAQPI</p>\n<p>numactlNUMAcgroupcpuset.memsNUMA node  </p>\n<p><strong>Numa:</strong>  </p>\n<ul>\n<li>default:()  </li>\n<li>bind:  </li>\n<li>interleavel:  </li>\n<li>preferred:  </li>\n</ul>\n<p><strong>numactl</strong> </p>\n<ul>\n<li>interleave=nodes //node</li>\n<li>membind=nodes //nodeCPUcore</li>\n<li>cpunodebind=nodes //membindCPUcoreNUMA node</li>\n<li>physcpubind=cpus //cpunodebindcore</li>\n<li>localalloc //</li>\n<li>preferred=node //</li>\n</ul>\n<p>MongodbNUMAinterleave=allnode<br>PCI/PCIePCHPCIe<br>PCIe channelNUMA</p>\n<p>em1NUMA</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">[root@local ~]$ numactl --prefer netdev:em1 --show</span><br><span class=\"line\">policy: preferred</span><br><span class=\"line\">preferred node: 0</span><br><span class=\"line\">physcpubind: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 </span><br><span class=\"line\">cpubind: 0 1 </span><br><span class=\"line\">nodebind: 0 1 </span><br><span class=\"line\">membind: 0 1</span><br></pre></td></tr></table></figure>\n\n<p>PCI address 00:1f.2SATApci:<br>00:1f.2 SATA controller: Intel Corporation C610/X99 series chipset 6-Port SATA Controller [AHCI mode] (rev 05)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@local ~]$ numactl --prefer pci:00:1f.2 --show</span><br><span class=\"line\">policy: preferred</span><br><span class=\"line\">preferred node: 0</span><br><span class=\"line\">physcpubind: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 </span><br><span class=\"line\">cpubind: 0 1 </span><br><span class=\"line\">nodebind: 0 1 </span><br><span class=\"line\">membind: 0 1</span><br></pre></td></tr></table></figure>\n\n<p><strong>numa</strong>  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@local ~]$ numactl --show</span><br><span class=\"line\">policy: default</span><br><span class=\"line\">preferred node: current</span><br><span class=\"line\">physcpubind: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 </span><br><span class=\"line\">cpubind: 0 1 </span><br><span class=\"line\">nodebind: 0 1 </span><br><span class=\"line\">membind: 0 1</span><br></pre></td></tr></table></figure>\n\n<p><strong>numa</strong> </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@local ~]$ numactl --hardware</span><br><span class=\"line\">available: 2 nodes (0-1)</span><br><span class=\"line\">node 0 cpus: 0 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46</span><br><span class=\"line\">node 0 size: 196514 MB</span><br><span class=\"line\">node 0 free: 73338 MB</span><br><span class=\"line\">node 1 cpus: 1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45 47</span><br><span class=\"line\">node 1 size: 196608 MB</span><br><span class=\"line\">node 1 free: 117521 MB</span><br><span class=\"line\">node distances:</span><br><span class=\"line\">node   0   1 </span><br><span class=\"line\">  0:  10  21 </span><br><span class=\"line\">  1:  21  10</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h1 id=\"NUMA\"><a href=\"#NUMA\" class=\"headerlink\" title=\"NUMA\"></a>NUMA</h1><ul>\n<li><a href=\"http://blog.jcole.us/2010/09/28/mysql-swap-insanity-and-the-numa-architecture/\" target=\"_blank\" rel=\"noopener\">MySQL  The MySQL swap insanity problem and the effects of the NUMA architecture</a></li>\n<li><a href=\"http://frosty-postgres.blogspot.com/2012/08/postgresql-numa-and-zone-reclaim-mode.html\" target=\"_blank\" rel=\"noopener\">PostgreSQL  PostgreSQL, NUMA and zone reclaim mode on linux</a></li>\n<li><a href=\"http://blog.yannickjaquier.com/hpux/non-uniform-memory-access-numa-architecture-with-oracle-database-by-examples.html\" target=\"_blank\" rel=\"noopener\">Oracle  Non-Uniform Memory Access (NUMA) architecture with Oracle database by examples</a></li>\n<li><a href=\"https://engineering.linkedin.com/performance/optimizing-linux-memory-management-low-latency-high-throughput-databases\" target=\"_blank\" rel=\"noopener\">Java  Optimizing Linux Memory Management for Low-latency / High-throughput Databases</a></li>\n</ul>\n<p>CPUNUMA Zone Claim</p>\n<h2 id=\"NUMA\"><a href=\"#NUMA\" class=\"headerlink\" title=\"NUMA\"></a>NUMA</h2><p>MySQLNUMA  </p>\n<ul>\n<li><a href=\"https://blog.jcole.us/2010/09/28/mysql-swap-insanity-and-the-numa-architecture/\" target=\"_blank\" rel=\"noopener\">The MySQL swap insanity problem and the effects of the NUMA architecture</a></li>\n<li><a href=\"https://blog.jcole.us/2012/04/16/a-brief-update-on-numa-and-mysql/\" target=\"_blank\" rel=\"noopener\">A brief update on NUMA and MySQL</a></li>\n</ul>\n<blockquote>\n<p>  </p>\n</blockquote>\n<ul>\n<li>CPUCPU   </li>\n<li>NUMACPUChip4Chip   </li>\n<li>CPUChipCPURemote Access   </li>\n<li>LinuxCPUCore/Chip   </li>\n<li>CPU 0   </li>\n<li>Reclaim/SwapChip    </li>\n<li></li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li>numactl interleave=all</li>\n<li>MySQLsysctl -q -w - vm.drop_caches=3</li>\n<li>InnodbInnodb_buffer_pool_size</li>\n</ul>\n<blockquote>\n<p>NUMAMySQL SWAPMySQLInnodb Buffer PoolPageSwap</p>\n</blockquote>\n<ul>\n<li>vm.zone_reclaim_mode = 0remote memoryswap out local page</li>\n<li>echo -15 &gt; /proc//oom_adjMySQLOOM_killerKill</li>\n<li>memlock</li>\n<li>MySQLHuge PageHuge Pageswap</li>\n</ul>\n<p><strong>Interleave</strong><br> Carrefour Interleave30%LinuxworkloadInterleavepageCPU CoreCPURemote AccessNUMACore</p>\n<p><img src=\"https://raw.githubusercontent.com/ikenchina/img1/master/1/cpu/numa/numa-compare1.png\" alt=\"image\"></p>\n<p>MySQLInterleave<code> NUMARemote AcessRemote Accessinterconnect</code>InterleaveRemote AccessInterleave</p>\n<p>InterleaveNUMA<br>LinuxNUMACPU<br>Dynamic Memory Loaction, Page Replication</p>\n<p><strong>Dynamic Memory Relocation</strong><br>MySQLSQLflushiomastercoreRemote AccessPage FlushPurgeMySQL CrashRecoveryrecovery<br>InterleaveCPUDynamic Memory RelocationpagememoryprofileMemory Accessprofile  </p>\n<p><strong>Page Replication</strong><br>CPUCPUMemory ZoneinterconnectMESIPage Replication</p>\n<h2 id=\"NUMA\"><a href=\"#NUMA\" class=\"headerlink\" title=\"NUMA\"></a>NUMA</h2><ul>\n<li>BIOS</li>\n<li>OSnuma=off</li>\n<li>numactl numactl interleave=all</li>\n</ul>\n<h2 id=\"NUMA\"><a href=\"#NUMA\" class=\"headerlink\" title=\"NUMA\"></a>NUMA</h2><p><strong>numa</strong><br>numactl -m-physcpubindcpumemory:<br><em><code>numactl physcpubind=2,6 ./program</code></em></p>\n<p><a href=\"http://www.searchtb.com/2012/12/%E7%8E%A9%E8%BD%ACcpu-topology.html\" target=\"_blank\" rel=\"noopener\">cpu-topology</a>() nodenode38s28snuma node</p>\n<p><strong>numa</strong><br><a href=\"http://huoding.com/2012/11/08/198\" target=\"_blank\" rel=\"noopener\">SWAP</a> numaswapnumanuma nodenuma nodeswapswap<br><code>numactl --interleave=all</code>numa node</p>\n<p>NUMA:  </p>\n<ul>\n<li>numa nodenuma</li>\n<li>numa node</li>\n</ul>\n<hr>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\":\"></a>:</h4><ul>\n<li><a href=\"https://docs.google.com/document/u/0/d/1d3iI2QWURgDIsSR6G2275vMeQ_X7w-qxM2Vp7iGwwuM/pub\" target=\"_blank\" rel=\"noopener\">NUMA-aware scheduler for Go</a></li>\n<li><a href=\"http://frosty-postgres.blogspot.com/2012/08/postgresql-numa-and-zone-reclaim-mode.html\" target=\"_blank\" rel=\"noopener\">PostgreSQL, NUMA and zone reclaim mode on linux</a></li>\n<li><a href=\"https://www.slideshare.net/slidunder/numa-and-java-databases\" target=\"_blank\" rel=\"noopener\">NUMA and Java Databases</a></li>\n<li><a href=\"http://mikaelronstrom.blogspot.com/2010/12/mysql-server-and-numa-architectures.html\" target=\"_blank\" rel=\"noopener\">MySQL Server and NUMA architectures</a></li>\n</ul>"},{"layout":"post","title":"What Is the Most Important Thing in Life","date":"2017-12-31T16:00:00.000Z","_content":"\n> the most important thing in life.<!-- more -->  \n\n\n# the most important thing in life.\n- Keeping healthy. It is health that is real wealth and not pieces of gold and silver.\n- Everybody needs somebody, be that a friend, a partner, or someone youre related to.\n- Making someones day full of sunshine even when yours is not.\n- Money should not be a priority.\n- The beautiful thing about learning is that nobody can take it away from you.\n- Know who you are.\n- Dont be a victim BUT instead be a hero in your life.\n- Don't give up. A winner is just a loser who tried on more time.\n- Always make time for gratitude.","source":"_posts/which-most-important.md","raw":"---\nlayout: post\ncategory: \"2018\"\ntitle:  \"What Is the Most Important Thing in Life\"\ntags: [,]\ndate: 2018-01-01\n---\n\n> the most important thing in life.<!-- more -->  \n\n\n# the most important thing in life.\n- Keeping healthy. It is health that is real wealth and not pieces of gold and silver.\n- Everybody needs somebody, be that a friend, a partner, or someone youre related to.\n- Making someones day full of sunshine even when yours is not.\n- Money should not be a priority.\n- The beautiful thing about learning is that nobody can take it away from you.\n- Know who you are.\n- Dont be a victim BUT instead be a hero in your life.\n- Don't give up. A winner is just a loser who tried on more time.\n- Always make time for gratitude.","slug":"which-most-important","published":1,"updated":"2020-04-15T03:28:41.896Z","comments":1,"photos":[],"link":"","_id":"ck9115hpq0008ppfc537aftlj","content":"<blockquote>\n<p>the most important thing in life.<a id=\"more\"></a>  </p>\n</blockquote>\n<h1 id=\"the-most-important-thing-in-life\"><a href=\"#the-most-important-thing-in-life\" class=\"headerlink\" title=\"the most important thing in life.\"></a>the most important thing in life.</h1><ul>\n<li>Keeping healthy. It is health that is real wealth and not pieces of gold and silver.</li>\n<li>Everybody needs somebody, be that a friend, a partner, or someone youre related to.</li>\n<li>Making someones day full of sunshine even when yours is not.</li>\n<li>Money should not be a priority.</li>\n<li>The beautiful thing about learning is that nobody can take it away from you.</li>\n<li>Know who you are.</li>\n<li>Dont be a victim BUT instead be a hero in your life.</li>\n<li>Dont give up. A winner is just a loser who tried on more time.</li>\n<li>Always make time for gratitude.</li>\n</ul>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>the most important thing in life.","more":"</p>\n</blockquote>\n<h1 id=\"the-most-important-thing-in-life\"><a href=\"#the-most-important-thing-in-life\" class=\"headerlink\" title=\"the most important thing in life.\"></a>the most important thing in life.</h1><ul>\n<li>Keeping healthy. It is health that is real wealth and not pieces of gold and silver.</li>\n<li>Everybody needs somebody, be that a friend, a partner, or someone youre related to.</li>\n<li>Making someones day full of sunshine even when yours is not.</li>\n<li>Money should not be a priority.</li>\n<li>The beautiful thing about learning is that nobody can take it away from you.</li>\n<li>Know who you are.</li>\n<li>Dont be a victim BUT instead be a hero in your life.</li>\n<li>Dont give up. A winner is just a loser who tried on more time.</li>\n<li>Always make time for gratitude.</li>\n</ul>"}],"PostAsset":[],"PostCategory":[{"post_id":"ck9115hpf0000ppfcvq9z2p4f","category_id":"ck9115hpm0004ppfcayy0bwtp","_id":"ck9115hps000cppfcw6mhpz26"},{"post_id":"ck9115hpk0002ppfcvrvp01pb","category_id":"ck9115hpr0009ppfchvycnpvv","_id":"ck9115hpu000gppfcwokpek4j"},{"post_id":"ck9115hpo0006ppfcd7gc8851","category_id":"ck9115hpr0009ppfchvycnpvv","_id":"ck9115hpv000jppfcxiv5vpwz"},{"post_id":"ck9115hpq0008ppfc537aftlj","category_id":"ck9115hpr0009ppfchvycnpvv","_id":"ck9115hpw000nppfcjrtp7fpz"}],"PostTag":[{"post_id":"ck9115hpf0000ppfcvq9z2p4f","tag_id":"ck9115hpo0005ppfcv0et7y4r","_id":"ck9115hps000bppfcsr17z7no"},{"post_id":"ck9115hpk0002ppfcvrvp01pb","tag_id":"ck9115hpr000appfcx9m3c1be","_id":"ck9115hpv000ippfcf4fznafr"},{"post_id":"ck9115hpk0002ppfcvrvp01pb","tag_id":"ck9115hps000eppfcgcw38i2l","_id":"ck9115hpv000kppfckhit8p1f"},{"post_id":"ck9115hpo0006ppfcd7gc8851","tag_id":"ck9115hpv000hppfcnwj2pg89","_id":"ck9115hpw000mppfc28szyei9"},{"post_id":"ck9115hpq0008ppfc537aftlj","tag_id":"ck9115hpv000lppfc9muck793","_id":"ck9115hpw000pppfcny17e2xh"},{"post_id":"ck9115hpq0008ppfc537aftlj","tag_id":"ck9115hpw000oppfcc225eczu","_id":"ck9115hpw000qppfclmqk1azr"}],"Tag":[{"name":"","_id":"ck9115hpo0005ppfcv0et7y4r"},{"name":"rpc","_id":"ck9115hpr000appfcx9m3c1be"},{"name":"grpc","_id":"ck9115hps000eppfcgcw38i2l"},{"name":"cpu","_id":"ck9115hpv000hppfcnwj2pg89"},{"name":"","_id":"ck9115hpv000lppfc9muck793"},{"name":"","_id":"ck9115hpw000oppfcc225eczu"}]}}